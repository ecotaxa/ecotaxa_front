"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[541],{8541:(t,e,s)=>{s.d(e,{x:()=>n}),s(7856);var l=s(8804),o=s(9162),a=s(2817);class n{jsUpload=null;constructor(t,e={enableupload:!0}){(t=t instanceof HTMLElement?t:document.querySelector(t))&&(this.container=t,this.options=Object.assign({url:"/gui/job/my_files",displaylist:"dirlist",upload:{label:"upload"},selector:{doupload:".target-upload"},css:{dropzone:"dropzone"}},e),!0===this.options.enableupload&&this.addUploadDialog(this.container,this.options.upload.callback))}listDir(t="",e,s,l){e=e||this.options.displaylist;const n="ul"===(s=s?"select"===s?"optiongroup":s:this.options.enableupload?"select":"ul")?"li":"option";l=l?l+2:0,fetch(this.options.url+"/"+t,(0,o.wv)()).then((t=>t.json())).then((o=>{if(o.entries&&o.entries.length){e.dataset.label&&e.insertAdjacentHTML("afterbegin",`<label>${e.dataset.label}</label>`);let i=[`<${s} class="entries ml-${l}">`];const c=(t,e)=>{t.forEach((t=>{const s=t.name.split(".").pop();e.push(`<${n} ${"D"===t.type?'draggable="true"':""} data-name="${t.name}"><span class="entry${t.type}"><i class="icon icon-${"D"===t.type?"folder-sm":a.FB.tsv.split(",").indexOf(s)>=0?"document-sm":"photo-sm"} align-text-bottom mb-0.5 mr-0.5"></i>${t.name}</span>`),e.push(`</${n}>`)}))};c(o.entries,i),i.push(`</${s}>`),e.insertAdjacentHTML("beforeend",i.join("")),e.querySelectorAll(".entryD").forEach((e=>e.addEventListener("click",(e=>{e.stopImmediatePropagation();const o=e.currentTarget.parentElement;o.classList.toggle("on");const a=e.currentTarget.querySelector("i.icon");a&&(a.classList.toggle("icon-folder-sm"),a.classList.toggle("icon-folder-open-sm")),console.log("dir",o),o.classList.contains("on")&&(o.dataset.load||(this.listDir(t+"/"+o.dataset.name,o,s,l),o.dataset.load=!0)),o.lastElementChild&&o.lastElementChild.classList.toggle("hidden")}))))}this.options.callback&&this.options.callback()}))}addUploadDialog(t,e){t=t||this.container,e=e||null,this.jsUpload||(this.jsUpload=new l.JsUpload(this.container,e)),this.jsUpload.attachDropzone(t)}}}}]);