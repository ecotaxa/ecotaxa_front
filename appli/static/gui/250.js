"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[250,541],{6250:(t,e,s)=>{s.r(e),s.d(e,{JsImport:()=>l}),s(7856);var o=s(8541),a=(s(615),s(2817));class l{typeimport;myFiles;constructor(t,e={}){(t=t instanceof HTMLElement?t:document.querySelector(t))&&(this.container=t,this.options=Object.assign({url:"http://193.49.112.116:5001/gui/job/my_files/",selector:{displayselection:"dirlist",displayresult:"results",typeimport:"typeimport",importzone:"file_to_load"}},e),this.init())}init(){this.container.querySelectorAll('input[name="'+this.options.selector.typeimport+'"]').forEach((t=>{t.addEventListener("change",(t=>{t.currentTarget.checked&&(console.log(t.currentTarget),this.typeimport=t.currentTarget.value,this.showSelection(!0))}))})),this.showSelection()}showSelection(t=!1){const e=document.getElementById(this.options.selector.displayselection),s=document.getElementById(this.options.selector.displayresult);e&&s&&(this.myFiles||(this.myFiles=new o.JsMyFiles(e,{enableupload:!0,callback:()=>{this.activateDragDrop()},upload:{label:e.dataset.uploadlabel?e.dataset.uploadlabel:"upload",callback:t=>{console.log("response",t),t.err?console.log("err",t.err):(this.addImportPath(t.response),this.showSubmit())}}})),e.dataset.loaded||(this.myFiles.listDir("",e,0),e.dataset.loaded=!0),!0===t&&(()=>{let t=this.typeimport.split("-");t=t.map((t=>new Set([...a.FB[t]?a.FB[t]:[]]))),this.myFiles.container.querySelectorAll("[data-ftype]").forEach((e=>{t.has(e.dataset.ftype)?e.classList.remove("disabled"):e.classList.add("disabled")}))})())}addImportPath(t){document.getElementById(this.options.selector.importzone).value=t;const e=document.getElementById(this.options.selector.displayresult);e&&(e.innerHTML=`<li>${t.split("/").pop()}</li>`),this.container.querySelector("#"+this.options.selector.importoptions)}activateDragDrop(){const t=document.getElementById(this.options.selector.displayresult);t.addEventListener("dragover",(t=>{t.preventDefault(),t.target.classList.add("active"),t.dataTransfer.dropEffect="copy"})),t.addEventListener("drop",(t=>{t.target.classList.remove("active"),t.preventDefault();const e=t.dataTransfer.getData("text/html");t.target.insertAdjacentHTML("beforeend",e)}));const e=t=>{t.dataTransfer.dropEffect="copy",t.dataTransfer.setData("text/html",t.target.outerHTML)};this.myFiles.container.querySelectorAll("[draggable]").forEach((t=>{t.addEventListener("dragstart",e)}))}showSubmit(t=!0){const e=this.container.querySelector('[type="submit"]');console.log("sub",e),t?(e.classList.remove("hide"),e.disabled=!1):e.disabled=!0}}},8541:(t,e,s)=>{s.r(e),s.d(e,{JsMyFiles:()=>i}),s(7856);var o=s(8804),a=s(9162),l=s(2817);class i{jsUpload=null;constructor(t,e={enableupload:!0}){(t=t instanceof HTMLElement?t:document.querySelector(t))&&(this.container=t,this.options=Object.assign({url:"/gui/job/my_files",displaylist:"dirlist",upload:{label:"upload"},selector:{doupload:".target-upload"},css:{dropzone:"dropzone"}},e),!0===this.options.enableupload&&this.addUploadDialog(this.container,this.options.upload.callback))}listDir(t="",e,s,o){e=e||this.options.displaylist;const i="ul"===(s=s?"select"===s?"optiongroup":s:this.options.enableupload?"select":"ul")?"li":"option";o=o?o+2:0,fetch(this.options.url+"/"+t,(0,a.fetchSettings)()).then((t=>t.json())).then((a=>{if(a.entries&&a.entries.length){e.dataset.label&&e.insertAdjacentHTML("afterbegin",`<label>${e.dataset.label}</label>`);let n=[`<${s} class="entries ml-${o}">`];const r=(t,e)=>{t.forEach((t=>{const s=t.name.split(".").pop();e.push(`<${i} ${"D"===t.type?'draggable="true"':""} data-name="${t.name}"><span class="entry${t.type}"><i class="icon icon-${"D"===t.type?"folder-sm":l.FB.tsv.split(",").indexOf(s)>=0?"document-sm":"photo-sm"} align-text-bottom mb-0.5 mr-0.5"></i>${t.name}</span>`),e.push(`</${i}>`)}))};r(a.entries,n),n.push(`</${s}>`),e.insertAdjacentHTML("beforeend",n.join("")),e.querySelectorAll(".entryD").forEach((e=>e.addEventListener("click",(e=>{e.stopImmediatePropagation();const a=e.currentTarget.parentElement;a.classList.toggle("on");const l=e.currentTarget.querySelector("i.icon");l&&(l.classList.toggle("icon-folder-sm"),l.classList.toggle("icon-folder-open-sm")),console.log("dir",a),a.classList.contains("on")&&(a.dataset.load||(this.listDir(t+"/"+a.dataset.name,a,s,o),a.dataset.load=!0)),a.lastElementChild&&a.lastElementChild.classList.toggle("hidden")}))))}this.options.callback&&this.options.callback()}))}addUploadDialog(t,e){t=t||this.container,e=e||null,this.jsUpload||(this.jsUpload=new o.JsUpload(this.container,e)),this.jsUpload.attachDropzone(t)}}}}]);