/*! For license information please see src_modules_js-import_js.js.LICENSE.txt */
"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["src_modules_js-import_js"],{"./src/modules/js-import.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   JsImport: () => (/* binding */ JsImport)\n/* harmony export */ });\n/* harmony import */ var dompurify__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! dompurify */ \"./node_modules/dompurify/dist/purify.js\");\n/* harmony import */ var dompurify__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(dompurify__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _modules_form_submit_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../modules/form-submit.js */ \"./src/modules/form-submit.js\");\n/* harmony import */ var _modules_utils_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../modules/utils.js */ \"./src/modules/utils.js\");\n/* harmony import */ var _modules_modules_config_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../modules/modules-config.js */ \"./src/modules/modules-config.js\");\n\n\n\n\n\n\nclass JsImport {\n  typeimport;\n  myFiles;\n  constructor(container, options = {}) {\n    container = (container instanceof HTMLElement) ? container : document.querySelector(container);\n    if (!container) return;\n    this.container = container;\n    const defaultOptions = {\n      selector: {\n        displayresult: 'results',\n        typeimport: \"typeimport\",\n        importzone: \"file_to_load\",\n        showfiles: \".showfiles\",\n        displayselection: \"dirlist\"\n      }\n    };\n\n    this.options = Object.assign(defaultOptions, options);\n\n    this.init();\n  }\n\n  init() {\n    // init steps to display import sequence\n    this.container.querySelectorAll('input[name=\"' + this.options.selector.typeimport + '\"]').forEach(typeimport => {\n      typeimport.addEventListener('change', (e) => {\n        if (e.currentTarget.checked) {\n          console.log(e.currentTarget)\n          this.typeimport = e.currentTarget.value;\n          this.showSelection(true);\n        }\n      })\n    });\n    this.showSelection();\n  }\n  async showSelection(refresh = false) {\n    const apply_filters = () => {\n      let filters = this.typeimport.split('-');\n      filters = filters.map(filter => {\n        return new Set([...(filter_files[filter] ? filter_files[filter] : [])]);\n      });\n      this.myFiles.container.querySelectorAll('[data-ftype]').forEach(entry => {\n        if (filters.has(entry.dataset.ftype)) entry.classList.remove('disabled');\n        else entry.classList.add('disabled');\n      });\n    }\n    const displayselection = document.getElementById(this.options.selector.displayselection);\n    const displayresult = document.getElementById(this.options.selector.displayresult);\n    if (!displayselection || !displayresult) return;\n    if (!this.myFiles) {\n      const {\n        JsMyFiles\n      } =\n      await __webpack_require__.e(/*! import() */ \"src_modules_js-my-files_js\").then(__webpack_require__.bind(__webpack_require__, /*! ../modules/js-my-files.js */ \"./src/modules/js-my-files.js\"));\n      this.myFiles = new JsMyFiles(displayselection, {\n        enableupload: true,\n        enablestore: true,\n        btnfilelist: this.options.showfiles,\n        upload: {\n          label: (displayselection.dataset.uploadlabel) ? (displayselection.dataset.uploadlabel) : 'upload',\n          callback: () => {\n            this.addImportPath('/tmp/ecotaxa_user.760/ecotaxa_import');\n            this.showSubmit();\n          }\n        }\n      });\n    }\n\n    if (refresh === true) apply_filters();\n\n  }\n  addImportPath(value) {\n    document.getElementById(this.options.selector.importzone).value = value;\n    const displayresult = document.getElementById(this.options.selector.displayresult);\n    if (displayresult) displayresult.innerHTML = `<li>${value.split('/').pop()}</li>`;\n    const options = this.container.querySelector('#' + this.options.selector.importoptions);\n  }\n\n  showSubmit(show = true) {\n    const submit = this.container.querySelector('[type=\"submit\"]');\n    console.log('sub', submit)\n    if (show) {\n      submit.classList.remove('hide');\n      submit.disabled = false;\n    } else submit.disabled = true;\n  }\n}//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvbW9kdWxlcy9qcy1pbXBvcnQuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQWtDOztBQUlDO0FBR047QUFHUzs7QUFFL0I7QUFDUDtBQUNBO0FBQ0EscUNBQXFDO0FBQ3JDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSLFlBQVksd0xBQW1DO0FBQy9DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3REFBd0QsdUJBQXVCO0FBQy9FO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0EiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvbW9kdWxlcy9qcy1pbXBvcnQuanM/NjAyMyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgRE9NUHVyaWZ5IGZyb20gJ2RvbXB1cmlmeSc7XG5cbmltcG9ydCB7XG4gIEZvcm1TdWJtaXRcbn0gZnJvbSAnLi4vbW9kdWxlcy9mb3JtLXN1Ym1pdC5qcyc7XG5pbXBvcnQge1xuICBmZXRjaFNldHRpbmdzLFxufSBmcm9tICcuLi9tb2R1bGVzL3V0aWxzLmpzJztcbmltcG9ydCB7XG4gIGNzcyxcbn0gZnJvbSAnLi4vbW9kdWxlcy9tb2R1bGVzLWNvbmZpZy5qcyc7XG5cbmV4cG9ydCBjbGFzcyBKc0ltcG9ydCB7XG4gIHR5cGVpbXBvcnQ7XG4gIG15RmlsZXM7XG4gIGNvbnN0cnVjdG9yKGNvbnRhaW5lciwgb3B0aW9ucyA9IHt9KSB7XG4gICAgY29udGFpbmVyID0gKGNvbnRhaW5lciBpbnN0YW5jZW9mIEhUTUxFbGVtZW50KSA/IGNvbnRhaW5lciA6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29udGFpbmVyKTtcbiAgICBpZiAoIWNvbnRhaW5lcikgcmV0dXJuO1xuICAgIHRoaXMuY29udGFpbmVyID0gY29udGFpbmVyO1xuICAgIGNvbnN0IGRlZmF1bHRPcHRpb25zID0ge1xuICAgICAgc2VsZWN0b3I6IHtcbiAgICAgICAgZGlzcGxheXJlc3VsdDogJ3Jlc3VsdHMnLFxuICAgICAgICB0eXBlaW1wb3J0OiBcInR5cGVpbXBvcnRcIixcbiAgICAgICAgaW1wb3J0em9uZTogXCJmaWxlX3RvX2xvYWRcIixcbiAgICAgICAgc2hvd2ZpbGVzOiBcIi5zaG93ZmlsZXNcIixcbiAgICAgICAgZGlzcGxheXNlbGVjdGlvbjogXCJkaXJsaXN0XCJcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgdGhpcy5vcHRpb25zID0gT2JqZWN0LmFzc2lnbihkZWZhdWx0T3B0aW9ucywgb3B0aW9ucyk7XG5cbiAgICB0aGlzLmluaXQoKTtcbiAgfVxuXG4gIGluaXQoKSB7XG4gICAgLy8gaW5pdCBzdGVwcyB0byBkaXNwbGF5IGltcG9ydCBzZXF1ZW5jZVxuICAgIHRoaXMuY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3JBbGwoJ2lucHV0W25hbWU9XCInICsgdGhpcy5vcHRpb25zLnNlbGVjdG9yLnR5cGVpbXBvcnQgKyAnXCJdJykuZm9yRWFjaCh0eXBlaW1wb3J0ID0+IHtcbiAgICAgIHR5cGVpbXBvcnQuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgKGUpID0+IHtcbiAgICAgICAgaWYgKGUuY3VycmVudFRhcmdldC5jaGVja2VkKSB7XG4gICAgICAgICAgY29uc29sZS5sb2coZS5jdXJyZW50VGFyZ2V0KVxuICAgICAgICAgIHRoaXMudHlwZWltcG9ydCA9IGUuY3VycmVudFRhcmdldC52YWx1ZTtcbiAgICAgICAgICB0aGlzLnNob3dTZWxlY3Rpb24odHJ1ZSk7XG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgfSk7XG4gICAgdGhpcy5zaG93U2VsZWN0aW9uKCk7XG4gIH1cbiAgYXN5bmMgc2hvd1NlbGVjdGlvbihyZWZyZXNoID0gZmFsc2UpIHtcbiAgICBjb25zdCBhcHBseV9maWx0ZXJzID0gKCkgPT4ge1xuICAgICAgbGV0IGZpbHRlcnMgPSB0aGlzLnR5cGVpbXBvcnQuc3BsaXQoJy0nKTtcbiAgICAgIGZpbHRlcnMgPSBmaWx0ZXJzLm1hcChmaWx0ZXIgPT4ge1xuICAgICAgICByZXR1cm4gbmV3IFNldChbLi4uKGZpbHRlcl9maWxlc1tmaWx0ZXJdID8gZmlsdGVyX2ZpbGVzW2ZpbHRlcl0gOiBbXSldKTtcbiAgICAgIH0pO1xuICAgICAgdGhpcy5teUZpbGVzLmNvbnRhaW5lci5xdWVyeVNlbGVjdG9yQWxsKCdbZGF0YS1mdHlwZV0nKS5mb3JFYWNoKGVudHJ5ID0+IHtcbiAgICAgICAgaWYgKGZpbHRlcnMuaGFzKGVudHJ5LmRhdGFzZXQuZnR5cGUpKSBlbnRyeS5jbGFzc0xpc3QucmVtb3ZlKCdkaXNhYmxlZCcpO1xuICAgICAgICBlbHNlIGVudHJ5LmNsYXNzTGlzdC5hZGQoJ2Rpc2FibGVkJyk7XG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3QgZGlzcGxheXNlbGVjdGlvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRoaXMub3B0aW9ucy5zZWxlY3Rvci5kaXNwbGF5c2VsZWN0aW9uKTtcbiAgICBjb25zdCBkaXNwbGF5cmVzdWx0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGhpcy5vcHRpb25zLnNlbGVjdG9yLmRpc3BsYXlyZXN1bHQpO1xuICAgIGlmICghZGlzcGxheXNlbGVjdGlvbiB8fCAhZGlzcGxheXJlc3VsdCkgcmV0dXJuO1xuICAgIGlmICghdGhpcy5teUZpbGVzKSB7XG4gICAgICBjb25zdCB7XG4gICAgICAgIEpzTXlGaWxlc1xuICAgICAgfSA9XG4gICAgICBhd2FpdCBpbXBvcnQoJy4uL21vZHVsZXMvanMtbXktZmlsZXMuanMnKTtcbiAgICAgIHRoaXMubXlGaWxlcyA9IG5ldyBKc015RmlsZXMoZGlzcGxheXNlbGVjdGlvbiwge1xuICAgICAgICBlbmFibGV1cGxvYWQ6IHRydWUsXG4gICAgICAgIGVuYWJsZXN0b3JlOiB0cnVlLFxuICAgICAgICBidG5maWxlbGlzdDogdGhpcy5vcHRpb25zLnNob3dmaWxlcyxcbiAgICAgICAgdXBsb2FkOiB7XG4gICAgICAgICAgbGFiZWw6IChkaXNwbGF5c2VsZWN0aW9uLmRhdGFzZXQudXBsb2FkbGFiZWwpID8gKGRpc3BsYXlzZWxlY3Rpb24uZGF0YXNldC51cGxvYWRsYWJlbCkgOiAndXBsb2FkJyxcbiAgICAgICAgICBjYWxsYmFjazogKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5hZGRJbXBvcnRQYXRoKCcvdG1wL2Vjb3RheGFfdXNlci43NjAvZWNvdGF4YV9pbXBvcnQnKTtcbiAgICAgICAgICAgIHRoaXMuc2hvd1N1Ym1pdCgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgaWYgKHJlZnJlc2ggPT09IHRydWUpIGFwcGx5X2ZpbHRlcnMoKTtcblxuICB9XG4gIGFkZEltcG9ydFBhdGgodmFsdWUpIHtcbiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0aGlzLm9wdGlvbnMuc2VsZWN0b3IuaW1wb3J0em9uZSkudmFsdWUgPSB2YWx1ZTtcbiAgICBjb25zdCBkaXNwbGF5cmVzdWx0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGhpcy5vcHRpb25zLnNlbGVjdG9yLmRpc3BsYXlyZXN1bHQpO1xuICAgIGlmIChkaXNwbGF5cmVzdWx0KSBkaXNwbGF5cmVzdWx0LmlubmVySFRNTCA9IGA8bGk+JHt2YWx1ZS5zcGxpdCgnLycpLnBvcCgpfTwvbGk+YDtcbiAgICBjb25zdCBvcHRpb25zID0gdGhpcy5jb250YWluZXIucXVlcnlTZWxlY3RvcignIycgKyB0aGlzLm9wdGlvbnMuc2VsZWN0b3IuaW1wb3J0b3B0aW9ucyk7XG4gIH1cblxuICBzaG93U3VibWl0KHNob3cgPSB0cnVlKSB7XG4gICAgY29uc3Qgc3VibWl0ID0gdGhpcy5jb250YWluZXIucXVlcnlTZWxlY3RvcignW3R5cGU9XCJzdWJtaXRcIl0nKTtcbiAgICBjb25zb2xlLmxvZygnc3ViJywgc3VibWl0KVxuICAgIGlmIChzaG93KSB7XG4gICAgICBzdWJtaXQuY2xhc3NMaXN0LnJlbW92ZSgnaGlkZScpO1xuICAgICAgc3VibWl0LmRpc2FibGVkID0gZmFsc2U7XG4gICAgfSBlbHNlIHN1Ym1pdC5kaXNhYmxlZCA9IHRydWU7XG4gIH1cbn0iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/modules/js-import.js\n")}}]);