/*! For license information please see src_modules_table-component_js.js.LICENSE.txt */
(self.webpackChunk=self.webpackChunk||[]).push([["src_modules_table-component_js"],{"./src/modules/module-event-emitter.js":(module,__webpack_exports__,__webpack_require__)=>{"use strict";eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ModuleEventEmitter: () => (/* binding */ ModuleEventEmitter)\n/* harmony export */ });\n/* harmony import */ var _modules_alert_box_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../modules/alert-box.js */ \"./src/modules/alert-box.js\");\n/* harmony import */ var _modules_utils_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../modules/utils.js */ \"./src/modules/utils.js\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_modules_alert_box_js__WEBPACK_IMPORTED_MODULE_0__]);\n_modules_alert_box_js__WEBPACK_IMPORTED_MODULE_0__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\nfunction CustomEventEmitter(event, detail) {\n  /**\n   * Add custom event listener\n   * @param  {Object} event {name:{String}, listener:{Object}}\n   * @param  {Object} detail\n   * @return {Void}\n   */\n  const custom = new CustomEvent(event.name, {\n    detail: detail,\n  })\n  event.listener.dispatchEvent(custom);\n}\n\n\nfunction ObjectEventEmitter(event, callback, listener = window) {\n  /**\n   * Add custom event listener\n   * @param  {String} event\n   * @param  {Function} callback\n   * @param  {Object} listener\n   * @return {Object} listener\n   */\n  listener.on = function(event, callback) {\n    this._events = this._events || {}\n    this._events[event] = this._events[event] || []\n    this._events[event].push(callback)\n  }\n  listener.once = function(event, callback) {\n    callback.once = true;\n    self.on(event, callback);\n  }\n  listener.off = function(event, callback) {\n    this._events = this._events || {}\n    if (event in this._events === false) return;\n    this._events[event].splice(this._events[event].indexOf(callback), 1)\n  }\n  listener.emit = function(event, ...args) {\n    if (event in this._events === false) return;\n    else {\n      for (const action of this._events[event]) {\n        action(...args);\n        if (action.once) break;\n      }\n    }\n  }\n  return listener;\n}\n\nfunction createModuleEventEmitter(event, callback) {\n  /**\n   * Add event bus global or with listener\n   * @param  {String} event\n   * @param  {Function} callback\n   * @return {Void}\n   */\n  const _events = [];\n  const all = 'ALL_EVENTS';\n\n  function on(event, callback, listener = all) {\n    _events[listener] = _events[listener] || [];\n    _events[listener][event] = _events[listener][event] || [];\n    _events[listener][event].push(callback);\n  }\n\n  function once(event, callback, listener = all) {\n    callback.once = true;\n    on(event, callback, listener);\n  }\n\n  function off(event, callback, listener = all) {\n    if (event in _events[listener] === false) return;\n    _events[listener][event].splice(_events[listener][event].indexOf(callback), 1);\n  }\n\n  function emit(event, e = {}, listener = all) {\n    _events[listener] = _events[listener] || [];\n    if (event in _events[listener] === false) return;\n    else {\n      for (const action of _events[listener][event]) {\n        action(e);\n        if (action.once) break;\n      }\n    }\n  }\n\n  return {\n    on,\n    once,\n    off,\n    emit\n  }\n}\n\nconst ModuleEventEmitter = await createModuleEventEmitter();\n// each function or class which communicates need and event object and optional emitEvent function\n\n// global capture errors\nconst eventnames = {\n  error: 'error'\n}\nModuleEventEmitter.on(eventnames.error, (e) => {\n  _modules_alert_box_js__WEBPACK_IMPORTED_MODULE_0__.AlertBox.renderAlert({\n    type: _modules_alert_box_js__WEBPACK_IMPORTED_MODULE_0__.AlertBox.alertconfig.types.error,\n    content: e,\n    inverse: true,\n    dismissible: true\n  });\n});\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } }, 1);//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvbW9kdWxlcy9tb2R1bGUtZXZlbnQtZW1pdHRlci5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFFaUM7QUFHSjs7QUFFN0I7QUFDQTtBQUNBO0FBQ0EsY0FBYyxRQUFRLE9BQU8sTUFBTSxPQUFPLFlBQVk7QUFDdEQsY0FBYyxRQUFRO0FBQ3RCLGNBQWM7QUFDZDtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0EsY0FBYyxRQUFRO0FBQ3RCLGNBQWMsVUFBVTtBQUN4QixjQUFjLFFBQVE7QUFDdEIsY0FBYyxRQUFRO0FBQ3RCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsY0FBYyxRQUFRO0FBQ3RCLGNBQWMsVUFBVTtBQUN4QixjQUFjO0FBQ2Q7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsNkJBQTZCO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFLDJEQUFRO0FBQ1YsVUFBVSwyREFBUTtBQUNsQjtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0gsQ0FBQyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL3NyYy9tb2R1bGVzL21vZHVsZS1ldmVudC1lbWl0dGVyLmpzP2NhNGQiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcbiAgQWxlcnRCb3hcbn0gZnJvbSAnLi4vbW9kdWxlcy9hbGVydC1ib3guanMnO1xuaW1wb3J0IHtcbiAgZ2VuZXJhdGVfdXVpZFxufSBmcm9tICcuLi9tb2R1bGVzL3V0aWxzLmpzJztcblxuZnVuY3Rpb24gQ3VzdG9tRXZlbnRFbWl0dGVyKGV2ZW50LCBkZXRhaWwpIHtcbiAgLyoqXG4gICAqIEFkZCBjdXN0b20gZXZlbnQgbGlzdGVuZXJcbiAgICogQHBhcmFtICB7T2JqZWN0fSBldmVudCB7bmFtZTp7U3RyaW5nfSwgbGlzdGVuZXI6e09iamVjdH19XG4gICAqIEBwYXJhbSAge09iamVjdH0gZGV0YWlsXG4gICAqIEByZXR1cm4ge1ZvaWR9XG4gICAqL1xuICBjb25zdCBjdXN0b20gPSBuZXcgQ3VzdG9tRXZlbnQoZXZlbnQubmFtZSwge1xuICAgIGRldGFpbDogZGV0YWlsLFxuICB9KVxuICBldmVudC5saXN0ZW5lci5kaXNwYXRjaEV2ZW50KGN1c3RvbSk7XG59XG5cblxuZnVuY3Rpb24gT2JqZWN0RXZlbnRFbWl0dGVyKGV2ZW50LCBjYWxsYmFjaywgbGlzdGVuZXIgPSB3aW5kb3cpIHtcbiAgLyoqXG4gICAqIEFkZCBjdXN0b20gZXZlbnQgbGlzdGVuZXJcbiAgICogQHBhcmFtICB7U3RyaW5nfSBldmVudFxuICAgKiBAcGFyYW0gIHtGdW5jdGlvbn0gY2FsbGJhY2tcbiAgICogQHBhcmFtICB7T2JqZWN0fSBsaXN0ZW5lclxuICAgKiBAcmV0dXJuIHtPYmplY3R9IGxpc3RlbmVyXG4gICAqL1xuICBsaXN0ZW5lci5vbiA9IGZ1bmN0aW9uKGV2ZW50LCBjYWxsYmFjaykge1xuICAgIHRoaXMuX2V2ZW50cyA9IHRoaXMuX2V2ZW50cyB8fCB7fVxuICAgIHRoaXMuX2V2ZW50c1tldmVudF0gPSB0aGlzLl9ldmVudHNbZXZlbnRdIHx8IFtdXG4gICAgdGhpcy5fZXZlbnRzW2V2ZW50XS5wdXNoKGNhbGxiYWNrKVxuICB9XG4gIGxpc3RlbmVyLm9uY2UgPSBmdW5jdGlvbihldmVudCwgY2FsbGJhY2spIHtcbiAgICBjYWxsYmFjay5vbmNlID0gdHJ1ZTtcbiAgICBzZWxmLm9uKGV2ZW50LCBjYWxsYmFjayk7XG4gIH1cbiAgbGlzdGVuZXIub2ZmID0gZnVuY3Rpb24oZXZlbnQsIGNhbGxiYWNrKSB7XG4gICAgdGhpcy5fZXZlbnRzID0gdGhpcy5fZXZlbnRzIHx8IHt9XG4gICAgaWYgKGV2ZW50IGluIHRoaXMuX2V2ZW50cyA9PT0gZmFsc2UpIHJldHVybjtcbiAgICB0aGlzLl9ldmVudHNbZXZlbnRdLnNwbGljZSh0aGlzLl9ldmVudHNbZXZlbnRdLmluZGV4T2YoY2FsbGJhY2spLCAxKVxuICB9XG4gIGxpc3RlbmVyLmVtaXQgPSBmdW5jdGlvbihldmVudCwgLi4uYXJncykge1xuICAgIGlmIChldmVudCBpbiB0aGlzLl9ldmVudHMgPT09IGZhbHNlKSByZXR1cm47XG4gICAgZWxzZSB7XG4gICAgICBmb3IgKGNvbnN0IGFjdGlvbiBvZiB0aGlzLl9ldmVudHNbZXZlbnRdKSB7XG4gICAgICAgIGFjdGlvbiguLi5hcmdzKTtcbiAgICAgICAgaWYgKGFjdGlvbi5vbmNlKSBicmVhaztcbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgcmV0dXJuIGxpc3RlbmVyO1xufVxuXG5mdW5jdGlvbiBjcmVhdGVNb2R1bGVFdmVudEVtaXR0ZXIoZXZlbnQsIGNhbGxiYWNrKSB7XG4gIC8qKlxuICAgKiBBZGQgZXZlbnQgYnVzIGdsb2JhbCBvciB3aXRoIGxpc3RlbmVyXG4gICAqIEBwYXJhbSAge1N0cmluZ30gZXZlbnRcbiAgICogQHBhcmFtICB7RnVuY3Rpb259IGNhbGxiYWNrXG4gICAqIEByZXR1cm4ge1ZvaWR9XG4gICAqL1xuICBjb25zdCBfZXZlbnRzID0gW107XG4gIGNvbnN0IGFsbCA9ICdBTExfRVZFTlRTJztcblxuICBmdW5jdGlvbiBvbihldmVudCwgY2FsbGJhY2ssIGxpc3RlbmVyID0gYWxsKSB7XG4gICAgX2V2ZW50c1tsaXN0ZW5lcl0gPSBfZXZlbnRzW2xpc3RlbmVyXSB8fCBbXTtcbiAgICBfZXZlbnRzW2xpc3RlbmVyXVtldmVudF0gPSBfZXZlbnRzW2xpc3RlbmVyXVtldmVudF0gfHwgW107XG4gICAgX2V2ZW50c1tsaXN0ZW5lcl1bZXZlbnRdLnB1c2goY2FsbGJhY2spO1xuICB9XG5cbiAgZnVuY3Rpb24gb25jZShldmVudCwgY2FsbGJhY2ssIGxpc3RlbmVyID0gYWxsKSB7XG4gICAgY2FsbGJhY2sub25jZSA9IHRydWU7XG4gICAgb24oZXZlbnQsIGNhbGxiYWNrLCBsaXN0ZW5lcik7XG4gIH1cblxuICBmdW5jdGlvbiBvZmYoZXZlbnQsIGNhbGxiYWNrLCBsaXN0ZW5lciA9IGFsbCkge1xuICAgIGlmIChldmVudCBpbiBfZXZlbnRzW2xpc3RlbmVyXSA9PT0gZmFsc2UpIHJldHVybjtcbiAgICBfZXZlbnRzW2xpc3RlbmVyXVtldmVudF0uc3BsaWNlKF9ldmVudHNbbGlzdGVuZXJdW2V2ZW50XS5pbmRleE9mKGNhbGxiYWNrKSwgMSk7XG4gIH1cblxuICBmdW5jdGlvbiBlbWl0KGV2ZW50LCBlID0ge30sIGxpc3RlbmVyID0gYWxsKSB7XG4gICAgX2V2ZW50c1tsaXN0ZW5lcl0gPSBfZXZlbnRzW2xpc3RlbmVyXSB8fCBbXTtcbiAgICBpZiAoZXZlbnQgaW4gX2V2ZW50c1tsaXN0ZW5lcl0gPT09IGZhbHNlKSByZXR1cm47XG4gICAgZWxzZSB7XG4gICAgICBmb3IgKGNvbnN0IGFjdGlvbiBvZiBfZXZlbnRzW2xpc3RlbmVyXVtldmVudF0pIHtcbiAgICAgICAgYWN0aW9uKGUpO1xuICAgICAgICBpZiAoYWN0aW9uLm9uY2UpIGJyZWFrO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHJldHVybiB7XG4gICAgb24sXG4gICAgb25jZSxcbiAgICBvZmYsXG4gICAgZW1pdFxuICB9XG59XG5cbmNvbnN0IE1vZHVsZUV2ZW50RW1pdHRlciA9IGF3YWl0IGNyZWF0ZU1vZHVsZUV2ZW50RW1pdHRlcigpO1xuLy8gZWFjaCBmdW5jdGlvbiBvciBjbGFzcyB3aGljaCBjb21tdW5pY2F0ZXMgbmVlZCBhbmQgZXZlbnQgb2JqZWN0IGFuZCBvcHRpb25hbCBlbWl0RXZlbnQgZnVuY3Rpb25cblxuLy8gZ2xvYmFsIGNhcHR1cmUgZXJyb3JzXG5jb25zdCBldmVudG5hbWVzID0ge1xuICBlcnJvcjogJ2Vycm9yJ1xufVxuTW9kdWxlRXZlbnRFbWl0dGVyLm9uKGV2ZW50bmFtZXMuZXJyb3IsIChlKSA9PiB7XG4gIEFsZXJ0Qm94LnJlbmRlckFsZXJ0KHtcbiAgICB0eXBlOiBBbGVydEJveC5hbGVydGNvbmZpZy50eXBlcy5lcnJvcixcbiAgICBjb250ZW50OiBlLFxuICAgIGludmVyc2U6IHRydWUsXG4gICAgZGlzbWlzc2libGU6IHRydWVcbiAgfSk7XG59KTtcbmV4cG9ydCB7XG4gIE1vZHVsZUV2ZW50RW1pdHRlclxufSJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/modules/module-event-emitter.js\n")},"./src/modules/table-component.js":(module,__webpack_exports__,__webpack_require__)=>{"use strict";eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   TableComponent: () => (/* binding */ TableComponent)\n/* harmony export */ });\n/* harmony import */ var dompurify__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! dompurify */ \"./node_modules/dompurify/dist/purify.js\");\n/* harmony import */ var dompurify__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(dompurify__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var deep_equal__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! deep-equal */ \"./node_modules/deep-equal/index.js\");\n/* harmony import */ var deep_equal__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(deep_equal__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _modules_utils_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../modules/utils.js */ \"./src/modules/utils.js\");\n/* harmony import */ var _modules_module_event_emitter_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../modules/module-event-emitter.js */ \"./src/modules/module-event-emitter.js\");\n/* harmony import */ var _modules_text_highlight_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../modules/text-highlight.js */ \"./src/modules/text-highlight.js\");\n/* harmony import */ var debounce__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! debounce */ \"./node_modules/debounce/index.js\");\n/* harmony import */ var debounce__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(debounce__WEBPACK_IMPORTED_MODULE_6__);\n/* harmony import */ var _modules_modules_config_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../modules/modules-config.js */ \"./src/modules/modules-config.js\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_modules_module_event_emitter_js__WEBPACK_IMPORTED_MODULE_3__]);\n_modules_module_event_emitter_js__WEBPACK_IMPORTED_MODULE_3__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n\n\n\n\nlet instance = [];\n// valid fetch urlparts\nconst fetchfroms = {\n  collectionlist: '/gui/collectionlist/',\n  prjlist: '/gui/prjlist/',\n  prjsamplestats: '/gui/prjsamplestats',\n  userslist: '/gui/admin/userslist/',\n  guestslist:'/gui/guestslist/',\n  organizationslist:'/gui/organizationslist/',\n  prjpredict: '/gui/prjsforprediction/'\n};\n// specifc css\nconst tablecss = {\n  showfull: 'showfull',\n  tipinline: \"tip-inline\",\n  searchresults: \"search-results\",\n  selectaction: \"selectaction\",\n  absinput: 'absinput',\n  disabled: 'table-disabled',\n  ascending: 'table-ascending',\n  descending: 'table-descending',\n  tipover: 'tipover absolute z-10 text-stone-50 rounded-sm bg-stone-600 px-2 py-0.5 -mt-5 ml-12 ',\n  hide: 'hide',\n  nowrap: 'truncate',\n  buttonexpand: 'button-expand',\n  bordert: 'border-t',\n  borderb: 'border-b',\n  maxtabstath: 'max-tabstat-h',\n  overflowyhidden: 'overflow-y-hidden',\n  icochevrondown: 'icon-chevron-down',\n  iconchevronup: 'icon-chevron-up',\n  pointer: 'cursor-pointer',\n  hidden: 'hidden',\n};\nconst tableselectors = {\n  table: '.table-table',\n  wrapper: '.table-wrapper',\n  top: '.table-top',\n  input: '.table-input',\n  search: '.table-search',\n  export: '.button-export',\n  filters: '.table-filters',\n  sorter: '.table-sorter',\n  details: 'details[data-what=\"about\"]',\n  tip: '.' + _modules_modules_config_js__WEBPACK_IMPORTED_MODULE_5__.css.component.table.tip,\n  tipover: '.tipover',\n  wait: 'wait-please',\n  sorton: '.sorton',\n};\nObject.freeze(tablecss);\nObject.freeze(tableselectors);\nconst NOTFOUND = '#NOTFOUND#';\nclass TableComponent {\n  uuid = null;\n  grid = {\n    columns: [],\n    active: [],\n    hidden: [],\n    data: []\n  };\n  domdef = {\n    columns: [],\n    data: [],\n  };\n  wrapper = null;\n  dom = null;\n  params = null;\n  _events = {};\n  eventnames = {\n    init: \"table.init\",\n    update: \"table.update\",\n    refresh: \"table.refresh\",\n    resize: \"table.resize\",\n    search: \"table.search\",\n    searchend: \"table.searchend\",\n    sorting: \"table.sorting\",\n    sorted: \"table.sorted\",\n    load: \"table.loaded\",\n    dismiss: 'table.dismiss'\n  }\n  labels = {\n    placeholder: \"Search...\",\n    perPage: \"{select} entries per page\",\n    noRows: \"No entries found\",\n    info: \"Showing {start} to {end} of {rows} entries\",\n    noResults: \"No result match your search query\"\n  };\n  cellidname = \"id\";\n  searching = false;\n  sorting = false;\n  initialized = false;\n  plugins = {};\n  constructor(container, options = {}) {\n    if (!container) return;\n    container = container instanceof HTMLElement ? container : document.querySelector(container);\n    if (!container) return;\n    //can select multiples tables in one page  or load data in the same table\n    this.uuid = (container.dataset.uuid) ? container.dataset.uuid : (0,_modules_utils_js__WEBPACK_IMPORTED_MODULE_2__.generate_uuid)();\n    if (!instance[this.uuid] || !deep_equal__WEBPACK_IMPORTED_MODULE_1___default()(container.dataset, instance[this.uuid].params)) {\n      this.init(container);\n    } else this.refresh();\n    return instance[this.uuid];\n\n  }\n  init(container) {\n    this.params = container.dataset;\n    let table = container.querySelector('table');\n    if (!table) {\n      table = document.createElement('table');\n      container.appendChild(table);\n    }\n    table.id = 'table-' + container.id;\n    table.classList.add(tableselectors.table.substr(1))\n    this.dom = table;\n    let top = {\n      nodename: \"DIV\",\n      attributes: {\n        class: tableselectors.top.substr(1)\n      }\n    };\n\n    let wrapper = this.objToElement({\n      nodename: 'DIV',\n      attributes: {\n        class: tableselectors.wrapper.substr(1)\n      },\n      childnodes: [top]\n    });\n    container.appendChild(wrapper);\n    wrapper.appendChild(table);\n    this.wrapper = wrapper;\n    this.labels = (this.params.labels) ? this.params.labels : this.labels;\n    // cellid\n    this.cellidname = (this.params.hasOwnProperty(\"cellid\")) ? this.params.cellid : this.cellidname;\n    // only valid from values - fetchfroms\n    this.params.from = (this.params.from) ? dompurify__WEBPACK_IMPORTED_MODULE_0___default().sanitize(this.params.from) : null;\n    const from = (this.params.from) ? ((Object.keys(fetchfroms).indexOf(this.params.from) >= 0) ? fetchfroms[this.params.from] : null) : null;\n    this.dom.classList.add(_modules_modules_config_js__WEBPACK_IMPORTED_MODULE_5__.css.hide);\n    if (from) {\n      if (this.params.defer) this.deferLoad(container, from);\n      else this.fetchData(container, from);\n    } else this.tableActivate(container);\n\n    this.dt = Date.now();\n  }\n\n  waitActivate(container) {\n    let waitdiv = container.querySelector('#' + tableselectors.wait);\n    if (!waitdiv) {\n      waitdiv = document.createElement('div');\n      waitdiv.id = tableselectors.wait;\n      container.append(waitdiv);\n    }\n    this.waitdiv = waitdiv;\n  }\n\n  waitDeactivate(message = null, type = 'info') {\n    if (!this.waitdiv) return;\n    if (message) {\n      this.waitdiv.classList.remove(_modules_modules_config_js__WEBPACK_IMPORTED_MODULE_5__.css.hide);\n      if (type === null) this.waitdiv.innerHTML = `${message}`;\n      this.waitdiv.innerHTML = `<div class=\"alert is-${type}\">${message}</div>`;\n    } else this.waitdiv.classList.add(_modules_modules_config_js__WEBPACK_IMPORTED_MODULE_5__.css.hide);\n  }\n\n  deferLoad(container, from) {\n    const btn = container.querySelector(this.params.defer);\n    if (!btn) return;\n\n    btn.addEventListener('click', (e) => {\n      this.fetchData(container, from);\n      btn.remove();\n    });\n  }\n\n  fetchData(container, fromurl, pagestart = 0) {\n    this.waitActivate(container);\n    const pagesize = (this.params.pagesize) ? this.params.pagesize : 0;\n    let from = fromurl;\n    if (this.params.fromid) from += '/' + this.params.fromid;\n    let query = (this.params.import) ? {\n      typeimport: dompurify__WEBPACK_IMPORTED_MODULE_0___default().sanitize(this.params.import),\n      gz: true,\n    } : {};\n    if (pagesize) {\n      query.window_start = pagestart;\n      query.window_size = pagesize;\n    }\n    if (this.params.listall) query.listall = this.params.listall;\n    const queryparams = new URLSearchParams(window.location.search);\n    const querykeys = this.cellidname + 's';\n    if (querykeys.length) {\n      for (const entry of queryparams.entries()) {\n        if (querykeys.indexOf(entry[0]) >= 0) query[entry[0]] = entry[1];\n      }\n    }\n    if (Object.keys(query).length) from += '?' + new URLSearchParams(query);\n    this.dt = Date.now();\n    fetch(from, (0,_modules_utils_js__WEBPACK_IMPORTED_MODULE_2__.fetchSettings)()).then(response => {\n      if (response.ok) return response.json();\n      else return Promise.reject(response);\n    }).then(async tabledef => {\n      if (this.waitdiv) this.waitdiv.innerHTML = ((this.waitdiv.dataset.loaded) ? dompurify__WEBPACK_IMPORTED_MODULE_0___default().sanitize(this.waitdiv.dataset.loaded) : _modules_modules_config_js__WEBPACK_IMPORTED_MODULE_5__.default_messages.dataloaded);\n      if (pagestart > 0) {\n        if (tabledef.data.length) {\n          this.domInsertRows(tabledef);\n        } else pagesize = 0;\n      }\n      if (pagesize === 0) {\n        let now = Date.now();\n        console.log('seconds to fetch ', (Date.now() - this.dt) / 1000);\n        this.dt = now;\n        if (tabledef.data.length || pagestart > 0) await this.tableActivate(container, tabledef);\n        else this.waitDeactivate('no result', 'default');\n        now = Date.now();\n        console.log('plugins loaded', (Date.now() - this.dt) / 1000);\n        this.dt = now;\n      } else this.fetchData(container, fromurl, pagestart + pagesize);\n\n    }).catch((err) => { /* print error from response */\n      console.log('error', err);\n      this.waitDeactivate(err.status + ` ` + err.statusText, 'error');\n    });\n  }\n\n  async dataToTable(tabledef) {\n    if (!tabledef.data) return;\n    if (tabledef.columns) {\n      await this.convertColumns(tabledef);\n      let tr;\n      let thead = this.dom.tHead;\n      if (!thead) {\n        // create table headings\n        thead = document.createElement('thead');\n        tr = document.createElement('tr');\n        this.dom.appendChild(thead);\n      } else if (!thead.querySelector('tr')) {\n        tr = document.createElement('tr');\n\n      } else {\n        tr = thead.querySelector('tr');\n        tr.innerHTML = ``;\n      }\n      let tbody = (this.dom.tBodies.length) ? this.dom.tBodies[0] : null;\n      if (!tbody) {\n        tbody = document.createElement('tbody');\n        this.dom.appendChild(tbody);\n      }\n      const isjson = (!tabledef.hasOwnProperty('data') || (tabledef.hasOwnProperty('type') && tabledef.type === \"json\"));\n\n      this.grid.columns.forEach((column, index) => {\n\n        if (!column.hidden) {\n          const th = document.createElement('th');\n          th.innerHTML = dompurify__WEBPACK_IMPORTED_MODULE_0___default().sanitize(column.label);\n          if (column.sort) th.dataset.sort = column.sort;\n          if (column.format) th.dataset.type = column.type;\n          if (column.name) th.dataset.name = column.name;\n          // TODO - find a place to define col import props\n          // set headings dataset values for import module\n          if (this.params.import)['selectcells', 'what', 'autocomplete', 'parts', 'value'].forEach(prop => {\n            if (column.hasOwnProperty(prop)) th.dataset[prop] = column[prop];\n          });\n          th.dataset.sortable = (column.sortable) ? true : false;\n          tr.appendChild(th);\n          this.grid.active.push(index);\n        } else this.grid.hidden.push(index);\n\n      });\n\n\n      thead.appendChild(tr);\n      const datalastused = (this.params.lastused && this.params.lastused.length > 0) ? [] : null;\n      //#TODO lastused reorder\n      if (isjson) {\n        this.grid.data = [];\n        tabledef.data.forEach((data, i) => {\n          const row = [];\n          let j = 0;\n          Object.entries(tabledef.columns).forEach(([key, column], i) => {\n            if (!column.hasOwnProperty('emptydata')) {\n              if (data.hasOwnProperty(key)) row[j] = data[key];\n              else if (column.field && data.hasOwnProperty(column.field)) row[j] = data[column.field];\n              else row[j] = null;\n              j++;\n            }\n          });\n          this.grid.data.push(row);\n        });\n      } else this.grid.data = tabledef.data;\n\n      const tfoot = this.dom.tFoot;\n      if (this.grid.active.length === 0) {\n        tbody.innerHTML = `<tr><td>${this.labels.noRows}</td</tr>`;\n        if (tfoot) tfoot.remove();\n        return;\n      } else if (tfoot && tfoot.querySelector('tr')) {\n        const tf = tfoot.querySelector('tr').childNodes;\n        this.grid.hidden.forEach(i => {\n          tf[i].remove();\n        });\n      };\n\n      this.renderTbody(tbody);\n    }\n  }\n\n  tableToData() {\n    if (!this.dom.querySelector('thead')) {this.dom.classList.remove(_modules_modules_config_js__WEBPACK_IMPORTED_MODULE_5__.css.hide);return;}\n    const datalastused = (this.params.lastused && this.params.lastused.length > 0) ? [] : null;\n    this.dom.classList.add(_modules_modules_config_js__WEBPACK_IMPORTED_MODULE_5__.css.hide);\n    const cell_to_obj = (cell) => {\n      const celltext = cell.innerText;\n      const obj = {\n        data: celltext,\n      }\n      const cellhtml = cell.innerHTML;\n      if (celltext !== cellhtml) obj.html = cellhtml;\n      return obj;\n    }\n    const ths = (this.dom.querySelectorAll('thead tr th').length) ? this.dom.querySelectorAll('thead tr th') : this.dom.querySelectorAll('thead tr td');\n    const trs = this.dom.querySelectorAll('tbody tr');\n    let active = 0,\n      hidden = 0;\n\n    function find_label(th) {\n      if (th.childNodes.length) return find_label(th.childNodes[0]);\n      else return th.innerText;\n    }\n    ths.forEach((th, index) => {\n      const col = Object.assign({}, th.dataset);\n      if (col.mask) th.classList.add(tablecss.hidden);\n      if (col.hidden && (0,_modules_utils_js__WEBPACK_IMPORTED_MODULE_2__.string_to_boolean)(col.hidden)) {\n        col.hidden = true;\n        th.remove();\n      }\n      col.label = find_label(th);\n      if (col.type) {\n        col.format = col.type;\n        delete col.type;\n      }\n      col.index = index;\n      if (col.hidden) this.grid.hidden.push(index);\n      else this.grid.active.push(index);\n      this.grid.columns.push(col);\n    });\n    const cellid = this.getCellId(this.cellidname);\n    trs.forEach((tr, i) => {\n      if (cellid < 0) tr.dataset[this.cellidname] = i;\n      else if (i === cellid) tr.dataset[this.cellidname] = this.getCellData(i, this.cellidname, cellid);\n      const data = [];\n      tr.querySelectorAll('th,td').forEach((td, index) => {\n        if (this.grid.columns[index].hasOwnProperty('mask')) td.classList.add(tablecss.hidden);\n        if (this.grid.hidden.indexOf(index) >= 0) td.remove();\n        data.push(td.innerText);\n      });\n      this.grid.data.push(data)\n    });\n\n    this.dom.querySelectorAll('tfoot tr th').forEach((td, index) => {\n      if (this.grid.columns[index].hasOwnProperty('mask')) td.classList.add(tablecss.hidden);\n      if (this.grid.hidden.indexOf(index) >= 0) td.remove();\n    });\n    this.dom.classList.remove(_modules_modules_config_js__WEBPACK_IMPORTED_MODULE_5__.css.hide);\n    return;\n  }\n  renderTbody(tbody) {\n    const l = this.grid.data.length;\n    for (let i = 0; i < l; i++) {\n      const tr = this.createTableRow(this.grid.data[i], i);\n      tbody.append(tr);\n    };\n\n\n\n  }\n  async tableActivate(container, tabledef = null) {\n    _modules_module_event_emitter_js__WEBPACK_IMPORTED_MODULE_3__.ModuleEventEmitter.once(this.eventnames.load, () => {\n      this.initPlugins(container);\n      this.initSearch();\n      this.initSort();\n      this.waitDeactivate();\n      // hide and move waitdiv in the wrapper for inner elements display\n      this.dom.classList.remove(_modules_modules_config_js__WEBPACK_IMPORTED_MODULE_5__.css.hide);\n      if (this.afterLoad) this.afterLoad();\n      // move import zones and/or search zone - reorg the page display\n      // fetch once the same table\n      container.dataset.table = this.params.table = true;\n      this.initialized = true;\n    }, this.uuid);\n    // dismiss table when dismiss modal\n    _modules_module_event_emitter_js__WEBPACK_IMPORTED_MODULE_3__.ModuleEventEmitter.once(this.eventnames.dismiss, (e) => {\n      this.destroy();\n    }, this.uuid);\n    if (tabledef) tabledef = await this.dataToTable(tabledef);\n    else await this.tableToData();\n    if (this.grid.data.length) _modules_module_event_emitter_js__WEBPACK_IMPORTED_MODULE_3__.ModuleEventEmitter.emit(this.eventnames.load, {}, this.uuid);\n    instance[this.uuid] = true;\n  }\n\n  tableAppendRows(rows) {\n    console.log('rows');\n  }\n  destroy() {\n    if (this.dataImport) this.dataImport = null;\n    this.dom = null;\n    delete instance[this.uuid];\n  }\n\n  refresh(e) {\n    if (this.dataImport) this.dataImport.resetSelectors();\n  }\n  labelFormatter(column) {\n    let align = ``;\n    if (['number', 'progress', 'decimal'].find(format => format === column.format)) align = _modules_modules_config_js__WEBPACK_IMPORTED_MODULE_5__.css.right;\n    if (column.subfield) return `${column.label} <span class=\"sublabel\">${column.sublabel}</span>`;\n    else if (column.label) return `<span class=\"${align}\">${column.label}</span>`;\n    else return ``;\n  }\n  getCellId(name) {\n    let cols = this.grid.columns.filter(column => (column.name === name));\n    return (cols.length) ? cols[0].index : -1;\n  }\n\n  getCellData(rowIndex, name, cellIndex = null) {\n    cellIndex = (cellIndex === null) ? this.getCellId(name) : cellIndex;\n    if (cellIndex < 0) return null;\n    return (this.grid.data.length) ? ((this.grid.data[rowIndex]) ? this.grid.data[rowIndex][cellIndex] : null) : null;\n  }\n\n  rowAttributes(tr, index) {\n    const id = this.getCellData(index, this.cellidname);\n    tr.dataset[this.cellidname] = id;\n    if (this.setRowAttributes) tr = this.setRowAttributes(this, tr, id);\n    return tr;\n  }\n\n  createTableRow(row, index, isheader = false) {\n    const tr = document.createElement('tr');\n    let td;\n    this.grid.columns.forEach(column => {\n      if (column.hasOwnProperty('hidden') && column.hidden === true) return;\n      const cell = row[column.index];\n      if (column.hasOwnProperty(\"render\")) {\n        td = column.render(cell, index, column.index);\n        td.nodename = (isheader) ? 'TH' : 'TD';\n        td = this.objToElement(td);\n      } else {\n        td = (isheader) ? document.createElement('th') : document.createElement('td');\n        td.appendChild(document.createTextNode(cell));\n      }\n      tr.appendChild(td);\n    })\n    return this.rowAttributes(tr, index);\n  }\n\n  objToElement(obj) {\n    if (obj.nodename === \"#text\") return document.createTextNode(obj.data);\n    const el = document.createElement(obj.nodename);\n    if (obj.hasOwnProperty(\"html\")) el.innerHTML = obj.html;\n    else el.textContent = obj.data;\n    if (obj.hasOwnProperty(\"attributes\")) {\n      for (const attr in obj.attributes) {\n        el.setAttribute(attr, obj.attributes[attr]);\n      }\n    }\n    if (obj.hasOwnProperty(\"childnodes\")) {\n      obj.childnodes.forEach(childnode => {\n\n        el.appendChild(this.objToElement(childnode));\n      });\n\n    }\n    return el;\n  }\n\n  setTextNode(value) {\n    return {\n      nodename: \"#text\",\n      data: value\n    };\n  }\n  async getFormatters() {\n    let formatters = {\n      controls: (value, rowIndex, cellIndex, td = {}) => {\n        const column = this.grid.columns[cellIndex];\n        const id = this.getCellData(rowIndex, column.field);\n        const actions = (column.actions) ? column.actions : null;\n        if (!actions) return ``;\n        let controls = [];\n        Object.entries(actions).forEach(([key, action]) => {\n          controls.push({\n            nodename: \"A\",\n            attributes: {\n              class: `btn is-${key} `,\n              href: `${action.link}${id}`\n            },\n            childnodes: [this.setTextNode(action.label)]\n          });\n\n        });\n        if (!td.hasOwnProperty('attributes')) td.attributes = {};\n        td.attributes.class = _modules_modules_config_js__WEBPACK_IMPORTED_MODULE_5__.css.component.table.controls;\n        td.childnodes = controls;\n        return td;\n      },\n      select: (value, rowIndex, cellIndex, td = {}) => {\n        const column = this.grid.columns[cellIndex];\n        value = (isNaN(value)) ? this.getCellData(rowIndex, column.field) : value;\n\n        td.childnodes = [{\n          nodename: \"INPUT\",\n          attributes: {\n            type: \"radio\",\n            name: `${this.uuid}select`,\n            value: String(value)\n          }\n        }];\n        return td;\n      },\n      selectmultiple: (value, rowIndex, cellIndex, td = {}) => {\n        const column = this.grid.columns[cellIndex];\n        value = (isNaN(value)) ? ((column.hasOwnProperty('field')) ? this.getCellData(rowIndex, column.field) : value) : value;\n        td.childnodes = [{\n          nodename: \"INPUT\",\n          attributes: {\n            type: \"checkbox\",\n            name: `${this.uuid}select[]`,\n            value: String(value)\n          }\n        }];\n        return td;\n      },\n      decimal: (value, rowIndex, cellIndex, td = {}) => {\n        if (isNaN(value)) value = 0;\n        value = parseFloat(value).toFixed(2);\n        if (value - parseInt(value) === 0) value = parseInt(value);\n        if (!td.hasOwnProperty('attributes')) td.attributes = {};\n        td.attributes.class = _modules_modules_config_js__WEBPACK_IMPORTED_MODULE_5__.css.number;\n        td.childnodes = [this.setTextNode(value)];\n        return td;\n      },\n      number: (value, rowIndex, cellIndex, td = {}) => {\n        if (isNaN(value)) value = 0;\n        if (!td.hasOwnProperty('attributes')) td.attributes = {};\n        td.attributes.class = _modules_modules_config_js__WEBPACK_IMPORTED_MODULE_5__.css.number;\n        td.childnodes = [this.setTextNode(value)];\n        return td;\n      },\n      check: (value, rowIndex, cellIndex, td = {}) => {\n        if (isNaN(value)) value = ``;\n        switch (value) {\n          case true:\n          case 'Y':\n          case 1:\n            value = \"\";\n            break;\n          default:\n            value = \"no-\";\n            break;\n        }\n        const icon = {\n          nodename: \"I\",\n          attributes: {\n            class: `icon-sm  icon-${value}check `\n          },\n          childnodes: []\n        }\n        const column = this.grid.columns[cellIndex];\n        const id = this.getCellData(rowIndex, this.cellidname);\n        if (column.hasOwnProperty(\"toggle\")) td.childnodes = [{\n          nodename: \"A\",\n          attributes: {\n            \"data-request\": \"toggle\",\n            \"data-action\": `${column.toggle.link}/${id}`,\n            \"href\": \"javascript:void()\"\n\n          },\n          childnodes: [icon]\n\n        }]\n        else td.childnodes = [icon];\n        return td;\n      },\n      text: (value, rowIndex, cellIndex, td = {}) => {\n        if (value === null) td.childnodes = [];\n        else {\n          value = value.replaceAll('\\r\\n', ', ');\n          if (value !== ``) td.childnodes = [{\n            nodename: \"DIV\",\n            attributes: {\n              class: _modules_modules_config_js__WEBPACK_IMPORTED_MODULE_5__.css.component.table.tip\n            },\n            childnodes: [this.setTextNode(value)]\n          }];\n          else td.childnodes = [];\n        }\n        return td;\n      },\n      default: (value, rowIndex, cellIndex, td = {}) => {\n        if (value === null || value === ``) td.childnodes = [];\n        else td.childnodes = [this.setTextNode(value)];\n        return td;\n      }\n\n    }\n    let tablecustom = null;\n\n    switch (this.params.from) {\n      case 'collectionlist':\n        tablecustom = await __webpack_require__.e(/*! import() */ \"src_modules_table-collection_js\").then(__webpack_require__.bind(__webpack_require__, /*! ../modules/table-collection.js */ \"./src/modules/table-collection.js\"));\n        this.cellidname = _modules_modules_config_js__WEBPACK_IMPORTED_MODULE_5__.models.id;\n        break;\n      case 'prjlist':\n        tablecustom = await __webpack_require__.e(/*! import() */ \"src_modules_table-project_js\").then(__webpack_require__.bind(__webpack_require__, /*! ../modules/table-project.js */ \"./src/modules/table-project.js\"));\n        this.cellidname = _modules_modules_config_js__WEBPACK_IMPORTED_MODULE_5__.models.projid;\n        break;\n      case 'prjsamplestats':\n        tablecustom = await __webpack_require__.e(/*! import() */ \"src_modules_table-sample_js\").then(__webpack_require__.bind(__webpack_require__, /*! ../modules/table-sample.js */ \"./src/modules/table-sample.js\"));\n        this.cellidname = _modules_modules_config_js__WEBPACK_IMPORTED_MODULE_5__.models.sampleid;\n        break;\n      case \"prjpredict\":\n        tablecustom = await __webpack_require__.e(/*! import() */ \"src_modules_table-prediction_js\").then(__webpack_require__.bind(__webpack_require__, /*! ../modules/table-prediction.js */ \"./src/modules/table-prediction.js\"));\n        this.cellidname = _modules_modules_config_js__WEBPACK_IMPORTED_MODULE_5__.models.projid;\n\n        break;\n    }\n\n    return (tablecustom) ? { ...formatters,\n      ...tablecustom.default(this)\n    } : formatters;\n\n\n  }\n  async convertColumns(tabledef) {\n    const columns = (tabledef.columns) ? tabledef.columns : ((this.params.columns) ? JSON.parse(this.params.columns) : null);\n    if (!columns) return;\n    const formatters = await this.getFormatters();\n    //\n    const fields = [];\n    Object.entries(tabledef.columns).forEach(([key, column]) => {\n      if (!column.hasOwnProperty('emptydata')) fields.push(key);\n    });\n    const map_column = (key, column, index) => {\n      if (!column) return {\n        index: index,\n        name: key,\n        hidden: true\n      };\n      let col = {\n        index: index,\n        name: key,\n        label: this.labelFormatter(column),\n        sortable: true,\n\n      };\n      col.index = (column.hasOwnProperty('emptydata')) ? fields.indexOf(column.emptydata) : fields.indexOf(key);\n      if (column.notsortable) col.sortable = false;\n      else if (column.sortable) col.sort = col.sortable;\n      col.searchable = (col.notsearchable) ? false : true;\n      if (column.hidden) col.hidden = (0,_modules_utils_js__WEBPACK_IMPORTED_MODULE_2__.string_to_boolean)(column.hidden);\n      if (['number', 'decimal'].find(format => format === column.format)) col.type = 'number';\n      let render = null;\n      switch (key) {\n        case 'select':\n          const select = (column.select && column.select == \"controls\") ? \"controls\" : ((column.selectcells) ? \"imports\" : column.select);\n          if (select) {\n            col = { ...column,\n              ...col\n            }\n\n            col.sortable = col.searchable = false;\n          }\n          break;\n      }\n      if (!column.hasOwnProperty('hidden')) {\n        const select = (column.select && column.select == _modules_modules_config_js__WEBPACK_IMPORTED_MODULE_5__.models.controls) ? _modules_modules_config_js__WEBPACK_IMPORTED_MODULE_5__.models.controls : ((column.selectcells) ? _modules_modules_config_js__WEBPACK_IMPORTED_MODULE_5__.models.imports : column.select)\n        const format = (column.format) ? column.format : ((column.subfield) ? column.subfield : ((select) ? select : \"default\"));\n        if (formatters && formatters[format]) col.render = formatters[format];\n\n      }\n      return col;\n    }\n\n    this.grid.columns = Object.entries(columns).map(([key, column], index) => map_column(key, column, index));\n  }\n  initEvents() {\n\n    _modules_module_event_emitter_js__WEBPACK_IMPORTED_MODULE_3__.ModuleEventEmitter.on(this.eventnames.update, () => {\n      this.dom.classList.remove(_modules_modules_config_js__WEBPACK_IMPORTED_MODULE_5__.css.hide);\n    }, this.uuid);\n  }\n  initPlugins(container) {\n    if (!this.grid.data.length) return;\n    if (this.params.import && this.initImport) this.initImport(this);\n    if (this.params.expand) this.makeExpandable(container);\n    if (this.params.export) this.makeExportable(container);\n    if (this.params.details || this.dom.querySelector(tableselectors.details)) {\n      this.initDetails();\n    } else this.initEvents();\n    if (this.params.onselect) this.initSelect(container);\n    if (this.dom.querySelectorAll('thead [data-altsort]').length) this.initAlternateSort(this.dom.querySelectorAll('thead [data-altsort]'));\n    if (this.params.filters) {\n      const top = this.wrapper.querySelector(tableselectors.top);\n      if (top && top.children.length) {\n        const filters = document.querySelector(tableselectors.filters);\n        // insert  filters node  in datatable top\n        if (filters) top.prepend(filters);\n      }\n    }\n    if (this.dom.querySelector(tableselectors.tip)) {\n      this.initTips();\n    }\n\n  }\n  initSort() {\n\n    const ths = this.dom.querySelectorAll('thead th');\n    let index = 0;\n    this.grid.columns.forEach((column, i) => {\n      if (column.hasOwnProperty('hidden')) return;\n      if (column.sortable) {\n        const th = ths[index];\n        const a = document.createElement('a');\n        a.classList.add(tableselectors.sorter.substr(1));\n        a.appendChild(th.childNodes[0]);\n        th.appendChild(a);\n        th.childNodes.forEach(child => {\n          th.appendChild(child);\n        });\n\n        a.addEventListener('click', (e) => {\n          e.stopImmediatePropagation();\n          if (this.sorting === true || this.searching === true) {\n            e.preventDefault();\n            return false;\n          }\n          this.sortColumn(th, column.index);\n        });\n      }\n      index++;\n    });\n    this.sorting = false;\n    // remove details when sorting\n    _modules_module_event_emitter_js__WEBPACK_IMPORTED_MODULE_3__.ModuleEventEmitter.on(this.eventnames.sorting, (req) => {\n      // req {dir:direction, index:index}\n      if (this.plugins.jsDetail) this.plugins.jsDetail.activeDetail(false);\n      this.dom.querySelectorAll('.table-sorter').forEach((a, i) => {\n        a.classList.add(((i === req.index) ? _modules_modules_config_js__WEBPACK_IMPORTED_MODULE_5__.css.wait : _modules_modules_config_js__WEBPACK_IMPORTED_MODULE_5__.css.disabled));\n      });\n      this.sorting = true;\n    }, this.uuid);\n    // remove details when sorting\n    _modules_module_event_emitter_js__WEBPACK_IMPORTED_MODULE_3__.ModuleEventEmitter.on(this.eventnames.sorted, (req) => {\n      // req {dir:direction, index:index}\n      this.dom.querySelectorAll('.table-sorter').forEach((a, i) => {\n        a.classList.remove(((i === req.index) ? _modules_modules_config_js__WEBPACK_IMPORTED_MODULE_5__.css.wait : _modules_modules_config_js__WEBPACK_IMPORTED_MODULE_5__.css.disabled))\n      });\n      this.sorting = false;\n    }, this.uuid);\n  }\n  sortColumn(th, index, dir = null) {\n    dir = (dir === null) ? ((th.classList.contains(tablecss.ascending)) ? false : (th.classList.contains(tablecss.descending)) ? true : ((th.dataset.sort) ? false : true)) : dir;\n    th.classList.toggle(tablecss.ascending);\n    th.classList.toggle(tablecss.descending);\n    _modules_module_event_emitter_js__WEBPACK_IMPORTED_MODULE_3__.ModuleEventEmitter.emit(this.eventnames.sorting, {\n      dir: dir,\n      index: th.cellIndex\n    }, this.uuid);\n    let rows = this.grid.data.map((row, i) => {\n      const cell = (0,_modules_utils_js__WEBPACK_IMPORTED_MODULE_2__.is_object)(row[index]) ? JSON.stringify(row[index]) : ((Array.isArray(row[index])) ? row[index][0] : row[index]);\n      return {\n        value: typeof cell === \"string\" ? cell.toLowerCase() : ((cell === null) ? 0 : cell),\n        row: i\n      }\n    });\n\n    const compare_coldata = function(a, b) {\n      const x = (dir ? a.value : b.value);\n      const y = (dir ? b.value : a.value);\n      return x.localeCompare(y, undefined, {\n        numeric: true,\n        sensitivity: 'base'\n      });\n\n    };\n\n    if (dir === false) {\n      th.classList.remove(tablecss.ascending);\n      th.classList.add(tablecss.descending);\n      th.setAttribute(\"aria-sort\", \"descending\");\n    } else {\n      th.classList.remove(tablecss.descending);\n      th.classList.add(tablecss.ascending);\n      th.setAttribute(\"aria-sort\", \"ascending\");\n    }\n\n    /* Clear asc/desc class names from the last sorted column's th if it isn't the same as the one that was just clicked */\n    if (this.dom.dataset.lastth !== undefined && th.cellIndex != this.dom.dataset.lastth) {\n      const headings = this.dom.querySelectorAll(\"thead th\");\n      headings[this.dom.dataset.lastth].classList.remove(tablecss.descending);\n      headings[this.dom.dataset.lastth].classList.remove(tablecss.ascending);\n      headings[this.dom.dataset.lastth].removeAttribute(\"aria-sort\");\n\n    }\n    this.dom.dataset.lastth = th.cellIndex;\n    const collator = new Intl.Collator(undefined, {\n      numeric: true,\n      sensitivity: 'base'\n    })\n    rows.sort((a, b) => {\n      return collator.compare((dir ? a.value : b.value), (dir ? b.value : a.value))\n    });\n    /*rows.sort((a, b) => {\n      return compare_coldata(a, b);\n    });*/\n    const tbody = this.dom.querySelector('tbody');\n    const clone = tbody.cloneNode();\n    const trs = tbody.querySelectorAll('tr');\n    tbody.innerHTML = ``;\n    const sorted = [];\n    rows.forEach((r, i) => {\n      clone.appendChild(trs[r.row]);\n      sorted.push(this.grid.data[r.row]);\n\n    });\n    this.dom.replaceChild(clone, tbody);\n    _modules_module_event_emitter_js__WEBPACK_IMPORTED_MODULE_3__.ModuleEventEmitter.emit(this.eventnames.sorted, {\n      dir: dir,\n      index: th.cellIndex\n    }, this.uuid);\n\n\n  }\n\n  displaySelected(queries, indexes, cellid, toggle = null) {\n    const trs = this.dom.querySelectorAll('tbody tr');\n    if (toggle === null) toggle = function(tr, value, idx) {\n      tr.hidden = value;\n    }\n    const reset = (queries.length === 0 && indexes.length === 0);\n    trs.forEach((tr, index) => {\n      if (reset) toggle(tr, false);\n      else {\n        const val = (queries.length > 0 && indexes.length === 0) ? NOTFOUND : (tr.dataset[this.cellidname] !== null) ? tr.dataset[this.cellidname] : tr.cells[cellid].textContent;\n        const idx = indexes.indexOf(val);\n        if (idx < 0) toggle(tr, true, idx);\n        else toggle(tr, false, idx);\n      }\n    });\n  };\n\n  initSearch() {\n    const top = this.wrapper.querySelector(tableselectors.top);\n    if (!this.params.searchable || top === null) return;\n    if (this.grid.data.length < 10) return this.toggleAddOns();\n    else this.toggleAddOns([tableselectors.search + ' input'], false);\n    this.searching = false;\n    const cellid = this.getCellId(this.cellidname);\n    // search items\n    let searchbox = top.querySelector(tableselectors.search);\n    if (searchbox === null) {\n      searchbox = this.objToElement({\n        nodename: 'DIV',\n        attributes: {\n          class: tableselectors.search.substr(1)\n        },\n        childnodes: [{\n          nodename: 'input',\n          attributes: {\n            type: 'search',\n            name: 'table-search',\n            placeholder: this.labels.placeholder,\n            class: `${tableselectors.input.substr(1)} ${_modules_modules_config_js__WEBPACK_IMPORTED_MODULE_5__.css.input}`\n          }\n        }]\n      });\n      top.appendChild(searchbox);\n    }\n    const searchinput = searchbox.querySelector('input');\n    if (!searchinput) return;\n    let searchstring = ``;\n    const table_search = debounce__WEBPACK_IMPORTED_MODULE_6___default()((searchstring, casesensitive = false) => {\n      function search_string(str, casesensitive) {\n        str = (casesensitive) ? str : str.toLowerCase();\n        return str;\n      }\n\n      function search_queries(str, casesensitive) {\n        str = search_string(str, casesensitive);\n        let strs = [];\n        let phrase;\n        while ((phrase = str.match(/\"([^\"]+)\"/)) !== null) {\n\n          strs.push(phrase[1]);\n          str = str.substring(0, phrase.index) + str.substring(phrase.index + phrase[0].length);\n        }\n        // Get remaining space-separated words (if any)\n        str = str.trim();\n        if (str.length) strs = strs.concat(str.split(/\\s+/));\n        return strs;\n      }\n      const queries = search_queries(searchstring);\n      _modules_module_event_emitter_js__WEBPACK_IMPORTED_MODULE_3__.ModuleEventEmitter.emit(this.eventnames.search, {\n        searchstring: searchstring,\n        queries: queries\n      }, this.uuid);\n      let datas = this.grid.data,\n        indexes = [];\n      queries.forEach(qry => {\n        indexes = [];\n        datas = datas.filter((data, j) => {\n          const found = data.filter(cell => {\n            switch (typeof cell) {\n              case 'object':\n                cell = (cell) ? cell : ``;\n                try {\n                  cell = JSON.stringify(cell);\n                } catch (err) {\n                  console.log('search', err);\n                  cell = ``;\n                }\n                break;\n              case 'array':\n                cell = cell.join(' ');\n                break;\n              default:\n                cell = String(cell);\n                break;\n            }\n            return ((casesensitive) ? cell.indexOf(qry) > -1 : cell.toLowerCase().indexOf(qry)) > -1;\n          });\n\n          if (found.length > 0) {\n            if (cellid < 0) indexes.push(String(j));\n            else indexes.push(String(data[cellid]));\n            return data;\n          }\n        });\n      });\n      _modules_module_event_emitter_js__WEBPACK_IMPORTED_MODULE_3__.ModuleEventEmitter.emit(this.eventnames.searchend, {\n        queries: queries,\n        indexes: indexes,\n        cellid: cellid\n      }, this.uuid);\n    }, 300);\n    const display_search = (queries, indexes, cellid) => {\n      this.displaySelected(queries, indexes, cellid);\n    };\n    const clear_search = debounce__WEBPACK_IMPORTED_MODULE_6___default()(() => {\n      this.searching = true;\n      const trs = this.dom.querySelectorAll('tbody tr[hidden=\"\"]');\n      trs.forEach((tr, index) => {\n        tr.hidden = false;\n      });\n      this.searching = false;\n      searchinput.classList.remove(_modules_modules_config_js__WEBPACK_IMPORTED_MODULE_5__.css.wait);\n    }, 500);\n\n    const search_input = (value) => {\n      if (value !== searchstring) {\n        searchinput.classList.add(_modules_modules_config_js__WEBPACK_IMPORTED_MODULE_5__.css.wait);\n        searchstring = value;\n        if (value === '') {\n          clear_search();\n        } else if (value.length > 2) {\n          table_search(value);\n        }\n\n      }\n    }\n    searchinput.addEventListener(\"input\", (e) => {\n      search_input(e.target.value);\n    });\n    searchinput.addEventListener(\"click\", (e) => {\n      search_input(e.target.value);\n    });\n    _modules_module_event_emitter_js__WEBPACK_IMPORTED_MODULE_3__.ModuleEventEmitter.on(this.eventnames.search, (req) => {\n      //  request {searchstring:searchstring, queries:queries}\n      if (this.searching === false) {\n        if (this.plugins.jsDetail) this.plugins.jsDetail.activeDetail(false);\n      }\n      this.searching = true;\n    }, this.uuid);\n    _modules_module_event_emitter_js__WEBPACK_IMPORTED_MODULE_3__.ModuleEventEmitter.on(this.eventnames.searchend, (req) => {\n      // req {queries:queries,indexes: indexes, cellid:cellid}\n      display_search(req.queries, req.indexes, req.cellid);\n      searchinput.classList.remove(_modules_modules_config_js__WEBPACK_IMPORTED_MODULE_5__.css.wait);\n      this.searching = false;\n    }, this.uuid);\n    _modules_module_event_emitter_js__WEBPACK_IMPORTED_MODULE_3__.ModuleEventEmitter.on(this.eventnames.update, () => {\n      if (this.searching === false) {\n        setTimeout(() => {\n          refresh_details();\n        }, 300);\n      }\n    }, this.uuid);\n    this.toggleAddOns([tableselectors.search + ' input'], true);\n  }\n  initSelect(container) {\n    const inputs = this.dom.querySelectorAll('input[name^=\"' + this.uuid + '\"]');\n    if (inputs.length === 0) return;\n    const inputname = inputs[0].name;\n    let selectaction = container.querySelector('.' + tablecss.selectaction);\n    if (!selectaction) return;\n    document.body.append(selectaction);\n    selectaction.querySelector('a').addEventListener('click', (e) => {\n      let vals = [];\n      inputs.forEach(input => {\n        if (input.checked) vals.push(input.value);\n      });\n      if (selectaction.dataset.input) {\n        document.getElementById(selectaction.dataset.input).value = vals.join(',');\n        if (selectaction.dataset.form) document.getElementById(selectaction.dataset.form).submit();\n      } else e.currentTarget.href = this.params.onselect + encodeURI(vals.join(','));\n\n    });\n    const close = selectaction.querySelector('[data-dismiss]');\n    if (close) close.addEventListener('click', (e) => {\n      e.preventDefault();\n      e.stopImmediatePropagation();\n      popup_selected(null, null);\n    });\n\n    const popup_selected = (top = null, left = null, forceclose = false) => {\n      if (selectaction.dataset.close) {\n        document.body.append(selectaction);\n        close.classList.remove(tablecss.hidden);\n        selectaction.classList.add(tablecss.absinput);\n      }\n      if (top !== null && left !== null) {\n        selectaction.classList.remove(_modules_modules_config_js__WEBPACK_IMPORTED_MODULE_5__.css.hide);\n        selectaction.style.top = top + 'px';\n        selectaction.style.left = left + 'px';\n\n      } else {\n        if (forceclose === true) {\n          selectaction.classList.add(_modules_modules_config_js__WEBPACK_IMPORTED_MODULE_5__.css.hide);\n          delete selectaction.dataset.close;\n        } else {\n          selectaction.dataset.close = true;\n          close.classList.add(tablecss.hidden);\n          const toptable = this.wrapper.querySelector(tableselectors.top) ? this.wrapper.querySelector(tableselectors.top) : this.wrapper;\n          toptable.prepend(selectaction);\n          selectaction.classList.remove(tablecss.absinput);\n\n        }\n      }\n    }\n    inputs.forEach(input => {\n      input.addEventListener('change', (e) => {\n        if (input.checked) popup_selected(input.offsetTop, input.offsetLeft);\n        else if (this.dom.querySelectorAll('input[name^=\"' + this.uuid + '\"]:checked').length === 0) popup_selected(null, null, true);\n      });\n    });\n    if (this.dom.querySelectorAll('input[name^=\"' + this.uuid + '\"]:checked').length > 0) {\n      selectaction.classList.remove(_modules_modules_config_js__WEBPACK_IMPORTED_MODULE_5__.css.hide);\n      popup_selected(null, null);\n    }\n  }\n  async initDetails() { // TODO : generic\n    // about - one div to display cell details make it appear as table row expanding\n    const wrapper = this.wrapper;\n    const about = wrapper.querySelector('#' + tablecss.tipinline) ? wrapper.querySelector('#' + tablecss.tipinline) : tablecss.tipinline;\n    if (!this.plugins.JsDetail) {\n      const {\n        JsDetail\n      } = await\n      __webpack_require__.e(/*! import() */ \"src_modules_js-detail_js\").then(__webpack_require__.bind(__webpack_require__, /*! ../modules/js-detail.js */ \"./src/modules/js-detail.js\"));\n      this.plugins.JsDetail = JsDetail;\n    }\n\n    if (!this.plugins.JsAccordion) {\n      const {\n        JsAccordion\n      } = await __webpack_require__.e(/*! import() */ \"src_modules_js-accordion_js\").then(__webpack_require__.bind(__webpack_require__, /*! ../modules/js-accordion.js */ \"./src/modules/js-accordion.js\"));\n      this.plugins.JsAccordion = JsAccordion;\n    }\n    const jsDetail = this.plugins.JsDetail({\n      waitdiv: this.waitdiv\n    });\n\n    const detail = jsDetail.applyTo(about, wrapper); // specific to about details in table\n    // hide / show disable details zone\n    const callbackclose = (el, callback = null) => {\n      const current = jsDetail.activeDetail(false);\n      if (callback) callback();\n    }\n\n    const callbackopen = (el, callback = null) => {\n      let current = jsDetail.activeDetail(true);\n      if (current && current === el) {\n        current = jsDetail.expandDetail(el);\n        if (callback) callback();\n      } else {\n        if (current) current.querySelector('summary').click();\n        const url = this.params.detailsurl + el.dataset.id + '?' +\n          new URLSearchParams({\n            partial: true\n          });\n        current = jsDetail.activeDetail(true);\n        // append to cell details and display\n        fetch(url, (0,_modules_utils_js__WEBPACK_IMPORTED_MODULE_2__.fetchSettings)()).then(response => response.text()).then(html => {\n          current = jsDetail.expandDetail(el, html);\n          if (callback) callback();\n        }).catch(err => {\n          console.log('request', err);\n        })\n      }\n\n    }\n\n    const refresh_details = () => {\n      const details = this.dom.querySelectorAll(tableselectors.details);\n      if (!details) return;\n      /*details.forEach(item => {\n        if (!item.dataset.id) return;\n        item =new this.plugins.JsAccordion(item, callbackopen, callbackclose, detail);\n      });*/\n      this.plugins.JsAccordion.applyTo(details, callbackopen, callbackclose, detail);\n    }\n    refresh_details();\n  }\n\n  initAlternateSort(cols) {\n\n    let tdcols = [];\n    cols.forEach(col => {\n      const tdcol = col.closest('th');\n      Object.entries(col.dataset).forEach(([k, v]) => {\n        tdcol.dataset[k] = v;\n        col.classList.add('inline-block')\n      });\n      tdcols.push(tdcol);\n    });\n    cols = tdcols;\n    // end fix\n\n    let coltosort;\n    const sortalternate = (col) => {\n      let todir;\n      // keep the same dir if sort on col changes\n      const asc = col.classList.contains(tablecss.ascending);\n      const desc = col.classList.contains(tablecss.descending);\n      if (parseInt(col.dataset.sortactive) === parseInt(coltosort)) {\n        todir = (asc) ? 'desc' : ((desc) ? 'asc' : 'asc');\n      } else todir = (asc) ? 'asc' : (desc) ? 'desc' : 'asc';\n      this.sortColumn(col, coltosort, todir);\n    }\n    cols.forEach(col => {\n      const altsort = (col.dataset.altsort) ? col.dataset.altsort.split(',') : null;\n      if (!altsort) return;\n      const csssorter = col.querySelector(tableselectors.sorter);\n      if (csssorter) csssorter.classList.add(tablecss.disabled);\n      const control = col.querySelector(tableselectors.sorton);\n      // prevents imbricated links\n      col.append(control);\n      const triggers = col.querySelectorAll('[role=\"button\"]');\n\n      col.addEventListener('click', (e) => {\n        e.preventDefault();\n        sortalternate(col);\n      }, false);\n      const changecoltosort = (cl, index) => {\n        if (index === 0) coltosort = this.grid.columns.findIndex(column => (column.index === cl.cellIndex));\n        else coltosort = this.grid.columns.findIndex(column => (column.name === altsort[index - 1]));\n      }\n      col.dataset.sortactive = col.cellIndex;\n      triggers.forEach((trigger, index) => {\n        trigger.addEventListener('click', (e) => {\n          e.preventDefault();\n          const active = e.currentTarget.parentElement.querySelector('.' + _modules_modules_config_js__WEBPACK_IMPORTED_MODULE_5__.css.active);\n          if (active) active.classList.remove(_modules_modules_config_js__WEBPACK_IMPORTED_MODULE_5__.css.active);\n          e.currentTarget.classList.add(_modules_modules_config_js__WEBPACK_IMPORTED_MODULE_5__.css.active);\n          changecoltosort(col, index);\n        });\n      });\n      if (col.dataset.tip) {\n\n        Object.values(this.dom.rows).forEach((row, index) => {\n          if (index === 0) return;\n          const coltip = this.grid.columns.findIndex(column => (column.name === altsort[parseInt(col.dataset.tip) - 1]));\n\n          if (row.cells.length === 0 || coltip === col.cellIndex) return;\n          row.cells[col.cellIndex].addEventListener('mouseenter', (e) => {\n\n            const tip = document.createElement('div');\n            tip.setAttribute('class', tablecss.tipover);\n            tip.innerHTML = row.cells[coltip].innerHTML;\n            e.currentTarget.append(tip);\n          });\n          row.cells[col.cellIndex].addEventListener('mouseout', (e) => {\n            const tip = e.currentTarget.querySelector(tableselectors.tipover);\n            if (tip) tip.remove();\n          });\n        });\n      }\n    });\n  }\n\n  makeExpandable(container) {\n    if (container.querySelector('table').offsetHeight < container.offsetHeight) return;\n    const btn = document.createElement('div');\n    btn.classList.add(tablecss.buttonexpand);\n    btn.classList.add(tablecss.bordert);\n    btn.title = this.params.expand;\n    btn.innerHTML = `<span class=\"small-caps block mx-auto p-0\">${this.params.expand}</span><i class=\"clear-both p-0 mx-auto icon icon-chevron-down hover:fill-secondblue-500\"></i><span class=\"small-caps block mx-auto p-0 hidden\">${\n                  this.params.shrink}</span>`;\n    container.parentElement.insertBefore(btn, container.nextElementSibling);\n    container.classList.add(tablecss.overflowyhidden);\n    container.classList.remove(tablecss.maxtabstath);\n    container.parentElement.style.height = 'auto';\n    const h = parseInt(this.wrapper.querySelector('tbody tr').offsetHeight) * ((this.params.maxrows) ? this.params.maxrows : 20);\n    container.classList.add('max-h-[' + h + 'px]');\n    container.style.height = h + 'px';\n    btn.addEventListener('click', (e) => {\n      const ishidden = container.classList.contains(tablecss.overflowyhidden);\n      const make_expand = debounce__WEBPACK_IMPORTED_MODULE_6___default()(() => {\n        btn.classList.toggle(tablecss.bordert);\n        btn.classList.toggle(tablecss.borderb);\n        const ico = btn.querySelector('i');\n        ico.classList.toggle(tablecss.icochevrondown);\n        ico.classList.toggle(tablecss.iconchevronup);\n        container.classList.toggle(tablecss.overflowyhidden);\n        container.classList.toggle('max-h-[' + h + 'px]');\n        btn.querySelectorAll('span').forEach(span => {\n          span.classList.toggle(tablecss.hidden);\n        });\n        if (ishidden) container.style.height = h + 'px';\n        else container.style.height = 'auto';\n      }, 100);\n      make_expand();\n    });\n  }\n  makeExportable(container) {\n    const btn = document.createElement('div');\n    btn.classList.add(tableselectors.export.slice(1));\n    btn.classList.add('is-pick');\n    btn.innerHTML = `<i class=\"icon icon-arrow-down-on-square\"></i><span>${((this.params.exportlabel) ? this.params.exportlabel : 'export statistics ')}</span>`;\n    this.wrapper.prepend(btn);\n    const columns = this.grid.columns;\n    let exclude_columns = [];\n    this.grid.columns.forEach((column, index) => {\n      if (column.name === 'select') exclude_columns.push(column.index);\n    });\n    btn.addEventListener('click', async (e) => {\n      e.preventDefault();\n      if (!this.plugins.exportCSV) {\n        const {\n          exportCSV // or exportJSON, exportSQL\n        } = await\n        __webpack_require__.e(/*! import() */ \"src_modules_export-csv_js\").then(__webpack_require__.bind(__webpack_require__, /*! ../modules/export-csv.js */ \"./src/modules/export-csv.js\"));\n\n        this.plugins.exportCSV = exportCSV;\n      }\n      let str = this.plugins.exportCSV(this, {\n        download: false,\n        linedelimiter: \"\\n\",\n        columndelimiter: \"\\t\",\n        skipcolumns: exclude_columns\n      });\n      str = encodeURI(`data:text/tsv;charset=utf-8,${str}`);\n\n      (0,_modules_utils_js__WEBPACK_IMPORTED_MODULE_2__.download_url)(str, ((container.id) ? container.id : 'stats_proj') + '.tsv');\n\n    });\n  }\n  initTips() {\n    // show big cell content\n    let current = null;\n    this.dom.querySelectorAll(tableselectors.tip).forEach(tip => {\n      tip.addEventListener('click', (e) => {\n        e.preventDefault();\n        e.stopImmediatePropagation();\n        const parent = e.target.parentElement;\n        if (current !== null) current.classList.remove(tablecss.showfull);\n        if (current !== parent) {\n          parent.classList.add(tablecss.showfull);\n          current = parent;\n        } else current = null;\n\n      });\n    });\n  }\n  toggleAddOns(list = null, on = false) {\n    list = (list) ? list : [tableselectors.search + ' input', tableselectors.export];\n    const addons = [];\n    let addon;\n    list.forEach(addon => {\n      addon = this.wrapper.querySelector(addon);\n      if (addon) {\n        if (on) addon.classList.remove(_modules_modules_config_js__WEBPACK_IMPORTED_MODULE_5__.css.hide);\n        else addon.classList.add(_modules_modules_config_js__WEBPACK_IMPORTED_MODULE_5__.css.hide);\n      }\n    });\n  }\n\n}\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxxQ0FBcUMsZ0JBQWdCLElBQUk7O0FBRXpELE1BQU0sK0RBQVk7O0FBRWxCLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7O0FBRVYsT0FBTztBQUNQLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUNBQXVDLDJEQUFHO0FBQzFDLGlDQUFpQywyREFBRztBQUNwQztBQUNBLEtBQUs7QUFDTDs7QUFFQSxDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vc3JjL21vZHVsZXMvdGFibGUtY29tcG9uZW50LmpzPzVlZTEiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IERPTVB1cmlmeSBmcm9tICdkb21wdXJpZnknO1xuaW1wb3J0IGVxdWFsIGZyb20gJ2RlZXAtZXF1YWwnO1xuaW1wb3J0IHtcbiAgZmV0Y2hTZXR0aW5ncyxcbiAgZG93bmxvYWRfdXJsLFxuICBzdHJpbmdfdG9fYm9vbGVhbixcbiAgc29ydF9pdGVtcyxcbiAgaXNfb2JqZWN0LFxuICBodG1sX3NwaW5uZXIsXG4gIGdlbmVyYXRlX3V1aWRcbn0gZnJvbSAnLi4vbW9kdWxlcy91dGlscy5qcyc7XG5pbXBvcnQge1xuICBNb2R1bGVFdmVudEVtaXR0ZXJcbn0gZnJvbSAnLi4vbW9kdWxlcy9tb2R1bGUtZXZlbnQtZW1pdHRlci5qcyc7XG5pbXBvcnQge1xuICBUZXh0SGlnaGxpZ2h0XG59IGZyb20gJy4uL21vZHVsZXMvdGV4dC1oaWdobGlnaHQuanMnO1xuaW1wb3J0IGRlYm91bmNlIGZyb20gJ2RlYm91bmNlJztcbmltcG9ydCB7XG4gIGNzcyxcbiAgbW9kZWxzLFxuICBkZWZhdWx0X21lc3NhZ2VzLFxuICB0eXBlaW1wb3J0LFxufSBmcm9tICcuLi9tb2R1bGVzL21vZHVsZXMtY29uZmlnLmpzJztcbmxldCBpbnN0YW5jZSA9IFtdO1xuLy8gdmFsaWQgZmV0Y2ggdXJscGFydHNcbmNvbnN0IGZldGNoZnJvbXMgPSB7XG4gIGNvbGxlY3Rpb25saXN0OiAnL2d1aS9jb2xsZWN0aW9ubGlzdC8nLFxuICBwcmpsaXN0OiAnL2d1aS9wcmpsaXN0LycsXG4gIHByanNhbXBsZXN0YXRzOiAnL2d1aS9wcmpzYW1wbGVzdGF0cycsXG4gIHVzZXJzbGlzdDogJy9ndWkvYWRtaW4vdXNlcnNsaXN0LycsXG4gIGd1ZXN0c2xpc3Q6Jy9ndWkvZ3Vlc3RzbGlzdC8nLFxuICBvcmdhbml6YXRpb25zbGlzdDonL2d1aS9vcmdhbml6YXRpb25zbGlzdC8nLFxuICBwcmpwcmVkaWN0OiAnL2d1aS9wcmpzZm9ycHJlZGljdGlvbi8nXG59O1xuLy8gc3BlY2lmYyBjc3NcbmNvbnN0IHRhYmxlY3NzID0ge1xuICBzaG93ZnVsbDogJ3Nob3dmdWxsJyxcbiAgdGlwaW5saW5lOiBcInRpcC1pbmxpbmVcIixcbiAgc2VhcmNocmVzdWx0czogXCJzZWFyY2gtcmVzdWx0c1wiLFxuICBzZWxlY3RhY3Rpb246IFwic2VsZWN0YWN0aW9uXCIsXG4gIGFic2lucHV0OiAnYWJzaW5wdXQnLFxuICBkaXNhYmxlZDogJ3RhYmxlLWRpc2FibGVkJyxcbiAgYXNjZW5kaW5nOiAndGFibGUtYXNjZW5kaW5nJyxcbiAgZGVzY2VuZGluZzogJ3RhYmxlLWRlc2NlbmRpbmcnLFxuICB0aXBvdmVyOiAndGlwb3ZlciBhYnNvbHV0ZSB6LTEwIHRleHQtc3RvbmUtNTAgcm91bmRlZC1zbSBiZy1zdG9uZS02MDAgcHgtMiBweS0wLjUgLW10LTUgbWwtMTIgJyxcbiAgaGlkZTogJ2hpZGUnLFxuICBub3dyYXA6ICd0cnVuY2F0ZScsXG4gIGJ1dHRvbmV4cGFuZDogJ2J1dHRvbi1leHBhbmQnLFxuICBib3JkZXJ0OiAnYm9yZGVyLXQnLFxuICBib3JkZXJiOiAnYm9yZGVyLWInLFxuICBtYXh0YWJzdGF0aDogJ21heC10YWJzdGF0LWgnLFxuICBvdmVyZmxvd3loaWRkZW46ICdvdmVyZmxvdy15LWhpZGRlbicsXG4gIGljb2NoZXZyb25kb3duOiAnaWNvbi1jaGV2cm9uLWRvd24nLFxuICBpY29uY2hldnJvbnVwOiAnaWNvbi1jaGV2cm9uLXVwJyxcbiAgcG9pbnRlcjogJ2N1cnNvci1wb2ludGVyJyxcbiAgaGlkZGVuOiAnaGlkZGVuJyxcbn07XG5jb25zdCB0YWJsZXNlbGVjdG9ycyA9IHtcbiAgdGFibGU6ICcudGFibGUtdGFibGUnLFxuICB3cmFwcGVyOiAnLnRhYmxlLXdyYXBwZXInLFxuICB0b3A6ICcudGFibGUtdG9wJyxcbiAgaW5wdXQ6ICcudGFibGUtaW5wdXQnLFxuICBzZWFyY2g6ICcudGFibGUtc2VhcmNoJyxcbiAgZXhwb3J0OiAnLmJ1dHRvbi1leHBvcnQnLFxuICBmaWx0ZXJzOiAnLnRhYmxlLWZpbHRlcnMnLFxuICBzb3J0ZXI6ICcudGFibGUtc29ydGVyJyxcbiAgZGV0YWlsczogJ2RldGFpbHNbZGF0YS13aGF0PVwiYWJvdXRcIl0nLFxuICB0aXA6ICcuJyArIGNzcy5jb21wb25lbnQudGFibGUudGlwLFxuICB0aXBvdmVyOiAnLnRpcG92ZXInLFxuICB3YWl0OiAnd2FpdC1wbGVhc2UnLFxuICBzb3J0b246ICcuc29ydG9uJyxcbn07XG5PYmplY3QuZnJlZXplKHRhYmxlY3NzKTtcbk9iamVjdC5mcmVlemUodGFibGVzZWxlY3RvcnMpO1xuY29uc3QgTk9URk9VTkQgPSAnI05PVEZPVU5EIyc7XG5leHBvcnQgY2xhc3MgVGFibGVDb21wb25lbnQge1xuICB1dWlkID0gbnVsbDtcbiAgZ3JpZCA9IHtcbiAgICBjb2x1bW5zOiBbXSxcbiAgICBhY3RpdmU6IFtdLFxuICAgIGhpZGRlbjogW10sXG4gICAgZGF0YTogW11cbiAgfTtcbiAgZG9tZGVmID0ge1xuICAgIGNvbHVtbnM6IFtdLFxuICAgIGRhdGE6IFtdLFxuICB9O1xuICB3cmFwcGVyID0gbnVsbDtcbiAgZG9tID0gbnVsbDtcbiAgcGFyYW1zID0gbnVsbDtcbiAgX2V2ZW50cyA9IHt9O1xuICBldmVudG5hbWVzID0ge1xuICAgIGluaXQ6IFwidGFibGUuaW5pdFwiLFxuICAgIHVwZGF0ZTogXCJ0YWJsZS51cGRhdGVcIixcbiAgICByZWZyZXNoOiBcInRhYmxlLnJlZnJlc2hcIixcbiAgICByZXNpemU6IFwidGFibGUucmVzaXplXCIsXG4gICAgc2VhcmNoOiBcInRhYmxlLnNlYXJjaFwiLFxuICAgIHNlYXJjaGVuZDogXCJ0YWJsZS5zZWFyY2hlbmRcIixcbiAgICBzb3J0aW5nOiBcInRhYmxlLnNvcnRpbmdcIixcbiAgICBzb3J0ZWQ6IFwidGFibGUuc29ydGVkXCIsXG4gICAgbG9hZDogXCJ0YWJsZS5sb2FkZWRcIixcbiAgICBkaXNtaXNzOiAndGFibGUuZGlzbWlzcydcbiAgfVxuICBsYWJlbHMgPSB7XG4gICAgcGxhY2Vob2xkZXI6IFwiU2VhcmNoLi4uXCIsXG4gICAgcGVyUGFnZTogXCJ7c2VsZWN0fSBlbnRyaWVzIHBlciBwYWdlXCIsXG4gICAgbm9Sb3dzOiBcIk5vIGVudHJpZXMgZm91bmRcIixcbiAgICBpbmZvOiBcIlNob3dpbmcge3N0YXJ0fSB0byB7ZW5kfSBvZiB7cm93c30gZW50cmllc1wiLFxuICAgIG5vUmVzdWx0czogXCJObyByZXN1bHQgbWF0Y2ggeW91ciBzZWFyY2ggcXVlcnlcIlxuICB9O1xuICBjZWxsaWRuYW1lID0gXCJpZFwiO1xuICBzZWFyY2hpbmcgPSBmYWxzZTtcbiAgc29ydGluZyA9IGZhbHNlO1xuICBpbml0aWFsaXplZCA9IGZhbHNlO1xuICBwbHVnaW5zID0ge307XG4gIGNvbnN0cnVjdG9yKGNvbnRhaW5lciwgb3B0aW9ucyA9IHt9KSB7XG4gICAgaWYgKCFjb250YWluZXIpIHJldHVybjtcbiAgICBjb250YWluZXIgPSBjb250YWluZXIgaW5zdGFuY2VvZiBIVE1MRWxlbWVudCA/IGNvbnRhaW5lciA6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29udGFpbmVyKTtcbiAgICBpZiAoIWNvbnRhaW5lcikgcmV0dXJuO1xuICAgIC8vY2FuIHNlbGVjdCBtdWx0aXBsZXMgdGFibGVzIGluIG9uZSBwYWdlICBvciBsb2FkIGRhdGEgaW4gdGhlIHNhbWUgdGFibGVcbiAgICB0aGlzLnV1aWQgPSAoY29udGFpbmVyLmRhdGFzZXQudXVpZCkgPyBjb250YWluZXIuZGF0YXNldC51dWlkIDogZ2VuZXJhdGVfdXVpZCgpO1xuICAgIGlmICghaW5zdGFuY2VbdGhpcy51dWlkXSB8fCAhZXF1YWwoY29udGFpbmVyLmRhdGFzZXQsIGluc3RhbmNlW3RoaXMudXVpZF0ucGFyYW1zKSkge1xuICAgICAgdGhpcy5pbml0KGNvbnRhaW5lcik7XG4gICAgfSBlbHNlIHRoaXMucmVmcmVzaCgpO1xuICAgIHJldHVybiBpbnN0YW5jZVt0aGlzLnV1aWRdO1xuXG4gIH1cbiAgaW5pdChjb250YWluZXIpIHtcbiAgICB0aGlzLnBhcmFtcyA9IGNvbnRhaW5lci5kYXRhc2V0O1xuICAgIGxldCB0YWJsZSA9IGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCd0YWJsZScpO1xuICAgIGlmICghdGFibGUpIHtcbiAgICAgIHRhYmxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndGFibGUnKTtcbiAgICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZCh0YWJsZSk7XG4gICAgfVxuICAgIHRhYmxlLmlkID0gJ3RhYmxlLScgKyBjb250YWluZXIuaWQ7XG4gICAgdGFibGUuY2xhc3NMaXN0LmFkZCh0YWJsZXNlbGVjdG9ycy50YWJsZS5zdWJzdHIoMSkpXG4gICAgdGhpcy5kb20gPSB0YWJsZTtcbiAgICBsZXQgdG9wID0ge1xuICAgICAgbm9kZW5hbWU6IFwiRElWXCIsXG4gICAgICBhdHRyaWJ1dGVzOiB7XG4gICAgICAgIGNsYXNzOiB0YWJsZXNlbGVjdG9ycy50b3Auc3Vic3RyKDEpXG4gICAgICB9XG4gICAgfTtcblxuICAgIGxldCB3cmFwcGVyID0gdGhpcy5vYmpUb0VsZW1lbnQoe1xuICAgICAgbm9kZW5hbWU6ICdESVYnLFxuICAgICAgYXR0cmlidXRlczoge1xuICAgICAgICBjbGFzczogdGFibGVzZWxlY3RvcnMud3JhcHBlci5zdWJzdHIoMSlcbiAgICAgIH0sXG4gICAgICBjaGlsZG5vZGVzOiBbdG9wXVxuICAgIH0pO1xuICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZCh3cmFwcGVyKTtcbiAgICB3cmFwcGVyLmFwcGVuZENoaWxkKHRhYmxlKTtcbiAgICB0aGlzLndyYXBwZXIgPSB3cmFwcGVyO1xuICAgIHRoaXMubGFiZWxzID0gKHRoaXMucGFyYW1zLmxhYmVscykgPyB0aGlzLnBhcmFtcy5sYWJlbHMgOiB0aGlzLmxhYmVscztcbiAgICAvLyBjZWxsaWRcbiAgICB0aGlzLmNlbGxpZG5hbWUgPSAodGhpcy5wYXJhbXMuaGFzT3duUHJvcGVydHkoXCJjZWxsaWRcIikpID8gdGhpcy5wYXJhbXMuY2VsbGlkIDogdGhpcy5jZWxsaWRuYW1lO1xuICAgIC8vIG9ubHkgdmFsaWQgZnJvbSB2YWx1ZXMgLSBmZXRjaGZyb21zXG4gICAgdGhpcy5wYXJhbXMuZnJvbSA9ICh0aGlzLnBhcmFtcy5mcm9tKSA/IERPTVB1cmlmeS5zYW5pdGl6ZSh0aGlzLnBhcmFtcy5mcm9tKSA6IG51bGw7XG4gICAgY29uc3QgZnJvbSA9ICh0aGlzLnBhcmFtcy5mcm9tKSA/ICgoT2JqZWN0LmtleXMoZmV0Y2hmcm9tcykuaW5kZXhPZih0aGlzLnBhcmFtcy5mcm9tKSA+PSAwKSA/IGZldGNoZnJvbXNbdGhpcy5wYXJhbXMuZnJvbV0gOiBudWxsKSA6IG51bGw7XG4gICAgdGhpcy5kb20uY2xhc3NMaXN0LmFkZChjc3MuaGlkZSk7XG4gICAgaWYgKGZyb20pIHtcbiAgICAgIGlmICh0aGlzLnBhcmFtcy5kZWZlcikgdGhpcy5kZWZlckxvYWQoY29udGFpbmVyLCBmcm9tKTtcbiAgICAgIGVsc2UgdGhpcy5mZXRjaERhdGEoY29udGFpbmVyLCBmcm9tKTtcbiAgICB9IGVsc2UgdGhpcy50YWJsZUFjdGl2YXRlKGNvbnRhaW5lcik7XG5cbiAgICB0aGlzLmR0ID0gRGF0ZS5ub3coKTtcbiAgfVxuXG4gIHdhaXRBY3RpdmF0ZShjb250YWluZXIpIHtcbiAgICBsZXQgd2FpdGRpdiA9IGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCcjJyArIHRhYmxlc2VsZWN0b3JzLndhaXQpO1xuICAgIGlmICghd2FpdGRpdikge1xuICAgICAgd2FpdGRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgd2FpdGRpdi5pZCA9IHRhYmxlc2VsZWN0b3JzLndhaXQ7XG4gICAgICBjb250YWluZXIuYXBwZW5kKHdhaXRkaXYpO1xuICAgIH1cbiAgICB0aGlzLndhaXRkaXYgPSB3YWl0ZGl2O1xuICB9XG5cbiAgd2FpdERlYWN0aXZhdGUobWVzc2FnZSA9IG51bGwsIHR5cGUgPSAnaW5mbycpIHtcbiAgICBpZiAoIXRoaXMud2FpdGRpdikgcmV0dXJuO1xuICAgIGlmIChtZXNzYWdlKSB7XG4gICAgICB0aGlzLndhaXRkaXYuY2xhc3NMaXN0LnJlbW92ZShjc3MuaGlkZSk7XG4gICAgICBpZiAodHlwZSA9PT0gbnVsbCkgdGhpcy53YWl0ZGl2LmlubmVySFRNTCA9IGAke21lc3NhZ2V9YDtcbiAgICAgIHRoaXMud2FpdGRpdi5pbm5lckhUTUwgPSBgPGRpdiBjbGFzcz1cImFsZXJ0IGlzLSR7dHlwZX1cIj4ke21lc3NhZ2V9PC9kaXY+YDtcbiAgICB9IGVsc2UgdGhpcy53YWl0ZGl2LmNsYXNzTGlzdC5hZGQoY3NzLmhpZGUpO1xuICB9XG5cbiAgZGVmZXJMb2FkKGNvbnRhaW5lciwgZnJvbSkge1xuICAgIGNvbnN0IGJ0biA9IGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKHRoaXMucGFyYW1zLmRlZmVyKTtcbiAgICBpZiAoIWJ0bikgcmV0dXJuO1xuXG4gICAgYnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtcbiAgICAgIHRoaXMuZmV0Y2hEYXRhKGNvbnRhaW5lciwgZnJvbSk7XG4gICAgICBidG4ucmVtb3ZlKCk7XG4gICAgfSk7XG4gIH1cblxuICBmZXRjaERhdGEoY29udGFpbmVyLCBmcm9tdXJsLCBwYWdlc3RhcnQgPSAwKSB7XG4gICAgdGhpcy53YWl0QWN0aXZhdGUoY29udGFpbmVyKTtcbiAgICBjb25zdCBwYWdlc2l6ZSA9ICh0aGlzLnBhcmFtcy5wYWdlc2l6ZSkgPyB0aGlzLnBhcmFtcy5wYWdlc2l6ZSA6IDA7XG4gICAgbGV0IGZyb20gPSBmcm9tdXJsO1xuICAgIGlmICh0aGlzLnBhcmFtcy5mcm9taWQpIGZyb20gKz0gJy8nICsgdGhpcy5wYXJhbXMuZnJvbWlkO1xuICAgIGxldCBxdWVyeSA9ICh0aGlzLnBhcmFtcy5pbXBvcnQpID8ge1xuICAgICAgdHlwZWltcG9ydDogRE9NUHVyaWZ5LnNhbml0aXplKHRoaXMucGFyYW1zLmltcG9ydCksXG4gICAgICBnejogdHJ1ZSxcbiAgICB9IDoge307XG4gICAgaWYgKHBhZ2VzaXplKSB7XG4gICAgICBxdWVyeS53aW5kb3dfc3RhcnQgPSBwYWdlc3RhcnQ7XG4gICAgICBxdWVyeS53aW5kb3dfc2l6ZSA9IHBhZ2VzaXplO1xuICAgIH1cbiAgICBpZiAodGhpcy5wYXJhbXMubGlzdGFsbCkgcXVlcnkubGlzdGFsbCA9IHRoaXMucGFyYW1zLmxpc3RhbGw7XG4gICAgY29uc3QgcXVlcnlwYXJhbXMgPSBuZXcgVVJMU2VhcmNoUGFyYW1zKHdpbmRvdy5sb2NhdGlvbi5zZWFyY2gpO1xuICAgIGNvbnN0IHF1ZXJ5a2V5cyA9IHRoaXMuY2VsbGlkbmFtZSArICdzJztcbiAgICBpZiAocXVlcnlrZXlzLmxlbmd0aCkge1xuICAgICAgZm9yIChjb25zdCBlbnRyeSBvZiBxdWVyeXBhcmFtcy5lbnRyaWVzKCkpIHtcbiAgICAgICAgaWYgKHF1ZXJ5a2V5cy5pbmRleE9mKGVudHJ5WzBdKSA+PSAwKSBxdWVyeVtlbnRyeVswXV0gPSBlbnRyeVsxXTtcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKE9iamVjdC5rZXlzKHF1ZXJ5KS5sZW5ndGgpIGZyb20gKz0gJz8nICsgbmV3IFVSTFNlYXJjaFBhcmFtcyhxdWVyeSk7XG4gICAgdGhpcy5kdCA9IERhdGUubm93KCk7XG4gICAgZmV0Y2goZnJvbSwgZmV0Y2hTZXR0aW5ncygpKS50aGVuKHJlc3BvbnNlID0+IHtcbiAgICAgIGlmIChyZXNwb25zZS5vaykgcmV0dXJuIHJlc3BvbnNlLmpzb24oKTtcbiAgICAgIGVsc2UgcmV0dXJuIFByb21pc2UucmVqZWN0KHJlc3BvbnNlKTtcbiAgICB9KS50aGVuKGFzeW5jIHRhYmxlZGVmID0+IHtcbiAgICAgIGlmICh0aGlzLndhaXRkaXYpIHRoaXMud2FpdGRpdi5pbm5lckhUTUwgPSAoKHRoaXMud2FpdGRpdi5kYXRhc2V0LmxvYWRlZCkgPyBET01QdXJpZnkuc2FuaXRpemUodGhpcy53YWl0ZGl2LmRhdGFzZXQubG9hZGVkKSA6IGRlZmF1bHRfbWVzc2FnZXMuZGF0YWxvYWRlZCk7XG4gICAgICBpZiAocGFnZXN0YXJ0ID4gMCkge1xuICAgICAgICBpZiAodGFibGVkZWYuZGF0YS5sZW5ndGgpIHtcbiAgICAgICAgICB0aGlzLmRvbUluc2VydFJvd3ModGFibGVkZWYpO1xuICAgICAgICB9IGVsc2UgcGFnZXNpemUgPSAwO1xuICAgICAgfVxuICAgICAgaWYgKHBhZ2VzaXplID09PSAwKSB7XG4gICAgICAgIGxldCBub3cgPSBEYXRlLm5vdygpO1xuICAgICAgICBjb25zb2xlLmxvZygnc2Vjb25kcyB0byBmZXRjaCAnLCAoRGF0ZS5ub3coKSAtIHRoaXMuZHQpIC8gMTAwMCk7XG4gICAgICAgIHRoaXMuZHQgPSBub3c7XG4gICAgICAgIGlmICh0YWJsZWRlZi5kYXRhLmxlbmd0aCB8fCBwYWdlc3RhcnQgPiAwKSBhd2FpdCB0aGlzLnRhYmxlQWN0aXZhdGUoY29udGFpbmVyLCB0YWJsZWRlZik7XG4gICAgICAgIGVsc2UgdGhpcy53YWl0RGVhY3RpdmF0ZSgnbm8gcmVzdWx0JywgJ2RlZmF1bHQnKTtcbiAgICAgICAgbm93ID0gRGF0ZS5ub3coKTtcbiAgICAgICAgY29uc29sZS5sb2coJ3BsdWdpbnMgbG9hZGVkJywgKERhdGUubm93KCkgLSB0aGlzLmR0KSAvIDEwMDApO1xuICAgICAgICB0aGlzLmR0ID0gbm93O1xuICAgICAgfSBlbHNlIHRoaXMuZmV0Y2hEYXRhKGNvbnRhaW5lciwgZnJvbXVybCwgcGFnZXN0YXJ0ICsgcGFnZXNpemUpO1xuXG4gICAgfSkuY2F0Y2goKGVycikgPT4geyAvKiBwcmludCBlcnJvciBmcm9tIHJlc3BvbnNlICovXG4gICAgICBjb25zb2xlLmxvZygnZXJyb3InLCBlcnIpO1xuICAgICAgdGhpcy53YWl0RGVhY3RpdmF0ZShlcnIuc3RhdHVzICsgYCBgICsgZXJyLnN0YXR1c1RleHQsICdlcnJvcicpO1xuICAgIH0pO1xuICB9XG5cbiAgYXN5bmMgZGF0YVRvVGFibGUodGFibGVkZWYpIHtcbiAgICBpZiAoIXRhYmxlZGVmLmRhdGEpIHJldHVybjtcbiAgICBpZiAodGFibGVkZWYuY29sdW1ucykge1xuICAgICAgYXdhaXQgdGhpcy5jb252ZXJ0Q29sdW1ucyh0YWJsZWRlZik7XG4gICAgICBsZXQgdHI7XG4gICAgICBsZXQgdGhlYWQgPSB0aGlzLmRvbS50SGVhZDtcbiAgICAgIGlmICghdGhlYWQpIHtcbiAgICAgICAgLy8gY3JlYXRlIHRhYmxlIGhlYWRpbmdzXG4gICAgICAgIHRoZWFkID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndGhlYWQnKTtcbiAgICAgICAgdHIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0cicpO1xuICAgICAgICB0aGlzLmRvbS5hcHBlbmRDaGlsZCh0aGVhZCk7XG4gICAgICB9IGVsc2UgaWYgKCF0aGVhZC5xdWVyeVNlbGVjdG9yKCd0cicpKSB7XG4gICAgICAgIHRyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndHInKTtcblxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdHIgPSB0aGVhZC5xdWVyeVNlbGVjdG9yKCd0cicpO1xuICAgICAgICB0ci5pbm5lckhUTUwgPSBgYDtcbiAgICAgIH1cbiAgICAgIGxldCB0Ym9keSA9ICh0aGlzLmRvbS50Qm9kaWVzLmxlbmd0aCkgPyB0aGlzLmRvbS50Qm9kaWVzWzBdIDogbnVsbDtcbiAgICAgIGlmICghdGJvZHkpIHtcbiAgICAgICAgdGJvZHkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0Ym9keScpO1xuICAgICAgICB0aGlzLmRvbS5hcHBlbmRDaGlsZCh0Ym9keSk7XG4gICAgICB9XG4gICAgICBjb25zdCBpc2pzb24gPSAoIXRhYmxlZGVmLmhhc093blByb3BlcnR5KCdkYXRhJykgfHwgKHRhYmxlZGVmLmhhc093blByb3BlcnR5KCd0eXBlJykgJiYgdGFibGVkZWYudHlwZSA9PT0gXCJqc29uXCIpKTtcblxuICAgICAgdGhpcy5ncmlkLmNvbHVtbnMuZm9yRWFjaCgoY29sdW1uLCBpbmRleCkgPT4ge1xuXG4gICAgICAgIGlmICghY29sdW1uLmhpZGRlbikge1xuICAgICAgICAgIGNvbnN0IHRoID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndGgnKTtcbiAgICAgICAgICB0aC5pbm5lckhUTUwgPSBET01QdXJpZnkuc2FuaXRpemUoY29sdW1uLmxhYmVsKTtcbiAgICAgICAgICBpZiAoY29sdW1uLnNvcnQpIHRoLmRhdGFzZXQuc29ydCA9IGNvbHVtbi5zb3J0O1xuICAgICAgICAgIGlmIChjb2x1bW4uZm9ybWF0KSB0aC5kYXRhc2V0LnR5cGUgPSBjb2x1bW4udHlwZTtcbiAgICAgICAgICBpZiAoY29sdW1uLm5hbWUpIHRoLmRhdGFzZXQubmFtZSA9IGNvbHVtbi5uYW1lO1xuICAgICAgICAgIC8vIFRPRE8gLSBmaW5kIGEgcGxhY2UgdG8gZGVmaW5lIGNvbCBpbXBvcnQgcHJvcHNcbiAgICAgICAgICAvLyBzZXQgaGVhZGluZ3MgZGF0YXNldCB2YWx1ZXMgZm9yIGltcG9ydCBtb2R1bGVcbiAgICAgICAgICBpZiAodGhpcy5wYXJhbXMuaW1wb3J0KVsnc2VsZWN0Y2VsbHMnLCAnd2hhdCcsICdhdXRvY29tcGxldGUnLCAncGFydHMnLCAndmFsdWUnXS5mb3JFYWNoKHByb3AgPT4ge1xuICAgICAgICAgICAgaWYgKGNvbHVtbi5oYXNPd25Qcm9wZXJ0eShwcm9wKSkgdGguZGF0YXNldFtwcm9wXSA9IGNvbHVtbltwcm9wXTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgICB0aC5kYXRhc2V0LnNvcnRhYmxlID0gKGNvbHVtbi5zb3J0YWJsZSkgPyB0cnVlIDogZmFsc2U7XG4gICAgICAgICAgdHIuYXBwZW5kQ2hpbGQodGgpO1xuICAgICAgICAgIHRoaXMuZ3JpZC5hY3RpdmUucHVzaChpbmRleCk7XG4gICAgICAgIH0gZWxzZSB0aGlzLmdyaWQuaGlkZGVuLnB1c2goaW5kZXgpO1xuXG4gICAgICB9KTtcblxuXG4gICAgICB0aGVhZC5hcHBlbmRDaGlsZCh0cik7XG4gICAgICBjb25zdCBkYXRhbGFzdHVzZWQgPSAodGhpcy5wYXJhbXMubGFzdHVzZWQgJiYgdGhpcy5wYXJhbXMubGFzdHVzZWQubGVuZ3RoID4gMCkgPyBbXSA6IG51bGw7XG4gICAgICAvLyNUT0RPIGxhc3R1c2VkIHJlb3JkZXJcbiAgICAgIGlmIChpc2pzb24pIHtcbiAgICAgICAgdGhpcy5ncmlkLmRhdGEgPSBbXTtcbiAgICAgICAgdGFibGVkZWYuZGF0YS5mb3JFYWNoKChkYXRhLCBpKSA9PiB7XG4gICAgICAgICAgY29uc3Qgcm93ID0gW107XG4gICAgICAgICAgbGV0IGogPSAwO1xuICAgICAgICAgIE9iamVjdC5lbnRyaWVzKHRhYmxlZGVmLmNvbHVtbnMpLmZvckVhY2goKFtrZXksIGNvbHVtbl0sIGkpID0+IHtcbiAgICAgICAgICAgIGlmICghY29sdW1uLmhhc093blByb3BlcnR5KCdlbXB0eWRhdGEnKSkge1xuICAgICAgICAgICAgICBpZiAoZGF0YS5oYXNPd25Qcm9wZXJ0eShrZXkpKSByb3dbal0gPSBkYXRhW2tleV07XG4gICAgICAgICAgICAgIGVsc2UgaWYgKGNvbHVtbi5maWVsZCAmJiBkYXRhLmhhc093blByb3BlcnR5KGNvbHVtbi5maWVsZCkpIHJvd1tqXSA9IGRhdGFbY29sdW1uLmZpZWxkXTtcbiAgICAgICAgICAgICAgZWxzZSByb3dbal0gPSBudWxsO1xuICAgICAgICAgICAgICBqKys7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgdGhpcy5ncmlkLmRhdGEucHVzaChyb3cpO1xuICAgICAgICB9KTtcbiAgICAgIH0gZWxzZSB0aGlzLmdyaWQuZGF0YSA9IHRhYmxlZGVmLmRhdGE7XG5cbiAgICAgIGNvbnN0IHRmb290ID0gdGhpcy5kb20udEZvb3Q7XG4gICAgICBpZiAodGhpcy5ncmlkLmFjdGl2ZS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgdGJvZHkuaW5uZXJIVE1MID0gYDx0cj48dGQ+JHt0aGlzLmxhYmVscy5ub1Jvd3N9PC90ZDwvdHI+YDtcbiAgICAgICAgaWYgKHRmb290KSB0Zm9vdC5yZW1vdmUoKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfSBlbHNlIGlmICh0Zm9vdCAmJiB0Zm9vdC5xdWVyeVNlbGVjdG9yKCd0cicpKSB7XG4gICAgICAgIGNvbnN0IHRmID0gdGZvb3QucXVlcnlTZWxlY3RvcigndHInKS5jaGlsZE5vZGVzO1xuICAgICAgICB0aGlzLmdyaWQuaGlkZGVuLmZvckVhY2goaSA9PiB7XG4gICAgICAgICAgdGZbaV0ucmVtb3ZlKCk7XG4gICAgICAgIH0pO1xuICAgICAgfTtcblxuICAgICAgdGhpcy5yZW5kZXJUYm9keSh0Ym9keSk7XG4gICAgfVxuICB9XG5cbiAgdGFibGVUb0RhdGEoKSB7XG4gICAgaWYgKCF0aGlzLmRvbS5xdWVyeVNlbGVjdG9yKCd0aGVhZCcpKSB7dGhpcy5kb20uY2xhc3NMaXN0LnJlbW92ZShjc3MuaGlkZSk7cmV0dXJuO31cbiAgICBjb25zdCBkYXRhbGFzdHVzZWQgPSAodGhpcy5wYXJhbXMubGFzdHVzZWQgJiYgdGhpcy5wYXJhbXMubGFzdHVzZWQubGVuZ3RoID4gMCkgPyBbXSA6IG51bGw7XG4gICAgdGhpcy5kb20uY2xhc3NMaXN0LmFkZChjc3MuaGlkZSk7XG4gICAgY29uc3QgY2VsbF90b19vYmogPSAoY2VsbCkgPT4ge1xuICAgICAgY29uc3QgY2VsbHRleHQgPSBjZWxsLmlubmVyVGV4dDtcbiAgICAgIGNvbnN0IG9iaiA9IHtcbiAgICAgICAgZGF0YTogY2VsbHRleHQsXG4gICAgICB9XG4gICAgICBjb25zdCBjZWxsaHRtbCA9IGNlbGwuaW5uZXJIVE1MO1xuICAgICAgaWYgKGNlbGx0ZXh0ICE9PSBjZWxsaHRtbCkgb2JqLmh0bWwgPSBjZWxsaHRtbDtcbiAgICAgIHJldHVybiBvYmo7XG4gICAgfVxuICAgIGNvbnN0IHRocyA9ICh0aGlzLmRvbS5xdWVyeVNlbGVjdG9yQWxsKCd0aGVhZCB0ciB0aCcpLmxlbmd0aCkgPyB0aGlzLmRvbS5xdWVyeVNlbGVjdG9yQWxsKCd0aGVhZCB0ciB0aCcpIDogdGhpcy5kb20ucXVlcnlTZWxlY3RvckFsbCgndGhlYWQgdHIgdGQnKTtcbiAgICBjb25zdCB0cnMgPSB0aGlzLmRvbS5xdWVyeVNlbGVjdG9yQWxsKCd0Ym9keSB0cicpO1xuICAgIGxldCBhY3RpdmUgPSAwLFxuICAgICAgaGlkZGVuID0gMDtcblxuICAgIGZ1bmN0aW9uIGZpbmRfbGFiZWwodGgpIHtcbiAgICAgIGlmICh0aC5jaGlsZE5vZGVzLmxlbmd0aCkgcmV0dXJuIGZpbmRfbGFiZWwodGguY2hpbGROb2Rlc1swXSk7XG4gICAgICBlbHNlIHJldHVybiB0aC5pbm5lclRleHQ7XG4gICAgfVxuICAgIHRocy5mb3JFYWNoKCh0aCwgaW5kZXgpID0+IHtcbiAgICAgIGNvbnN0IGNvbCA9IE9iamVjdC5hc3NpZ24oe30sIHRoLmRhdGFzZXQpO1xuICAgICAgaWYgKGNvbC5tYXNrKSB0aC5jbGFzc0xpc3QuYWRkKHRhYmxlY3NzLmhpZGRlbik7XG4gICAgICBpZiAoY29sLmhpZGRlbiAmJiBzdHJpbmdfdG9fYm9vbGVhbihjb2wuaGlkZGVuKSkge1xuICAgICAgICBjb2wuaGlkZGVuID0gdHJ1ZTtcbiAgICAgICAgdGgucmVtb3ZlKCk7XG4gICAgICB9XG4gICAgICBjb2wubGFiZWwgPSBmaW5kX2xhYmVsKHRoKTtcbiAgICAgIGlmIChjb2wudHlwZSkge1xuICAgICAgICBjb2wuZm9ybWF0ID0gY29sLnR5cGU7XG4gICAgICAgIGRlbGV0ZSBjb2wudHlwZTtcbiAgICAgIH1cbiAgICAgIGNvbC5pbmRleCA9IGluZGV4O1xuICAgICAgaWYgKGNvbC5oaWRkZW4pIHRoaXMuZ3JpZC5oaWRkZW4ucHVzaChpbmRleCk7XG4gICAgICBlbHNlIHRoaXMuZ3JpZC5hY3RpdmUucHVzaChpbmRleCk7XG4gICAgICB0aGlzLmdyaWQuY29sdW1ucy5wdXNoKGNvbCk7XG4gICAgfSk7XG4gICAgY29uc3QgY2VsbGlkID0gdGhpcy5nZXRDZWxsSWQodGhpcy5jZWxsaWRuYW1lKTtcbiAgICB0cnMuZm9yRWFjaCgodHIsIGkpID0+IHtcbiAgICAgIGlmIChjZWxsaWQgPCAwKSB0ci5kYXRhc2V0W3RoaXMuY2VsbGlkbmFtZV0gPSBpO1xuICAgICAgZWxzZSBpZiAoaSA9PT0gY2VsbGlkKSB0ci5kYXRhc2V0W3RoaXMuY2VsbGlkbmFtZV0gPSB0aGlzLmdldENlbGxEYXRhKGksIHRoaXMuY2VsbGlkbmFtZSwgY2VsbGlkKTtcbiAgICAgIGNvbnN0IGRhdGEgPSBbXTtcbiAgICAgIHRyLnF1ZXJ5U2VsZWN0b3JBbGwoJ3RoLHRkJykuZm9yRWFjaCgodGQsIGluZGV4KSA9PiB7XG4gICAgICAgIGlmICh0aGlzLmdyaWQuY29sdW1uc1tpbmRleF0uaGFzT3duUHJvcGVydHkoJ21hc2snKSkgdGQuY2xhc3NMaXN0LmFkZCh0YWJsZWNzcy5oaWRkZW4pO1xuICAgICAgICBpZiAodGhpcy5ncmlkLmhpZGRlbi5pbmRleE9mKGluZGV4KSA+PSAwKSB0ZC5yZW1vdmUoKTtcbiAgICAgICAgZGF0YS5wdXNoKHRkLmlubmVyVGV4dCk7XG4gICAgICB9KTtcbiAgICAgIHRoaXMuZ3JpZC5kYXRhLnB1c2goZGF0YSlcbiAgICB9KTtcblxuICAgIHRoaXMuZG9tLnF1ZXJ5U2VsZWN0b3JBbGwoJ3Rmb290IHRyIHRoJykuZm9yRWFjaCgodGQsIGluZGV4KSA9PiB7XG4gICAgICBpZiAodGhpcy5ncmlkLmNvbHVtbnNbaW5kZXhdLmhhc093blByb3BlcnR5KCdtYXNrJykpIHRkLmNsYXNzTGlzdC5hZGQodGFibGVjc3MuaGlkZGVuKTtcbiAgICAgIGlmICh0aGlzLmdyaWQuaGlkZGVuLmluZGV4T2YoaW5kZXgpID49IDApIHRkLnJlbW92ZSgpO1xuICAgIH0pO1xuICAgIHRoaXMuZG9tLmNsYXNzTGlzdC5yZW1vdmUoY3NzLmhpZGUpO1xuICAgIHJldHVybjtcbiAgfVxuICByZW5kZXJUYm9keSh0Ym9keSkge1xuICAgIGNvbnN0IGwgPSB0aGlzLmdyaWQuZGF0YS5sZW5ndGg7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsOyBpKyspIHtcbiAgICAgIGNvbnN0IHRyID0gdGhpcy5jcmVhdGVUYWJsZVJvdyh0aGlzLmdyaWQuZGF0YVtpXSwgaSk7XG4gICAgICB0Ym9keS5hcHBlbmQodHIpO1xuICAgIH07XG5cblxuXG4gIH1cbiAgYXN5bmMgdGFibGVBY3RpdmF0ZShjb250YWluZXIsIHRhYmxlZGVmID0gbnVsbCkge1xuICAgIE1vZHVsZUV2ZW50RW1pdHRlci5vbmNlKHRoaXMuZXZlbnRuYW1lcy5sb2FkLCAoKSA9PiB7XG4gICAgICB0aGlzLmluaXRQbHVnaW5zKGNvbnRhaW5lcik7XG4gICAgICB0aGlzLmluaXRTZWFyY2goKTtcbiAgICAgIHRoaXMuaW5pdFNvcnQoKTtcbiAgICAgIHRoaXMud2FpdERlYWN0aXZhdGUoKTtcbiAgICAgIC8vIGhpZGUgYW5kIG1vdmUgd2FpdGRpdiBpbiB0aGUgd3JhcHBlciBmb3IgaW5uZXIgZWxlbWVudHMgZGlzcGxheVxuICAgICAgdGhpcy5kb20uY2xhc3NMaXN0LnJlbW92ZShjc3MuaGlkZSk7XG4gICAgICBpZiAodGhpcy5hZnRlckxvYWQpIHRoaXMuYWZ0ZXJMb2FkKCk7XG4gICAgICAvLyBtb3ZlIGltcG9ydCB6b25lcyBhbmQvb3Igc2VhcmNoIHpvbmUgLSByZW9yZyB0aGUgcGFnZSBkaXNwbGF5XG4gICAgICAvLyBmZXRjaCBvbmNlIHRoZSBzYW1lIHRhYmxlXG4gICAgICBjb250YWluZXIuZGF0YXNldC50YWJsZSA9IHRoaXMucGFyYW1zLnRhYmxlID0gdHJ1ZTtcbiAgICAgIHRoaXMuaW5pdGlhbGl6ZWQgPSB0cnVlO1xuICAgIH0sIHRoaXMudXVpZCk7XG4gICAgLy8gZGlzbWlzcyB0YWJsZSB3aGVuIGRpc21pc3MgbW9kYWxcbiAgICBNb2R1bGVFdmVudEVtaXR0ZXIub25jZSh0aGlzLmV2ZW50bmFtZXMuZGlzbWlzcywgKGUpID0+IHtcbiAgICAgIHRoaXMuZGVzdHJveSgpO1xuICAgIH0sIHRoaXMudXVpZCk7XG4gICAgaWYgKHRhYmxlZGVmKSB0YWJsZWRlZiA9IGF3YWl0IHRoaXMuZGF0YVRvVGFibGUodGFibGVkZWYpO1xuICAgIGVsc2UgYXdhaXQgdGhpcy50YWJsZVRvRGF0YSgpO1xuICAgIGlmICh0aGlzLmdyaWQuZGF0YS5sZW5ndGgpIE1vZHVsZUV2ZW50RW1pdHRlci5lbWl0KHRoaXMuZXZlbnRuYW1lcy5sb2FkLCB7fSwgdGhpcy51dWlkKTtcbiAgICBpbnN0YW5jZVt0aGlzLnV1aWRdID0gdHJ1ZTtcbiAgfVxuXG4gIHRhYmxlQXBwZW5kUm93cyhyb3dzKSB7XG4gICAgY29uc29sZS5sb2coJ3Jvd3MnKTtcbiAgfVxuICBkZXN0cm95KCkge1xuICAgIGlmICh0aGlzLmRhdGFJbXBvcnQpIHRoaXMuZGF0YUltcG9ydCA9IG51bGw7XG4gICAgdGhpcy5kb20gPSBudWxsO1xuICAgIGRlbGV0ZSBpbnN0YW5jZVt0aGlzLnV1aWRdO1xuICB9XG5cbiAgcmVmcmVzaChlKSB7XG4gICAgaWYgKHRoaXMuZGF0YUltcG9ydCkgdGhpcy5kYXRhSW1wb3J0LnJlc2V0U2VsZWN0b3JzKCk7XG4gIH1cbiAgbGFiZWxGb3JtYXR0ZXIoY29sdW1uKSB7XG4gICAgbGV0IGFsaWduID0gYGA7XG4gICAgaWYgKFsnbnVtYmVyJywgJ3Byb2dyZXNzJywgJ2RlY2ltYWwnXS5maW5kKGZvcm1hdCA9PiBmb3JtYXQgPT09IGNvbHVtbi5mb3JtYXQpKSBhbGlnbiA9IGNzcy5yaWdodDtcbiAgICBpZiAoY29sdW1uLnN1YmZpZWxkKSByZXR1cm4gYCR7Y29sdW1uLmxhYmVsfSA8c3BhbiBjbGFzcz1cInN1YmxhYmVsXCI+JHtjb2x1bW4uc3VibGFiZWx9PC9zcGFuPmA7XG4gICAgZWxzZSBpZiAoY29sdW1uLmxhYmVsKSByZXR1cm4gYDxzcGFuIGNsYXNzPVwiJHthbGlnbn1cIj4ke2NvbHVtbi5sYWJlbH08L3NwYW4+YDtcbiAgICBlbHNlIHJldHVybiBgYDtcbiAgfVxuICBnZXRDZWxsSWQobmFtZSkge1xuICAgIGxldCBjb2xzID0gdGhpcy5ncmlkLmNvbHVtbnMuZmlsdGVyKGNvbHVtbiA9PiAoY29sdW1uLm5hbWUgPT09IG5hbWUpKTtcbiAgICByZXR1cm4gKGNvbHMubGVuZ3RoKSA/IGNvbHNbMF0uaW5kZXggOiAtMTtcbiAgfVxuXG4gIGdldENlbGxEYXRhKHJvd0luZGV4LCBuYW1lLCBjZWxsSW5kZXggPSBudWxsKSB7XG4gICAgY2VsbEluZGV4ID0gKGNlbGxJbmRleCA9PT0gbnVsbCkgPyB0aGlzLmdldENlbGxJZChuYW1lKSA6IGNlbGxJbmRleDtcbiAgICBpZiAoY2VsbEluZGV4IDwgMCkgcmV0dXJuIG51bGw7XG4gICAgcmV0dXJuICh0aGlzLmdyaWQuZGF0YS5sZW5ndGgpID8gKCh0aGlzLmdyaWQuZGF0YVtyb3dJbmRleF0pID8gdGhpcy5ncmlkLmRhdGFbcm93SW5kZXhdW2NlbGxJbmRleF0gOiBudWxsKSA6IG51bGw7XG4gIH1cblxuICByb3dBdHRyaWJ1dGVzKHRyLCBpbmRleCkge1xuICAgIGNvbnN0IGlkID0gdGhpcy5nZXRDZWxsRGF0YShpbmRleCwgdGhpcy5jZWxsaWRuYW1lKTtcbiAgICB0ci5kYXRhc2V0W3RoaXMuY2VsbGlkbmFtZV0gPSBpZDtcbiAgICBpZiAodGhpcy5zZXRSb3dBdHRyaWJ1dGVzKSB0ciA9IHRoaXMuc2V0Um93QXR0cmlidXRlcyh0aGlzLCB0ciwgaWQpO1xuICAgIHJldHVybiB0cjtcbiAgfVxuXG4gIGNyZWF0ZVRhYmxlUm93KHJvdywgaW5kZXgsIGlzaGVhZGVyID0gZmFsc2UpIHtcbiAgICBjb25zdCB0ciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RyJyk7XG4gICAgbGV0IHRkO1xuICAgIHRoaXMuZ3JpZC5jb2x1bW5zLmZvckVhY2goY29sdW1uID0+IHtcbiAgICAgIGlmIChjb2x1bW4uaGFzT3duUHJvcGVydHkoJ2hpZGRlbicpICYmIGNvbHVtbi5oaWRkZW4gPT09IHRydWUpIHJldHVybjtcbiAgICAgIGNvbnN0IGNlbGwgPSByb3dbY29sdW1uLmluZGV4XTtcbiAgICAgIGlmIChjb2x1bW4uaGFzT3duUHJvcGVydHkoXCJyZW5kZXJcIikpIHtcbiAgICAgICAgdGQgPSBjb2x1bW4ucmVuZGVyKGNlbGwsIGluZGV4LCBjb2x1bW4uaW5kZXgpO1xuICAgICAgICB0ZC5ub2RlbmFtZSA9IChpc2hlYWRlcikgPyAnVEgnIDogJ1REJztcbiAgICAgICAgdGQgPSB0aGlzLm9ialRvRWxlbWVudCh0ZCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0ZCA9IChpc2hlYWRlcikgPyBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0aCcpIDogZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndGQnKTtcbiAgICAgICAgdGQuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoY2VsbCkpO1xuICAgICAgfVxuICAgICAgdHIuYXBwZW5kQ2hpbGQodGQpO1xuICAgIH0pXG4gICAgcmV0dXJuIHRoaXMucm93QXR0cmlidXRlcyh0ciwgaW5kZXgpO1xuICB9XG5cbiAgb2JqVG9FbGVtZW50KG9iaikge1xuICAgIGlmIChvYmoubm9kZW5hbWUgPT09IFwiI3RleHRcIikgcmV0dXJuIGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKG9iai5kYXRhKTtcbiAgICBjb25zdCBlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQob2JqLm5vZGVuYW1lKTtcbiAgICBpZiAob2JqLmhhc093blByb3BlcnR5KFwiaHRtbFwiKSkgZWwuaW5uZXJIVE1MID0gb2JqLmh0bWw7XG4gICAgZWxzZSBlbC50ZXh0Q29udGVudCA9IG9iai5kYXRhO1xuICAgIGlmIChvYmouaGFzT3duUHJvcGVydHkoXCJhdHRyaWJ1dGVzXCIpKSB7XG4gICAgICBmb3IgKGNvbnN0IGF0dHIgaW4gb2JqLmF0dHJpYnV0ZXMpIHtcbiAgICAgICAgZWwuc2V0QXR0cmlidXRlKGF0dHIsIG9iai5hdHRyaWJ1dGVzW2F0dHJdKTtcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKG9iai5oYXNPd25Qcm9wZXJ0eShcImNoaWxkbm9kZXNcIikpIHtcbiAgICAgIG9iai5jaGlsZG5vZGVzLmZvckVhY2goY2hpbGRub2RlID0+IHtcblxuICAgICAgICBlbC5hcHBlbmRDaGlsZCh0aGlzLm9ialRvRWxlbWVudChjaGlsZG5vZGUpKTtcbiAgICAgIH0pO1xuXG4gICAgfVxuICAgIHJldHVybiBlbDtcbiAgfVxuXG4gIHNldFRleHROb2RlKHZhbHVlKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIG5vZGVuYW1lOiBcIiN0ZXh0XCIsXG4gICAgICBkYXRhOiB2YWx1ZVxuICAgIH07XG4gIH1cbiAgYXN5bmMgZ2V0Rm9ybWF0dGVycygpIHtcbiAgICBsZXQgZm9ybWF0dGVycyA9IHtcbiAgICAgIGNvbnRyb2xzOiAodmFsdWUsIHJvd0luZGV4LCBjZWxsSW5kZXgsIHRkID0ge30pID0+IHtcbiAgICAgICAgY29uc3QgY29sdW1uID0gdGhpcy5ncmlkLmNvbHVtbnNbY2VsbEluZGV4XTtcbiAgICAgICAgY29uc3QgaWQgPSB0aGlzLmdldENlbGxEYXRhKHJvd0luZGV4LCBjb2x1bW4uZmllbGQpO1xuICAgICAgICBjb25zdCBhY3Rpb25zID0gKGNvbHVtbi5hY3Rpb25zKSA/IGNvbHVtbi5hY3Rpb25zIDogbnVsbDtcbiAgICAgICAgaWYgKCFhY3Rpb25zKSByZXR1cm4gYGA7XG4gICAgICAgIGxldCBjb250cm9scyA9IFtdO1xuICAgICAgICBPYmplY3QuZW50cmllcyhhY3Rpb25zKS5mb3JFYWNoKChba2V5LCBhY3Rpb25dKSA9PiB7XG4gICAgICAgICAgY29udHJvbHMucHVzaCh7XG4gICAgICAgICAgICBub2RlbmFtZTogXCJBXCIsXG4gICAgICAgICAgICBhdHRyaWJ1dGVzOiB7XG4gICAgICAgICAgICAgIGNsYXNzOiBgYnRuIGlzLSR7a2V5fSBgLFxuICAgICAgICAgICAgICBocmVmOiBgJHthY3Rpb24ubGlua30ke2lkfWBcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBjaGlsZG5vZGVzOiBbdGhpcy5zZXRUZXh0Tm9kZShhY3Rpb24ubGFiZWwpXVxuICAgICAgICAgIH0pO1xuXG4gICAgICAgIH0pO1xuICAgICAgICBpZiAoIXRkLmhhc093blByb3BlcnR5KCdhdHRyaWJ1dGVzJykpIHRkLmF0dHJpYnV0ZXMgPSB7fTtcbiAgICAgICAgdGQuYXR0cmlidXRlcy5jbGFzcyA9IGNzcy5jb21wb25lbnQudGFibGUuY29udHJvbHM7XG4gICAgICAgIHRkLmNoaWxkbm9kZXMgPSBjb250cm9scztcbiAgICAgICAgcmV0dXJuIHRkO1xuICAgICAgfSxcbiAgICAgIHNlbGVjdDogKHZhbHVlLCByb3dJbmRleCwgY2VsbEluZGV4LCB0ZCA9IHt9KSA9PiB7XG4gICAgICAgIGNvbnN0IGNvbHVtbiA9IHRoaXMuZ3JpZC5jb2x1bW5zW2NlbGxJbmRleF07XG4gICAgICAgIHZhbHVlID0gKGlzTmFOKHZhbHVlKSkgPyB0aGlzLmdldENlbGxEYXRhKHJvd0luZGV4LCBjb2x1bW4uZmllbGQpIDogdmFsdWU7XG5cbiAgICAgICAgdGQuY2hpbGRub2RlcyA9IFt7XG4gICAgICAgICAgbm9kZW5hbWU6IFwiSU5QVVRcIixcbiAgICAgICAgICBhdHRyaWJ1dGVzOiB7XG4gICAgICAgICAgICB0eXBlOiBcInJhZGlvXCIsXG4gICAgICAgICAgICBuYW1lOiBgJHt0aGlzLnV1aWR9c2VsZWN0YCxcbiAgICAgICAgICAgIHZhbHVlOiBTdHJpbmcodmFsdWUpXG4gICAgICAgICAgfVxuICAgICAgICB9XTtcbiAgICAgICAgcmV0dXJuIHRkO1xuICAgICAgfSxcbiAgICAgIHNlbGVjdG11bHRpcGxlOiAodmFsdWUsIHJvd0luZGV4LCBjZWxsSW5kZXgsIHRkID0ge30pID0+IHtcbiAgICAgICAgY29uc3QgY29sdW1uID0gdGhpcy5ncmlkLmNvbHVtbnNbY2VsbEluZGV4XTtcbiAgICAgICAgdmFsdWUgPSAoaXNOYU4odmFsdWUpKSA/ICgoY29sdW1uLmhhc093blByb3BlcnR5KCdmaWVsZCcpKSA/IHRoaXMuZ2V0Q2VsbERhdGEocm93SW5kZXgsIGNvbHVtbi5maWVsZCkgOiB2YWx1ZSkgOiB2YWx1ZTtcbiAgICAgICAgdGQuY2hpbGRub2RlcyA9IFt7XG4gICAgICAgICAgbm9kZW5hbWU6IFwiSU5QVVRcIixcbiAgICAgICAgICBhdHRyaWJ1dGVzOiB7XG4gICAgICAgICAgICB0eXBlOiBcImNoZWNrYm94XCIsXG4gICAgICAgICAgICBuYW1lOiBgJHt0aGlzLnV1aWR9c2VsZWN0W11gLFxuICAgICAgICAgICAgdmFsdWU6IFN0cmluZyh2YWx1ZSlcbiAgICAgICAgICB9XG4gICAgICAgIH1dO1xuICAgICAgICByZXR1cm4gdGQ7XG4gICAgICB9LFxuICAgICAgZGVjaW1hbDogKHZhbHVlLCByb3dJbmRleCwgY2VsbEluZGV4LCB0ZCA9IHt9KSA9PiB7XG4gICAgICAgIGlmIChpc05hTih2YWx1ZSkpIHZhbHVlID0gMDtcbiAgICAgICAgdmFsdWUgPSBwYXJzZUZsb2F0KHZhbHVlKS50b0ZpeGVkKDIpO1xuICAgICAgICBpZiAodmFsdWUgLSBwYXJzZUludCh2YWx1ZSkgPT09IDApIHZhbHVlID0gcGFyc2VJbnQodmFsdWUpO1xuICAgICAgICBpZiAoIXRkLmhhc093blByb3BlcnR5KCdhdHRyaWJ1dGVzJykpIHRkLmF0dHJpYnV0ZXMgPSB7fTtcbiAgICAgICAgdGQuYXR0cmlidXRlcy5jbGFzcyA9IGNzcy5udW1iZXI7XG4gICAgICAgIHRkLmNoaWxkbm9kZXMgPSBbdGhpcy5zZXRUZXh0Tm9kZSh2YWx1ZSldO1xuICAgICAgICByZXR1cm4gdGQ7XG4gICAgICB9LFxuICAgICAgbnVtYmVyOiAodmFsdWUsIHJvd0luZGV4LCBjZWxsSW5kZXgsIHRkID0ge30pID0+IHtcbiAgICAgICAgaWYgKGlzTmFOKHZhbHVlKSkgdmFsdWUgPSAwO1xuICAgICAgICBpZiAoIXRkLmhhc093blByb3BlcnR5KCdhdHRyaWJ1dGVzJykpIHRkLmF0dHJpYnV0ZXMgPSB7fTtcbiAgICAgICAgdGQuYXR0cmlidXRlcy5jbGFzcyA9IGNzcy5udW1iZXI7XG4gICAgICAgIHRkLmNoaWxkbm9kZXMgPSBbdGhpcy5zZXRUZXh0Tm9kZSh2YWx1ZSldO1xuICAgICAgICByZXR1cm4gdGQ7XG4gICAgICB9LFxuICAgICAgY2hlY2s6ICh2YWx1ZSwgcm93SW5kZXgsIGNlbGxJbmRleCwgdGQgPSB7fSkgPT4ge1xuICAgICAgICBpZiAoaXNOYU4odmFsdWUpKSB2YWx1ZSA9IGBgO1xuICAgICAgICBzd2l0Y2ggKHZhbHVlKSB7XG4gICAgICAgICAgY2FzZSB0cnVlOlxuICAgICAgICAgIGNhc2UgJ1knOlxuICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgIHZhbHVlID0gXCJcIjtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICB2YWx1ZSA9IFwibm8tXCI7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBpY29uID0ge1xuICAgICAgICAgIG5vZGVuYW1lOiBcIklcIixcbiAgICAgICAgICBhdHRyaWJ1dGVzOiB7XG4gICAgICAgICAgICBjbGFzczogYGljb24tc20gIGljb24tJHt2YWx1ZX1jaGVjayBgXG4gICAgICAgICAgfSxcbiAgICAgICAgICBjaGlsZG5vZGVzOiBbXVxuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGNvbHVtbiA9IHRoaXMuZ3JpZC5jb2x1bW5zW2NlbGxJbmRleF07XG4gICAgICAgIGNvbnN0IGlkID0gdGhpcy5nZXRDZWxsRGF0YShyb3dJbmRleCwgdGhpcy5jZWxsaWRuYW1lKTtcbiAgICAgICAgaWYgKGNvbHVtbi5oYXNPd25Qcm9wZXJ0eShcInRvZ2dsZVwiKSkgdGQuY2hpbGRub2RlcyA9IFt7XG4gICAgICAgICAgbm9kZW5hbWU6IFwiQVwiLFxuICAgICAgICAgIGF0dHJpYnV0ZXM6IHtcbiAgICAgICAgICAgIFwiZGF0YS1yZXF1ZXN0XCI6IFwidG9nZ2xlXCIsXG4gICAgICAgICAgICBcImRhdGEtYWN0aW9uXCI6IGAke2NvbHVtbi50b2dnbGUubGlua30vJHtpZH1gLFxuICAgICAgICAgICAgXCJocmVmXCI6IFwiamF2YXNjcmlwdDp2b2lkKClcIlxuXG4gICAgICAgICAgfSxcbiAgICAgICAgICBjaGlsZG5vZGVzOiBbaWNvbl1cblxuICAgICAgICB9XVxuICAgICAgICBlbHNlIHRkLmNoaWxkbm9kZXMgPSBbaWNvbl07XG4gICAgICAgIHJldHVybiB0ZDtcbiAgICAgIH0sXG4gICAgICB0ZXh0OiAodmFsdWUsIHJvd0luZGV4LCBjZWxsSW5kZXgsIHRkID0ge30pID0+IHtcbiAgICAgICAgaWYgKHZhbHVlID09PSBudWxsKSB0ZC5jaGlsZG5vZGVzID0gW107XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgIHZhbHVlID0gdmFsdWUucmVwbGFjZUFsbCgnXFxyXFxuJywgJywgJyk7XG4gICAgICAgICAgaWYgKHZhbHVlICE9PSBgYCkgdGQuY2hpbGRub2RlcyA9IFt7XG4gICAgICAgICAgICBub2RlbmFtZTogXCJESVZcIixcbiAgICAgICAgICAgIGF0dHJpYnV0ZXM6IHtcbiAgICAgICAgICAgICAgY2xhc3M6IGNzcy5jb21wb25lbnQudGFibGUudGlwXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgY2hpbGRub2RlczogW3RoaXMuc2V0VGV4dE5vZGUodmFsdWUpXVxuICAgICAgICAgIH1dO1xuICAgICAgICAgIGVsc2UgdGQuY2hpbGRub2RlcyA9IFtdO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0ZDtcbiAgICAgIH0sXG4gICAgICBkZWZhdWx0OiAodmFsdWUsIHJvd0luZGV4LCBjZWxsSW5kZXgsIHRkID0ge30pID0+IHtcbiAgICAgICAgaWYgKHZhbHVlID09PSBudWxsIHx8IHZhbHVlID09PSBgYCkgdGQuY2hpbGRub2RlcyA9IFtdO1xuICAgICAgICBlbHNlIHRkLmNoaWxkbm9kZXMgPSBbdGhpcy5zZXRUZXh0Tm9kZSh2YWx1ZSldO1xuICAgICAgICByZXR1cm4gdGQ7XG4gICAgICB9XG5cbiAgICB9XG4gICAgbGV0IHRhYmxlY3VzdG9tID0gbnVsbDtcblxuICAgIHN3aXRjaCAodGhpcy5wYXJhbXMuZnJvbSkge1xuICAgICAgY2FzZSAnY29sbGVjdGlvbmxpc3QnOlxuICAgICAgICB0YWJsZWN1c3RvbSA9IGF3YWl0IGltcG9ydCgnLi4vbW9kdWxlcy90YWJsZS1jb2xsZWN0aW9uLmpzJyk7XG4gICAgICAgIHRoaXMuY2VsbGlkbmFtZSA9IG1vZGVscy5pZDtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICdwcmpsaXN0JzpcbiAgICAgICAgdGFibGVjdXN0b20gPSBhd2FpdCBpbXBvcnQoJy4uL21vZHVsZXMvdGFibGUtcHJvamVjdC5qcycpO1xuICAgICAgICB0aGlzLmNlbGxpZG5hbWUgPSBtb2RlbHMucHJvamlkO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ3ByanNhbXBsZXN0YXRzJzpcbiAgICAgICAgdGFibGVjdXN0b20gPSBhd2FpdCBpbXBvcnQoJy4uL21vZHVsZXMvdGFibGUtc2FtcGxlLmpzJyk7XG4gICAgICAgIHRoaXMuY2VsbGlkbmFtZSA9IG1vZGVscy5zYW1wbGVpZDtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIFwicHJqcHJlZGljdFwiOlxuICAgICAgICB0YWJsZWN1c3RvbSA9IGF3YWl0IGltcG9ydCgnLi4vbW9kdWxlcy90YWJsZS1wcmVkaWN0aW9uLmpzJyk7XG4gICAgICAgIHRoaXMuY2VsbGlkbmFtZSA9IG1vZGVscy5wcm9qaWQ7XG5cbiAgICAgICAgYnJlYWs7XG4gICAgfVxuXG4gICAgcmV0dXJuICh0YWJsZWN1c3RvbSkgPyB7IC4uLmZvcm1hdHRlcnMsXG4gICAgICAuLi50YWJsZWN1c3RvbS5kZWZhdWx0KHRoaXMpXG4gICAgfSA6IGZvcm1hdHRlcnM7XG5cblxuICB9XG4gIGFzeW5jIGNvbnZlcnRDb2x1bW5zKHRhYmxlZGVmKSB7XG4gICAgY29uc3QgY29sdW1ucyA9ICh0YWJsZWRlZi5jb2x1bW5zKSA/IHRhYmxlZGVmLmNvbHVtbnMgOiAoKHRoaXMucGFyYW1zLmNvbHVtbnMpID8gSlNPTi5wYXJzZSh0aGlzLnBhcmFtcy5jb2x1bW5zKSA6IG51bGwpO1xuICAgIGlmICghY29sdW1ucykgcmV0dXJuO1xuICAgIGNvbnN0IGZvcm1hdHRlcnMgPSBhd2FpdCB0aGlzLmdldEZvcm1hdHRlcnMoKTtcbiAgICAvL1xuICAgIGNvbnN0IGZpZWxkcyA9IFtdO1xuICAgIE9iamVjdC5lbnRyaWVzKHRhYmxlZGVmLmNvbHVtbnMpLmZvckVhY2goKFtrZXksIGNvbHVtbl0pID0+IHtcbiAgICAgIGlmICghY29sdW1uLmhhc093blByb3BlcnR5KCdlbXB0eWRhdGEnKSkgZmllbGRzLnB1c2goa2V5KTtcbiAgICB9KTtcbiAgICBjb25zdCBtYXBfY29sdW1uID0gKGtleSwgY29sdW1uLCBpbmRleCkgPT4ge1xuICAgICAgaWYgKCFjb2x1bW4pIHJldHVybiB7XG4gICAgICAgIGluZGV4OiBpbmRleCxcbiAgICAgICAgbmFtZToga2V5LFxuICAgICAgICBoaWRkZW46IHRydWVcbiAgICAgIH07XG4gICAgICBsZXQgY29sID0ge1xuICAgICAgICBpbmRleDogaW5kZXgsXG4gICAgICAgIG5hbWU6IGtleSxcbiAgICAgICAgbGFiZWw6IHRoaXMubGFiZWxGb3JtYXR0ZXIoY29sdW1uKSxcbiAgICAgICAgc29ydGFibGU6IHRydWUsXG5cbiAgICAgIH07XG4gICAgICBjb2wuaW5kZXggPSAoY29sdW1uLmhhc093blByb3BlcnR5KCdlbXB0eWRhdGEnKSkgPyBmaWVsZHMuaW5kZXhPZihjb2x1bW4uZW1wdHlkYXRhKSA6IGZpZWxkcy5pbmRleE9mKGtleSk7XG4gICAgICBpZiAoY29sdW1uLm5vdHNvcnRhYmxlKSBjb2wuc29ydGFibGUgPSBmYWxzZTtcbiAgICAgIGVsc2UgaWYgKGNvbHVtbi5zb3J0YWJsZSkgY29sLnNvcnQgPSBjb2wuc29ydGFibGU7XG4gICAgICBjb2wuc2VhcmNoYWJsZSA9IChjb2wubm90c2VhcmNoYWJsZSkgPyBmYWxzZSA6IHRydWU7XG4gICAgICBpZiAoY29sdW1uLmhpZGRlbikgY29sLmhpZGRlbiA9IHN0cmluZ190b19ib29sZWFuKGNvbHVtbi5oaWRkZW4pO1xuICAgICAgaWYgKFsnbnVtYmVyJywgJ2RlY2ltYWwnXS5maW5kKGZvcm1hdCA9PiBmb3JtYXQgPT09IGNvbHVtbi5mb3JtYXQpKSBjb2wudHlwZSA9ICdudW1iZXInO1xuICAgICAgbGV0IHJlbmRlciA9IG51bGw7XG4gICAgICBzd2l0Y2ggKGtleSkge1xuICAgICAgICBjYXNlICdzZWxlY3QnOlxuICAgICAgICAgIGNvbnN0IHNlbGVjdCA9IChjb2x1bW4uc2VsZWN0ICYmIGNvbHVtbi5zZWxlY3QgPT0gXCJjb250cm9sc1wiKSA/IFwiY29udHJvbHNcIiA6ICgoY29sdW1uLnNlbGVjdGNlbGxzKSA/IFwiaW1wb3J0c1wiIDogY29sdW1uLnNlbGVjdCk7XG4gICAgICAgICAgaWYgKHNlbGVjdCkge1xuICAgICAgICAgICAgY29sID0geyAuLi5jb2x1bW4sXG4gICAgICAgICAgICAgIC4uLmNvbFxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjb2wuc29ydGFibGUgPSBjb2wuc2VhcmNoYWJsZSA9IGZhbHNlO1xuICAgICAgICAgIH1cbiAgICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIGlmICghY29sdW1uLmhhc093blByb3BlcnR5KCdoaWRkZW4nKSkge1xuICAgICAgICBjb25zdCBzZWxlY3QgPSAoY29sdW1uLnNlbGVjdCAmJiBjb2x1bW4uc2VsZWN0ID09IG1vZGVscy5jb250cm9scykgPyBtb2RlbHMuY29udHJvbHMgOiAoKGNvbHVtbi5zZWxlY3RjZWxscykgPyBtb2RlbHMuaW1wb3J0cyA6IGNvbHVtbi5zZWxlY3QpXG4gICAgICAgIGNvbnN0IGZvcm1hdCA9IChjb2x1bW4uZm9ybWF0KSA/IGNvbHVtbi5mb3JtYXQgOiAoKGNvbHVtbi5zdWJmaWVsZCkgPyBjb2x1bW4uc3ViZmllbGQgOiAoKHNlbGVjdCkgPyBzZWxlY3QgOiBcImRlZmF1bHRcIikpO1xuICAgICAgICBpZiAoZm9ybWF0dGVycyAmJiBmb3JtYXR0ZXJzW2Zvcm1hdF0pIGNvbC5yZW5kZXIgPSBmb3JtYXR0ZXJzW2Zvcm1hdF07XG5cbiAgICAgIH1cbiAgICAgIHJldHVybiBjb2w7XG4gICAgfVxuXG4gICAgdGhpcy5ncmlkLmNvbHVtbnMgPSBPYmplY3QuZW50cmllcyhjb2x1bW5zKS5tYXAoKFtrZXksIGNvbHVtbl0sIGluZGV4KSA9PiBtYXBfY29sdW1uKGtleSwgY29sdW1uLCBpbmRleCkpO1xuICB9XG4gIGluaXRFdmVudHMoKSB7XG5cbiAgICBNb2R1bGVFdmVudEVtaXR0ZXIub24odGhpcy5ldmVudG5hbWVzLnVwZGF0ZSwgKCkgPT4ge1xuICAgICAgdGhpcy5kb20uY2xhc3NMaXN0LnJlbW92ZShjc3MuaGlkZSk7XG4gICAgfSwgdGhpcy51dWlkKTtcbiAgfVxuICBpbml0UGx1Z2lucyhjb250YWluZXIpIHtcbiAgICBpZiAoIXRoaXMuZ3JpZC5kYXRhLmxlbmd0aCkgcmV0dXJuO1xuICAgIGlmICh0aGlzLnBhcmFtcy5pbXBvcnQgJiYgdGhpcy5pbml0SW1wb3J0KSB0aGlzLmluaXRJbXBvcnQodGhpcyk7XG4gICAgaWYgKHRoaXMucGFyYW1zLmV4cGFuZCkgdGhpcy5tYWtlRXhwYW5kYWJsZShjb250YWluZXIpO1xuICAgIGlmICh0aGlzLnBhcmFtcy5leHBvcnQpIHRoaXMubWFrZUV4cG9ydGFibGUoY29udGFpbmVyKTtcbiAgICBpZiAodGhpcy5wYXJhbXMuZGV0YWlscyB8fCB0aGlzLmRvbS5xdWVyeVNlbGVjdG9yKHRhYmxlc2VsZWN0b3JzLmRldGFpbHMpKSB7XG4gICAgICB0aGlzLmluaXREZXRhaWxzKCk7XG4gICAgfSBlbHNlIHRoaXMuaW5pdEV2ZW50cygpO1xuICAgIGlmICh0aGlzLnBhcmFtcy5vbnNlbGVjdCkgdGhpcy5pbml0U2VsZWN0KGNvbnRhaW5lcik7XG4gICAgaWYgKHRoaXMuZG9tLnF1ZXJ5U2VsZWN0b3JBbGwoJ3RoZWFkIFtkYXRhLWFsdHNvcnRdJykubGVuZ3RoKSB0aGlzLmluaXRBbHRlcm5hdGVTb3J0KHRoaXMuZG9tLnF1ZXJ5U2VsZWN0b3JBbGwoJ3RoZWFkIFtkYXRhLWFsdHNvcnRdJykpO1xuICAgIGlmICh0aGlzLnBhcmFtcy5maWx0ZXJzKSB7XG4gICAgICBjb25zdCB0b3AgPSB0aGlzLndyYXBwZXIucXVlcnlTZWxlY3Rvcih0YWJsZXNlbGVjdG9ycy50b3ApO1xuICAgICAgaWYgKHRvcCAmJiB0b3AuY2hpbGRyZW4ubGVuZ3RoKSB7XG4gICAgICAgIGNvbnN0IGZpbHRlcnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHRhYmxlc2VsZWN0b3JzLmZpbHRlcnMpO1xuICAgICAgICAvLyBpbnNlcnQgIGZpbHRlcnMgbm9kZSAgaW4gZGF0YXRhYmxlIHRvcFxuICAgICAgICBpZiAoZmlsdGVycykgdG9wLnByZXBlbmQoZmlsdGVycyk7XG4gICAgICB9XG4gICAgfVxuICAgIGlmICh0aGlzLmRvbS5xdWVyeVNlbGVjdG9yKHRhYmxlc2VsZWN0b3JzLnRpcCkpIHtcbiAgICAgIHRoaXMuaW5pdFRpcHMoKTtcbiAgICB9XG5cbiAgfVxuICBpbml0U29ydCgpIHtcblxuICAgIGNvbnN0IHRocyA9IHRoaXMuZG9tLnF1ZXJ5U2VsZWN0b3JBbGwoJ3RoZWFkIHRoJyk7XG4gICAgbGV0IGluZGV4ID0gMDtcbiAgICB0aGlzLmdyaWQuY29sdW1ucy5mb3JFYWNoKChjb2x1bW4sIGkpID0+IHtcbiAgICAgIGlmIChjb2x1bW4uaGFzT3duUHJvcGVydHkoJ2hpZGRlbicpKSByZXR1cm47XG4gICAgICBpZiAoY29sdW1uLnNvcnRhYmxlKSB7XG4gICAgICAgIGNvbnN0IHRoID0gdGhzW2luZGV4XTtcbiAgICAgICAgY29uc3QgYSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTtcbiAgICAgICAgYS5jbGFzc0xpc3QuYWRkKHRhYmxlc2VsZWN0b3JzLnNvcnRlci5zdWJzdHIoMSkpO1xuICAgICAgICBhLmFwcGVuZENoaWxkKHRoLmNoaWxkTm9kZXNbMF0pO1xuICAgICAgICB0aC5hcHBlbmRDaGlsZChhKTtcbiAgICAgICAgdGguY2hpbGROb2Rlcy5mb3JFYWNoKGNoaWxkID0+IHtcbiAgICAgICAgICB0aC5hcHBlbmRDaGlsZChjaGlsZCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGEuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4ge1xuICAgICAgICAgIGUuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgaWYgKHRoaXMuc29ydGluZyA9PT0gdHJ1ZSB8fCB0aGlzLnNlYXJjaGluZyA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgIH1cbiAgICAgICAgICB0aGlzLnNvcnRDb2x1bW4odGgsIGNvbHVtbi5pbmRleCk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgaW5kZXgrKztcbiAgICB9KTtcbiAgICB0aGlzLnNvcnRpbmcgPSBmYWxzZTtcbiAgICAvLyByZW1vdmUgZGV0YWlscyB3aGVuIHNvcnRpbmdcbiAgICBNb2R1bGVFdmVudEVtaXR0ZXIub24odGhpcy5ldmVudG5hbWVzLnNvcnRpbmcsIChyZXEpID0+IHtcbiAgICAgIC8vIHJlcSB7ZGlyOmRpcmVjdGlvbiwgaW5kZXg6aW5kZXh9XG4gICAgICBpZiAodGhpcy5wbHVnaW5zLmpzRGV0YWlsKSB0aGlzLnBsdWdpbnMuanNEZXRhaWwuYWN0aXZlRGV0YWlsKGZhbHNlKTtcbiAgICAgIHRoaXMuZG9tLnF1ZXJ5U2VsZWN0b3JBbGwoJy50YWJsZS1zb3J0ZXInKS5mb3JFYWNoKChhLCBpKSA9PiB7XG4gICAgICAgIGEuY2xhc3NMaXN0LmFkZCgoKGkgPT09IHJlcS5pbmRleCkgPyBjc3Mud2FpdCA6IGNzcy5kaXNhYmxlZCkpO1xuICAgICAgfSk7XG4gICAgICB0aGlzLnNvcnRpbmcgPSB0cnVlO1xuICAgIH0sIHRoaXMudXVpZCk7XG4gICAgLy8gcmVtb3ZlIGRldGFpbHMgd2hlbiBzb3J0aW5nXG4gICAgTW9kdWxlRXZlbnRFbWl0dGVyLm9uKHRoaXMuZXZlbnRuYW1lcy5zb3J0ZWQsIChyZXEpID0+IHtcbiAgICAgIC8vIHJlcSB7ZGlyOmRpcmVjdGlvbiwgaW5kZXg6aW5kZXh9XG4gICAgICB0aGlzLmRvbS5xdWVyeVNlbGVjdG9yQWxsKCcudGFibGUtc29ydGVyJykuZm9yRWFjaCgoYSwgaSkgPT4ge1xuICAgICAgICBhLmNsYXNzTGlzdC5yZW1vdmUoKChpID09PSByZXEuaW5kZXgpID8gY3NzLndhaXQgOiBjc3MuZGlzYWJsZWQpKVxuICAgICAgfSk7XG4gICAgICB0aGlzLnNvcnRpbmcgPSBmYWxzZTtcbiAgICB9LCB0aGlzLnV1aWQpO1xuICB9XG4gIHNvcnRDb2x1bW4odGgsIGluZGV4LCBkaXIgPSBudWxsKSB7XG4gICAgZGlyID0gKGRpciA9PT0gbnVsbCkgPyAoKHRoLmNsYXNzTGlzdC5jb250YWlucyh0YWJsZWNzcy5hc2NlbmRpbmcpKSA/IGZhbHNlIDogKHRoLmNsYXNzTGlzdC5jb250YWlucyh0YWJsZWNzcy5kZXNjZW5kaW5nKSkgPyB0cnVlIDogKCh0aC5kYXRhc2V0LnNvcnQpID8gZmFsc2UgOiB0cnVlKSkgOiBkaXI7XG4gICAgdGguY2xhc3NMaXN0LnRvZ2dsZSh0YWJsZWNzcy5hc2NlbmRpbmcpO1xuICAgIHRoLmNsYXNzTGlzdC50b2dnbGUodGFibGVjc3MuZGVzY2VuZGluZyk7XG4gICAgTW9kdWxlRXZlbnRFbWl0dGVyLmVtaXQodGhpcy5ldmVudG5hbWVzLnNvcnRpbmcsIHtcbiAgICAgIGRpcjogZGlyLFxuICAgICAgaW5kZXg6IHRoLmNlbGxJbmRleFxuICAgIH0sIHRoaXMudXVpZCk7XG4gICAgbGV0IHJvd3MgPSB0aGlzLmdyaWQuZGF0YS5tYXAoKHJvdywgaSkgPT4ge1xuICAgICAgY29uc3QgY2VsbCA9IGlzX29iamVjdChyb3dbaW5kZXhdKSA/IEpTT04uc3RyaW5naWZ5KHJvd1tpbmRleF0pIDogKChBcnJheS5pc0FycmF5KHJvd1tpbmRleF0pKSA/IHJvd1tpbmRleF1bMF0gOiByb3dbaW5kZXhdKTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHZhbHVlOiB0eXBlb2YgY2VsbCA9PT0gXCJzdHJpbmdcIiA/IGNlbGwudG9Mb3dlckNhc2UoKSA6ICgoY2VsbCA9PT0gbnVsbCkgPyAwIDogY2VsbCksXG4gICAgICAgIHJvdzogaVxuICAgICAgfVxuICAgIH0pO1xuXG4gICAgY29uc3QgY29tcGFyZV9jb2xkYXRhID0gZnVuY3Rpb24oYSwgYikge1xuICAgICAgY29uc3QgeCA9IChkaXIgPyBhLnZhbHVlIDogYi52YWx1ZSk7XG4gICAgICBjb25zdCB5ID0gKGRpciA/IGIudmFsdWUgOiBhLnZhbHVlKTtcbiAgICAgIHJldHVybiB4LmxvY2FsZUNvbXBhcmUoeSwgdW5kZWZpbmVkLCB7XG4gICAgICAgIG51bWVyaWM6IHRydWUsXG4gICAgICAgIHNlbnNpdGl2aXR5OiAnYmFzZSdcbiAgICAgIH0pO1xuXG4gICAgfTtcblxuICAgIGlmIChkaXIgPT09IGZhbHNlKSB7XG4gICAgICB0aC5jbGFzc0xpc3QucmVtb3ZlKHRhYmxlY3NzLmFzY2VuZGluZyk7XG4gICAgICB0aC5jbGFzc0xpc3QuYWRkKHRhYmxlY3NzLmRlc2NlbmRpbmcpO1xuICAgICAgdGguc2V0QXR0cmlidXRlKFwiYXJpYS1zb3J0XCIsIFwiZGVzY2VuZGluZ1wiKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGguY2xhc3NMaXN0LnJlbW92ZSh0YWJsZWNzcy5kZXNjZW5kaW5nKTtcbiAgICAgIHRoLmNsYXNzTGlzdC5hZGQodGFibGVjc3MuYXNjZW5kaW5nKTtcbiAgICAgIHRoLnNldEF0dHJpYnV0ZShcImFyaWEtc29ydFwiLCBcImFzY2VuZGluZ1wiKTtcbiAgICB9XG5cbiAgICAvKiBDbGVhciBhc2MvZGVzYyBjbGFzcyBuYW1lcyBmcm9tIHRoZSBsYXN0IHNvcnRlZCBjb2x1bW4ncyB0aCBpZiBpdCBpc24ndCB0aGUgc2FtZSBhcyB0aGUgb25lIHRoYXQgd2FzIGp1c3QgY2xpY2tlZCAqL1xuICAgIGlmICh0aGlzLmRvbS5kYXRhc2V0Lmxhc3R0aCAhPT0gdW5kZWZpbmVkICYmIHRoLmNlbGxJbmRleCAhPSB0aGlzLmRvbS5kYXRhc2V0Lmxhc3R0aCkge1xuICAgICAgY29uc3QgaGVhZGluZ3MgPSB0aGlzLmRvbS5xdWVyeVNlbGVjdG9yQWxsKFwidGhlYWQgdGhcIik7XG4gICAgICBoZWFkaW5nc1t0aGlzLmRvbS5kYXRhc2V0Lmxhc3R0aF0uY2xhc3NMaXN0LnJlbW92ZSh0YWJsZWNzcy5kZXNjZW5kaW5nKTtcbiAgICAgIGhlYWRpbmdzW3RoaXMuZG9tLmRhdGFzZXQubGFzdHRoXS5jbGFzc0xpc3QucmVtb3ZlKHRhYmxlY3NzLmFzY2VuZGluZyk7XG4gICAgICBoZWFkaW5nc1t0aGlzLmRvbS5kYXRhc2V0Lmxhc3R0aF0ucmVtb3ZlQXR0cmlidXRlKFwiYXJpYS1zb3J0XCIpO1xuXG4gICAgfVxuICAgIHRoaXMuZG9tLmRhdGFzZXQubGFzdHRoID0gdGguY2VsbEluZGV4O1xuICAgIGNvbnN0IGNvbGxhdG9yID0gbmV3IEludGwuQ29sbGF0b3IodW5kZWZpbmVkLCB7XG4gICAgICBudW1lcmljOiB0cnVlLFxuICAgICAgc2Vuc2l0aXZpdHk6ICdiYXNlJ1xuICAgIH0pXG4gICAgcm93cy5zb3J0KChhLCBiKSA9PiB7XG4gICAgICByZXR1cm4gY29sbGF0b3IuY29tcGFyZSgoZGlyID8gYS52YWx1ZSA6IGIudmFsdWUpLCAoZGlyID8gYi52YWx1ZSA6IGEudmFsdWUpKVxuICAgIH0pO1xuICAgIC8qcm93cy5zb3J0KChhLCBiKSA9PiB7XG4gICAgICByZXR1cm4gY29tcGFyZV9jb2xkYXRhKGEsIGIpO1xuICAgIH0pOyovXG4gICAgY29uc3QgdGJvZHkgPSB0aGlzLmRvbS5xdWVyeVNlbGVjdG9yKCd0Ym9keScpO1xuICAgIGNvbnN0IGNsb25lID0gdGJvZHkuY2xvbmVOb2RlKCk7XG4gICAgY29uc3QgdHJzID0gdGJvZHkucXVlcnlTZWxlY3RvckFsbCgndHInKTtcbiAgICB0Ym9keS5pbm5lckhUTUwgPSBgYDtcbiAgICBjb25zdCBzb3J0ZWQgPSBbXTtcbiAgICByb3dzLmZvckVhY2goKHIsIGkpID0+IHtcbiAgICAgIGNsb25lLmFwcGVuZENoaWxkKHRyc1tyLnJvd10pO1xuICAgICAgc29ydGVkLnB1c2godGhpcy5ncmlkLmRhdGFbci5yb3ddKTtcblxuICAgIH0pO1xuICAgIHRoaXMuZG9tLnJlcGxhY2VDaGlsZChjbG9uZSwgdGJvZHkpO1xuICAgIE1vZHVsZUV2ZW50RW1pdHRlci5lbWl0KHRoaXMuZXZlbnRuYW1lcy5zb3J0ZWQsIHtcbiAgICAgIGRpcjogZGlyLFxuICAgICAgaW5kZXg6IHRoLmNlbGxJbmRleFxuICAgIH0sIHRoaXMudXVpZCk7XG5cblxuICB9XG5cbiAgZGlzcGxheVNlbGVjdGVkKHF1ZXJpZXMsIGluZGV4ZXMsIGNlbGxpZCwgdG9nZ2xlID0gbnVsbCkge1xuICAgIGNvbnN0IHRycyA9IHRoaXMuZG9tLnF1ZXJ5U2VsZWN0b3JBbGwoJ3Rib2R5IHRyJyk7XG4gICAgaWYgKHRvZ2dsZSA9PT0gbnVsbCkgdG9nZ2xlID0gZnVuY3Rpb24odHIsIHZhbHVlLCBpZHgpIHtcbiAgICAgIHRyLmhpZGRlbiA9IHZhbHVlO1xuICAgIH1cbiAgICBjb25zdCByZXNldCA9IChxdWVyaWVzLmxlbmd0aCA9PT0gMCAmJiBpbmRleGVzLmxlbmd0aCA9PT0gMCk7XG4gICAgdHJzLmZvckVhY2goKHRyLCBpbmRleCkgPT4ge1xuICAgICAgaWYgKHJlc2V0KSB0b2dnbGUodHIsIGZhbHNlKTtcbiAgICAgIGVsc2Uge1xuICAgICAgICBjb25zdCB2YWwgPSAocXVlcmllcy5sZW5ndGggPiAwICYmIGluZGV4ZXMubGVuZ3RoID09PSAwKSA/IE5PVEZPVU5EIDogKHRyLmRhdGFzZXRbdGhpcy5jZWxsaWRuYW1lXSAhPT0gbnVsbCkgPyB0ci5kYXRhc2V0W3RoaXMuY2VsbGlkbmFtZV0gOiB0ci5jZWxsc1tjZWxsaWRdLnRleHRDb250ZW50O1xuICAgICAgICBjb25zdCBpZHggPSBpbmRleGVzLmluZGV4T2YodmFsKTtcbiAgICAgICAgaWYgKGlkeCA8IDApIHRvZ2dsZSh0ciwgdHJ1ZSwgaWR4KTtcbiAgICAgICAgZWxzZSB0b2dnbGUodHIsIGZhbHNlLCBpZHgpO1xuICAgICAgfVxuICAgIH0pO1xuICB9O1xuXG4gIGluaXRTZWFyY2goKSB7XG4gICAgY29uc3QgdG9wID0gdGhpcy53cmFwcGVyLnF1ZXJ5U2VsZWN0b3IodGFibGVzZWxlY3RvcnMudG9wKTtcbiAgICBpZiAoIXRoaXMucGFyYW1zLnNlYXJjaGFibGUgfHwgdG9wID09PSBudWxsKSByZXR1cm47XG4gICAgaWYgKHRoaXMuZ3JpZC5kYXRhLmxlbmd0aCA8IDEwKSByZXR1cm4gdGhpcy50b2dnbGVBZGRPbnMoKTtcbiAgICBlbHNlIHRoaXMudG9nZ2xlQWRkT25zKFt0YWJsZXNlbGVjdG9ycy5zZWFyY2ggKyAnIGlucHV0J10sIGZhbHNlKTtcbiAgICB0aGlzLnNlYXJjaGluZyA9IGZhbHNlO1xuICAgIGNvbnN0IGNlbGxpZCA9IHRoaXMuZ2V0Q2VsbElkKHRoaXMuY2VsbGlkbmFtZSk7XG4gICAgLy8gc2VhcmNoIGl0ZW1zXG4gICAgbGV0IHNlYXJjaGJveCA9IHRvcC5xdWVyeVNlbGVjdG9yKHRhYmxlc2VsZWN0b3JzLnNlYXJjaCk7XG4gICAgaWYgKHNlYXJjaGJveCA9PT0gbnVsbCkge1xuICAgICAgc2VhcmNoYm94ID0gdGhpcy5vYmpUb0VsZW1lbnQoe1xuICAgICAgICBub2RlbmFtZTogJ0RJVicsXG4gICAgICAgIGF0dHJpYnV0ZXM6IHtcbiAgICAgICAgICBjbGFzczogdGFibGVzZWxlY3RvcnMuc2VhcmNoLnN1YnN0cigxKVxuICAgICAgICB9LFxuICAgICAgICBjaGlsZG5vZGVzOiBbe1xuICAgICAgICAgIG5vZGVuYW1lOiAnaW5wdXQnLFxuICAgICAgICAgIGF0dHJpYnV0ZXM6IHtcbiAgICAgICAgICAgIHR5cGU6ICdzZWFyY2gnLFxuICAgICAgICAgICAgbmFtZTogJ3RhYmxlLXNlYXJjaCcsXG4gICAgICAgICAgICBwbGFjZWhvbGRlcjogdGhpcy5sYWJlbHMucGxhY2Vob2xkZXIsXG4gICAgICAgICAgICBjbGFzczogYCR7dGFibGVzZWxlY3RvcnMuaW5wdXQuc3Vic3RyKDEpfSAke2Nzcy5pbnB1dH1gXG4gICAgICAgICAgfVxuICAgICAgICB9XVxuICAgICAgfSk7XG4gICAgICB0b3AuYXBwZW5kQ2hpbGQoc2VhcmNoYm94KTtcbiAgICB9XG4gICAgY29uc3Qgc2VhcmNoaW5wdXQgPSBzZWFyY2hib3gucXVlcnlTZWxlY3RvcignaW5wdXQnKTtcbiAgICBpZiAoIXNlYXJjaGlucHV0KSByZXR1cm47XG4gICAgbGV0IHNlYXJjaHN0cmluZyA9IGBgO1xuICAgIGNvbnN0IHRhYmxlX3NlYXJjaCA9IGRlYm91bmNlKChzZWFyY2hzdHJpbmcsIGNhc2VzZW5zaXRpdmUgPSBmYWxzZSkgPT4ge1xuICAgICAgZnVuY3Rpb24gc2VhcmNoX3N0cmluZyhzdHIsIGNhc2VzZW5zaXRpdmUpIHtcbiAgICAgICAgc3RyID0gKGNhc2VzZW5zaXRpdmUpID8gc3RyIDogc3RyLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgIHJldHVybiBzdHI7XG4gICAgICB9XG5cbiAgICAgIGZ1bmN0aW9uIHNlYXJjaF9xdWVyaWVzKHN0ciwgY2FzZXNlbnNpdGl2ZSkge1xuICAgICAgICBzdHIgPSBzZWFyY2hfc3RyaW5nKHN0ciwgY2FzZXNlbnNpdGl2ZSk7XG4gICAgICAgIGxldCBzdHJzID0gW107XG4gICAgICAgIGxldCBwaHJhc2U7XG4gICAgICAgIHdoaWxlICgocGhyYXNlID0gc3RyLm1hdGNoKC9cIihbXlwiXSspXCIvKSkgIT09IG51bGwpIHtcblxuICAgICAgICAgIHN0cnMucHVzaChwaHJhc2VbMV0pO1xuICAgICAgICAgIHN0ciA9IHN0ci5zdWJzdHJpbmcoMCwgcGhyYXNlLmluZGV4KSArIHN0ci5zdWJzdHJpbmcocGhyYXNlLmluZGV4ICsgcGhyYXNlWzBdLmxlbmd0aCk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gR2V0IHJlbWFpbmluZyBzcGFjZS1zZXBhcmF0ZWQgd29yZHMgKGlmIGFueSlcbiAgICAgICAgc3RyID0gc3RyLnRyaW0oKTtcbiAgICAgICAgaWYgKHN0ci5sZW5ndGgpIHN0cnMgPSBzdHJzLmNvbmNhdChzdHIuc3BsaXQoL1xccysvKSk7XG4gICAgICAgIHJldHVybiBzdHJzO1xuICAgICAgfVxuICAgICAgY29uc3QgcXVlcmllcyA9IHNlYXJjaF9xdWVyaWVzKHNlYXJjaHN0cmluZyk7XG4gICAgICBNb2R1bGVFdmVudEVtaXR0ZXIuZW1pdCh0aGlzLmV2ZW50bmFtZXMuc2VhcmNoLCB7XG4gICAgICAgIHNlYXJjaHN0cmluZzogc2VhcmNoc3RyaW5nLFxuICAgICAgICBxdWVyaWVzOiBxdWVyaWVzXG4gICAgICB9LCB0aGlzLnV1aWQpO1xuICAgICAgbGV0IGRhdGFzID0gdGhpcy5ncmlkLmRhdGEsXG4gICAgICAgIGluZGV4ZXMgPSBbXTtcbiAgICAgIHF1ZXJpZXMuZm9yRWFjaChxcnkgPT4ge1xuICAgICAgICBpbmRleGVzID0gW107XG4gICAgICAgIGRhdGFzID0gZGF0YXMuZmlsdGVyKChkYXRhLCBqKSA9PiB7XG4gICAgICAgICAgY29uc3QgZm91bmQgPSBkYXRhLmZpbHRlcihjZWxsID0+IHtcbiAgICAgICAgICAgIHN3aXRjaCAodHlwZW9mIGNlbGwpIHtcbiAgICAgICAgICAgICAgY2FzZSAnb2JqZWN0JzpcbiAgICAgICAgICAgICAgICBjZWxsID0gKGNlbGwpID8gY2VsbCA6IGBgO1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICBjZWxsID0gSlNPTi5zdHJpbmdpZnkoY2VsbCk7XG4gICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnc2VhcmNoJywgZXJyKTtcbiAgICAgICAgICAgICAgICAgIGNlbGwgPSBgYDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgIGNhc2UgJ2FycmF5JzpcbiAgICAgICAgICAgICAgICBjZWxsID0gY2VsbC5qb2luKCcgJyk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgY2VsbCA9IFN0cmluZyhjZWxsKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiAoKGNhc2VzZW5zaXRpdmUpID8gY2VsbC5pbmRleE9mKHFyeSkgPiAtMSA6IGNlbGwudG9Mb3dlckNhc2UoKS5pbmRleE9mKHFyeSkpID4gLTE7XG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICBpZiAoZm91bmQubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgaWYgKGNlbGxpZCA8IDApIGluZGV4ZXMucHVzaChTdHJpbmcoaikpO1xuICAgICAgICAgICAgZWxzZSBpbmRleGVzLnB1c2goU3RyaW5nKGRhdGFbY2VsbGlkXSkpO1xuICAgICAgICAgICAgcmV0dXJuIGRhdGE7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgICAgTW9kdWxlRXZlbnRFbWl0dGVyLmVtaXQodGhpcy5ldmVudG5hbWVzLnNlYXJjaGVuZCwge1xuICAgICAgICBxdWVyaWVzOiBxdWVyaWVzLFxuICAgICAgICBpbmRleGVzOiBpbmRleGVzLFxuICAgICAgICBjZWxsaWQ6IGNlbGxpZFxuICAgICAgfSwgdGhpcy51dWlkKTtcbiAgICB9LCAzMDApO1xuICAgIGNvbnN0IGRpc3BsYXlfc2VhcmNoID0gKHF1ZXJpZXMsIGluZGV4ZXMsIGNlbGxpZCkgPT4ge1xuICAgICAgdGhpcy5kaXNwbGF5U2VsZWN0ZWQocXVlcmllcywgaW5kZXhlcywgY2VsbGlkKTtcbiAgICB9O1xuICAgIGNvbnN0IGNsZWFyX3NlYXJjaCA9IGRlYm91bmNlKCgpID0+IHtcbiAgICAgIHRoaXMuc2VhcmNoaW5nID0gdHJ1ZTtcbiAgICAgIGNvbnN0IHRycyA9IHRoaXMuZG9tLnF1ZXJ5U2VsZWN0b3JBbGwoJ3Rib2R5IHRyW2hpZGRlbj1cIlwiXScpO1xuICAgICAgdHJzLmZvckVhY2goKHRyLCBpbmRleCkgPT4ge1xuICAgICAgICB0ci5oaWRkZW4gPSBmYWxzZTtcbiAgICAgIH0pO1xuICAgICAgdGhpcy5zZWFyY2hpbmcgPSBmYWxzZTtcbiAgICAgIHNlYXJjaGlucHV0LmNsYXNzTGlzdC5yZW1vdmUoY3NzLndhaXQpO1xuICAgIH0sIDUwMCk7XG5cbiAgICBjb25zdCBzZWFyY2hfaW5wdXQgPSAodmFsdWUpID0+IHtcbiAgICAgIGlmICh2YWx1ZSAhPT0gc2VhcmNoc3RyaW5nKSB7XG4gICAgICAgIHNlYXJjaGlucHV0LmNsYXNzTGlzdC5hZGQoY3NzLndhaXQpO1xuICAgICAgICBzZWFyY2hzdHJpbmcgPSB2YWx1ZTtcbiAgICAgICAgaWYgKHZhbHVlID09PSAnJykge1xuICAgICAgICAgIGNsZWFyX3NlYXJjaCgpO1xuICAgICAgICB9IGVsc2UgaWYgKHZhbHVlLmxlbmd0aCA+IDIpIHtcbiAgICAgICAgICB0YWJsZV9zZWFyY2godmFsdWUpO1xuICAgICAgICB9XG5cbiAgICAgIH1cbiAgICB9XG4gICAgc2VhcmNoaW5wdXQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsIChlKSA9PiB7XG4gICAgICBzZWFyY2hfaW5wdXQoZS50YXJnZXQudmFsdWUpO1xuICAgIH0pO1xuICAgIHNlYXJjaGlucHV0LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xuICAgICAgc2VhcmNoX2lucHV0KGUudGFyZ2V0LnZhbHVlKTtcbiAgICB9KTtcbiAgICBNb2R1bGVFdmVudEVtaXR0ZXIub24odGhpcy5ldmVudG5hbWVzLnNlYXJjaCwgKHJlcSkgPT4ge1xuICAgICAgLy8gIHJlcXVlc3Qge3NlYXJjaHN0cmluZzpzZWFyY2hzdHJpbmcsIHF1ZXJpZXM6cXVlcmllc31cbiAgICAgIGlmICh0aGlzLnNlYXJjaGluZyA9PT0gZmFsc2UpIHtcbiAgICAgICAgaWYgKHRoaXMucGx1Z2lucy5qc0RldGFpbCkgdGhpcy5wbHVnaW5zLmpzRGV0YWlsLmFjdGl2ZURldGFpbChmYWxzZSk7XG4gICAgICB9XG4gICAgICB0aGlzLnNlYXJjaGluZyA9IHRydWU7XG4gICAgfSwgdGhpcy51dWlkKTtcbiAgICBNb2R1bGVFdmVudEVtaXR0ZXIub24odGhpcy5ldmVudG5hbWVzLnNlYXJjaGVuZCwgKHJlcSkgPT4ge1xuICAgICAgLy8gcmVxIHtxdWVyaWVzOnF1ZXJpZXMsaW5kZXhlczogaW5kZXhlcywgY2VsbGlkOmNlbGxpZH1cbiAgICAgIGRpc3BsYXlfc2VhcmNoKHJlcS5xdWVyaWVzLCByZXEuaW5kZXhlcywgcmVxLmNlbGxpZCk7XG4gICAgICBzZWFyY2hpbnB1dC5jbGFzc0xpc3QucmVtb3ZlKGNzcy53YWl0KTtcbiAgICAgIHRoaXMuc2VhcmNoaW5nID0gZmFsc2U7XG4gICAgfSwgdGhpcy51dWlkKTtcbiAgICBNb2R1bGVFdmVudEVtaXR0ZXIub24odGhpcy5ldmVudG5hbWVzLnVwZGF0ZSwgKCkgPT4ge1xuICAgICAgaWYgKHRoaXMuc2VhcmNoaW5nID09PSBmYWxzZSkge1xuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICByZWZyZXNoX2RldGFpbHMoKTtcbiAgICAgICAgfSwgMzAwKTtcbiAgICAgIH1cbiAgICB9LCB0aGlzLnV1aWQpO1xuICAgIHRoaXMudG9nZ2xlQWRkT25zKFt0YWJsZXNlbGVjdG9ycy5zZWFyY2ggKyAnIGlucHV0J10sIHRydWUpO1xuICB9XG4gIGluaXRTZWxlY3QoY29udGFpbmVyKSB7XG4gICAgY29uc3QgaW5wdXRzID0gdGhpcy5kb20ucXVlcnlTZWxlY3RvckFsbCgnaW5wdXRbbmFtZV49XCInICsgdGhpcy51dWlkICsgJ1wiXScpO1xuICAgIGlmIChpbnB1dHMubGVuZ3RoID09PSAwKSByZXR1cm47XG4gICAgY29uc3QgaW5wdXRuYW1lID0gaW5wdXRzWzBdLm5hbWU7XG4gICAgbGV0IHNlbGVjdGFjdGlvbiA9IGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCcuJyArIHRhYmxlY3NzLnNlbGVjdGFjdGlvbik7XG4gICAgaWYgKCFzZWxlY3RhY3Rpb24pIHJldHVybjtcbiAgICBkb2N1bWVudC5ib2R5LmFwcGVuZChzZWxlY3RhY3Rpb24pO1xuICAgIHNlbGVjdGFjdGlvbi5xdWVyeVNlbGVjdG9yKCdhJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4ge1xuICAgICAgbGV0IHZhbHMgPSBbXTtcbiAgICAgIGlucHV0cy5mb3JFYWNoKGlucHV0ID0+IHtcbiAgICAgICAgaWYgKGlucHV0LmNoZWNrZWQpIHZhbHMucHVzaChpbnB1dC52YWx1ZSk7XG4gICAgICB9KTtcbiAgICAgIGlmIChzZWxlY3RhY3Rpb24uZGF0YXNldC5pbnB1dCkge1xuICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChzZWxlY3RhY3Rpb24uZGF0YXNldC5pbnB1dCkudmFsdWUgPSB2YWxzLmpvaW4oJywnKTtcbiAgICAgICAgaWYgKHNlbGVjdGFjdGlvbi5kYXRhc2V0LmZvcm0pIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHNlbGVjdGFjdGlvbi5kYXRhc2V0LmZvcm0pLnN1Ym1pdCgpO1xuICAgICAgfSBlbHNlIGUuY3VycmVudFRhcmdldC5ocmVmID0gdGhpcy5wYXJhbXMub25zZWxlY3QgKyBlbmNvZGVVUkkodmFscy5qb2luKCcsJykpO1xuXG4gICAgfSk7XG4gICAgY29uc3QgY2xvc2UgPSBzZWxlY3RhY3Rpb24ucXVlcnlTZWxlY3RvcignW2RhdGEtZGlzbWlzc10nKTtcbiAgICBpZiAoY2xvc2UpIGNsb3NlLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgIGUuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCk7XG4gICAgICBwb3B1cF9zZWxlY3RlZChudWxsLCBudWxsKTtcbiAgICB9KTtcblxuICAgIGNvbnN0IHBvcHVwX3NlbGVjdGVkID0gKHRvcCA9IG51bGwsIGxlZnQgPSBudWxsLCBmb3JjZWNsb3NlID0gZmFsc2UpID0+IHtcbiAgICAgIGlmIChzZWxlY3RhY3Rpb24uZGF0YXNldC5jbG9zZSkge1xuICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZChzZWxlY3RhY3Rpb24pO1xuICAgICAgICBjbG9zZS5jbGFzc0xpc3QucmVtb3ZlKHRhYmxlY3NzLmhpZGRlbik7XG4gICAgICAgIHNlbGVjdGFjdGlvbi5jbGFzc0xpc3QuYWRkKHRhYmxlY3NzLmFic2lucHV0KTtcbiAgICAgIH1cbiAgICAgIGlmICh0b3AgIT09IG51bGwgJiYgbGVmdCAhPT0gbnVsbCkge1xuICAgICAgICBzZWxlY3RhY3Rpb24uY2xhc3NMaXN0LnJlbW92ZShjc3MuaGlkZSk7XG4gICAgICAgIHNlbGVjdGFjdGlvbi5zdHlsZS50b3AgPSB0b3AgKyAncHgnO1xuICAgICAgICBzZWxlY3RhY3Rpb24uc3R5bGUubGVmdCA9IGxlZnQgKyAncHgnO1xuXG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpZiAoZm9yY2VjbG9zZSA9PT0gdHJ1ZSkge1xuICAgICAgICAgIHNlbGVjdGFjdGlvbi5jbGFzc0xpc3QuYWRkKGNzcy5oaWRlKTtcbiAgICAgICAgICBkZWxldGUgc2VsZWN0YWN0aW9uLmRhdGFzZXQuY2xvc2U7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgc2VsZWN0YWN0aW9uLmRhdGFzZXQuY2xvc2UgPSB0cnVlO1xuICAgICAgICAgIGNsb3NlLmNsYXNzTGlzdC5hZGQodGFibGVjc3MuaGlkZGVuKTtcbiAgICAgICAgICBjb25zdCB0b3B0YWJsZSA9IHRoaXMud3JhcHBlci5xdWVyeVNlbGVjdG9yKHRhYmxlc2VsZWN0b3JzLnRvcCkgPyB0aGlzLndyYXBwZXIucXVlcnlTZWxlY3Rvcih0YWJsZXNlbGVjdG9ycy50b3ApIDogdGhpcy53cmFwcGVyO1xuICAgICAgICAgIHRvcHRhYmxlLnByZXBlbmQoc2VsZWN0YWN0aW9uKTtcbiAgICAgICAgICBzZWxlY3RhY3Rpb24uY2xhc3NMaXN0LnJlbW92ZSh0YWJsZWNzcy5hYnNpbnB1dCk7XG5cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICBpbnB1dHMuZm9yRWFjaChpbnB1dCA9PiB7XG4gICAgICBpbnB1dC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCAoZSkgPT4ge1xuICAgICAgICBpZiAoaW5wdXQuY2hlY2tlZCkgcG9wdXBfc2VsZWN0ZWQoaW5wdXQub2Zmc2V0VG9wLCBpbnB1dC5vZmZzZXRMZWZ0KTtcbiAgICAgICAgZWxzZSBpZiAodGhpcy5kb20ucXVlcnlTZWxlY3RvckFsbCgnaW5wdXRbbmFtZV49XCInICsgdGhpcy51dWlkICsgJ1wiXTpjaGVja2VkJykubGVuZ3RoID09PSAwKSBwb3B1cF9zZWxlY3RlZChudWxsLCBudWxsLCB0cnVlKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICAgIGlmICh0aGlzLmRvbS5xdWVyeVNlbGVjdG9yQWxsKCdpbnB1dFtuYW1lXj1cIicgKyB0aGlzLnV1aWQgKyAnXCJdOmNoZWNrZWQnKS5sZW5ndGggPiAwKSB7XG4gICAgICBzZWxlY3RhY3Rpb24uY2xhc3NMaXN0LnJlbW92ZShjc3MuaGlkZSk7XG4gICAgICBwb3B1cF9zZWxlY3RlZChudWxsLCBudWxsKTtcbiAgICB9XG4gIH1cbiAgYXN5bmMgaW5pdERldGFpbHMoKSB7IC8vIFRPRE8gOiBnZW5lcmljXG4gICAgLy8gYWJvdXQgLSBvbmUgZGl2IHRvIGRpc3BsYXkgY2VsbCBkZXRhaWxzIG1ha2UgaXQgYXBwZWFyIGFzIHRhYmxlIHJvdyBleHBhbmRpbmdcbiAgICBjb25zdCB3cmFwcGVyID0gdGhpcy53cmFwcGVyO1xuICAgIGNvbnN0IGFib3V0ID0gd3JhcHBlci5xdWVyeVNlbGVjdG9yKCcjJyArIHRhYmxlY3NzLnRpcGlubGluZSkgPyB3cmFwcGVyLnF1ZXJ5U2VsZWN0b3IoJyMnICsgdGFibGVjc3MudGlwaW5saW5lKSA6IHRhYmxlY3NzLnRpcGlubGluZTtcbiAgICBpZiAoIXRoaXMucGx1Z2lucy5Kc0RldGFpbCkge1xuICAgICAgY29uc3Qge1xuICAgICAgICBKc0RldGFpbFxuICAgICAgfSA9IGF3YWl0XG4gICAgICBpbXBvcnQoJy4uL21vZHVsZXMvanMtZGV0YWlsLmpzJyk7XG4gICAgICB0aGlzLnBsdWdpbnMuSnNEZXRhaWwgPSBKc0RldGFpbDtcbiAgICB9XG5cbiAgICBpZiAoIXRoaXMucGx1Z2lucy5Kc0FjY29yZGlvbikge1xuICAgICAgY29uc3Qge1xuICAgICAgICBKc0FjY29yZGlvblxuICAgICAgfSA9IGF3YWl0IGltcG9ydCgnLi4vbW9kdWxlcy9qcy1hY2NvcmRpb24uanMnKTtcbiAgICAgIHRoaXMucGx1Z2lucy5Kc0FjY29yZGlvbiA9IEpzQWNjb3JkaW9uO1xuICAgIH1cbiAgICBjb25zdCBqc0RldGFpbCA9IHRoaXMucGx1Z2lucy5Kc0RldGFpbCh7XG4gICAgICB3YWl0ZGl2OiB0aGlzLndhaXRkaXZcbiAgICB9KTtcblxuICAgIGNvbnN0IGRldGFpbCA9IGpzRGV0YWlsLmFwcGx5VG8oYWJvdXQsIHdyYXBwZXIpOyAvLyBzcGVjaWZpYyB0byBhYm91dCBkZXRhaWxzIGluIHRhYmxlXG4gICAgLy8gaGlkZSAvIHNob3cgZGlzYWJsZSBkZXRhaWxzIHpvbmVcbiAgICBjb25zdCBjYWxsYmFja2Nsb3NlID0gKGVsLCBjYWxsYmFjayA9IG51bGwpID0+IHtcbiAgICAgIGNvbnN0IGN1cnJlbnQgPSBqc0RldGFpbC5hY3RpdmVEZXRhaWwoZmFsc2UpO1xuICAgICAgaWYgKGNhbGxiYWNrKSBjYWxsYmFjaygpO1xuICAgIH1cblxuICAgIGNvbnN0IGNhbGxiYWNrb3BlbiA9IChlbCwgY2FsbGJhY2sgPSBudWxsKSA9PiB7XG4gICAgICBsZXQgY3VycmVudCA9IGpzRGV0YWlsLmFjdGl2ZURldGFpbCh0cnVlKTtcbiAgICAgIGlmIChjdXJyZW50ICYmIGN1cnJlbnQgPT09IGVsKSB7XG4gICAgICAgIGN1cnJlbnQgPSBqc0RldGFpbC5leHBhbmREZXRhaWwoZWwpO1xuICAgICAgICBpZiAoY2FsbGJhY2spIGNhbGxiYWNrKCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpZiAoY3VycmVudCkgY3VycmVudC5xdWVyeVNlbGVjdG9yKCdzdW1tYXJ5JykuY2xpY2soKTtcbiAgICAgICAgY29uc3QgdXJsID0gdGhpcy5wYXJhbXMuZGV0YWlsc3VybCArIGVsLmRhdGFzZXQuaWQgKyAnPycgK1xuICAgICAgICAgIG5ldyBVUkxTZWFyY2hQYXJhbXMoe1xuICAgICAgICAgICAgcGFydGlhbDogdHJ1ZVxuICAgICAgICAgIH0pO1xuICAgICAgICBjdXJyZW50ID0ganNEZXRhaWwuYWN0aXZlRGV0YWlsKHRydWUpO1xuICAgICAgICAvLyBhcHBlbmQgdG8gY2VsbCBkZXRhaWxzIGFuZCBkaXNwbGF5XG4gICAgICAgIGZldGNoKHVybCwgZmV0Y2hTZXR0aW5ncygpKS50aGVuKHJlc3BvbnNlID0+IHJlc3BvbnNlLnRleHQoKSkudGhlbihodG1sID0+IHtcbiAgICAgICAgICBjdXJyZW50ID0ganNEZXRhaWwuZXhwYW5kRGV0YWlsKGVsLCBodG1sKTtcbiAgICAgICAgICBpZiAoY2FsbGJhY2spIGNhbGxiYWNrKCk7XG4gICAgICAgIH0pLmNhdGNoKGVyciA9PiB7XG4gICAgICAgICAgY29uc29sZS5sb2coJ3JlcXVlc3QnLCBlcnIpO1xuICAgICAgICB9KVxuICAgICAgfVxuXG4gICAgfVxuXG4gICAgY29uc3QgcmVmcmVzaF9kZXRhaWxzID0gKCkgPT4ge1xuICAgICAgY29uc3QgZGV0YWlscyA9IHRoaXMuZG9tLnF1ZXJ5U2VsZWN0b3JBbGwodGFibGVzZWxlY3RvcnMuZGV0YWlscyk7XG4gICAgICBpZiAoIWRldGFpbHMpIHJldHVybjtcbiAgICAgIC8qZGV0YWlscy5mb3JFYWNoKGl0ZW0gPT4ge1xuICAgICAgICBpZiAoIWl0ZW0uZGF0YXNldC5pZCkgcmV0dXJuO1xuICAgICAgICBpdGVtID1uZXcgdGhpcy5wbHVnaW5zLkpzQWNjb3JkaW9uKGl0ZW0sIGNhbGxiYWNrb3BlbiwgY2FsbGJhY2tjbG9zZSwgZGV0YWlsKTtcbiAgICAgIH0pOyovXG4gICAgICB0aGlzLnBsdWdpbnMuSnNBY2NvcmRpb24uYXBwbHlUbyhkZXRhaWxzLCBjYWxsYmFja29wZW4sIGNhbGxiYWNrY2xvc2UsIGRldGFpbCk7XG4gICAgfVxuICAgIHJlZnJlc2hfZGV0YWlscygpO1xuICB9XG5cbiAgaW5pdEFsdGVybmF0ZVNvcnQoY29scykge1xuXG4gICAgbGV0IHRkY29scyA9IFtdO1xuICAgIGNvbHMuZm9yRWFjaChjb2wgPT4ge1xuICAgICAgY29uc3QgdGRjb2wgPSBjb2wuY2xvc2VzdCgndGgnKTtcbiAgICAgIE9iamVjdC5lbnRyaWVzKGNvbC5kYXRhc2V0KS5mb3JFYWNoKChbaywgdl0pID0+IHtcbiAgICAgICAgdGRjb2wuZGF0YXNldFtrXSA9IHY7XG4gICAgICAgIGNvbC5jbGFzc0xpc3QuYWRkKCdpbmxpbmUtYmxvY2snKVxuICAgICAgfSk7XG4gICAgICB0ZGNvbHMucHVzaCh0ZGNvbCk7XG4gICAgfSk7XG4gICAgY29scyA9IHRkY29scztcbiAgICAvLyBlbmQgZml4XG5cbiAgICBsZXQgY29sdG9zb3J0O1xuICAgIGNvbnN0IHNvcnRhbHRlcm5hdGUgPSAoY29sKSA9PiB7XG4gICAgICBsZXQgdG9kaXI7XG4gICAgICAvLyBrZWVwIHRoZSBzYW1lIGRpciBpZiBzb3J0IG9uIGNvbCBjaGFuZ2VzXG4gICAgICBjb25zdCBhc2MgPSBjb2wuY2xhc3NMaXN0LmNvbnRhaW5zKHRhYmxlY3NzLmFzY2VuZGluZyk7XG4gICAgICBjb25zdCBkZXNjID0gY29sLmNsYXNzTGlzdC5jb250YWlucyh0YWJsZWNzcy5kZXNjZW5kaW5nKTtcbiAgICAgIGlmIChwYXJzZUludChjb2wuZGF0YXNldC5zb3J0YWN0aXZlKSA9PT0gcGFyc2VJbnQoY29sdG9zb3J0KSkge1xuICAgICAgICB0b2RpciA9IChhc2MpID8gJ2Rlc2MnIDogKChkZXNjKSA/ICdhc2MnIDogJ2FzYycpO1xuICAgICAgfSBlbHNlIHRvZGlyID0gKGFzYykgPyAnYXNjJyA6IChkZXNjKSA/ICdkZXNjJyA6ICdhc2MnO1xuICAgICAgdGhpcy5zb3J0Q29sdW1uKGNvbCwgY29sdG9zb3J0LCB0b2Rpcik7XG4gICAgfVxuICAgIGNvbHMuZm9yRWFjaChjb2wgPT4ge1xuICAgICAgY29uc3QgYWx0c29ydCA9IChjb2wuZGF0YXNldC5hbHRzb3J0KSA/IGNvbC5kYXRhc2V0LmFsdHNvcnQuc3BsaXQoJywnKSA6IG51bGw7XG4gICAgICBpZiAoIWFsdHNvcnQpIHJldHVybjtcbiAgICAgIGNvbnN0IGNzc3NvcnRlciA9IGNvbC5xdWVyeVNlbGVjdG9yKHRhYmxlc2VsZWN0b3JzLnNvcnRlcik7XG4gICAgICBpZiAoY3Nzc29ydGVyKSBjc3Nzb3J0ZXIuY2xhc3NMaXN0LmFkZCh0YWJsZWNzcy5kaXNhYmxlZCk7XG4gICAgICBjb25zdCBjb250cm9sID0gY29sLnF1ZXJ5U2VsZWN0b3IodGFibGVzZWxlY3RvcnMuc29ydG9uKTtcbiAgICAgIC8vIHByZXZlbnRzIGltYnJpY2F0ZWQgbGlua3NcbiAgICAgIGNvbC5hcHBlbmQoY29udHJvbCk7XG4gICAgICBjb25zdCB0cmlnZ2VycyA9IGNvbC5xdWVyeVNlbGVjdG9yQWxsKCdbcm9sZT1cImJ1dHRvblwiXScpO1xuXG4gICAgICBjb2wuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4ge1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIHNvcnRhbHRlcm5hdGUoY29sKTtcbiAgICAgIH0sIGZhbHNlKTtcbiAgICAgIGNvbnN0IGNoYW5nZWNvbHRvc29ydCA9IChjbCwgaW5kZXgpID0+IHtcbiAgICAgICAgaWYgKGluZGV4ID09PSAwKSBjb2x0b3NvcnQgPSB0aGlzLmdyaWQuY29sdW1ucy5maW5kSW5kZXgoY29sdW1uID0+IChjb2x1bW4uaW5kZXggPT09IGNsLmNlbGxJbmRleCkpO1xuICAgICAgICBlbHNlIGNvbHRvc29ydCA9IHRoaXMuZ3JpZC5jb2x1bW5zLmZpbmRJbmRleChjb2x1bW4gPT4gKGNvbHVtbi5uYW1lID09PSBhbHRzb3J0W2luZGV4IC0gMV0pKTtcbiAgICAgIH1cbiAgICAgIGNvbC5kYXRhc2V0LnNvcnRhY3RpdmUgPSBjb2wuY2VsbEluZGV4O1xuICAgICAgdHJpZ2dlcnMuZm9yRWFjaCgodHJpZ2dlciwgaW5kZXgpID0+IHtcbiAgICAgICAgdHJpZ2dlci5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7XG4gICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgIGNvbnN0IGFjdGl2ZSA9IGUuY3VycmVudFRhcmdldC5wYXJlbnRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy4nICsgY3NzLmFjdGl2ZSk7XG4gICAgICAgICAgaWYgKGFjdGl2ZSkgYWN0aXZlLmNsYXNzTGlzdC5yZW1vdmUoY3NzLmFjdGl2ZSk7XG4gICAgICAgICAgZS5jdXJyZW50VGFyZ2V0LmNsYXNzTGlzdC5hZGQoY3NzLmFjdGl2ZSk7XG4gICAgICAgICAgY2hhbmdlY29sdG9zb3J0KGNvbCwgaW5kZXgpO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgICAgaWYgKGNvbC5kYXRhc2V0LnRpcCkge1xuXG4gICAgICAgIE9iamVjdC52YWx1ZXModGhpcy5kb20ucm93cykuZm9yRWFjaCgocm93LCBpbmRleCkgPT4ge1xuICAgICAgICAgIGlmIChpbmRleCA9PT0gMCkgcmV0dXJuO1xuICAgICAgICAgIGNvbnN0IGNvbHRpcCA9IHRoaXMuZ3JpZC5jb2x1bW5zLmZpbmRJbmRleChjb2x1bW4gPT4gKGNvbHVtbi5uYW1lID09PSBhbHRzb3J0W3BhcnNlSW50KGNvbC5kYXRhc2V0LnRpcCkgLSAxXSkpO1xuXG4gICAgICAgICAgaWYgKHJvdy5jZWxscy5sZW5ndGggPT09IDAgfHwgY29sdGlwID09PSBjb2wuY2VsbEluZGV4KSByZXR1cm47XG4gICAgICAgICAgcm93LmNlbGxzW2NvbC5jZWxsSW5kZXhdLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZW50ZXInLCAoZSkgPT4ge1xuXG4gICAgICAgICAgICBjb25zdCB0aXAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgICAgIHRpcC5zZXRBdHRyaWJ1dGUoJ2NsYXNzJywgdGFibGVjc3MudGlwb3Zlcik7XG4gICAgICAgICAgICB0aXAuaW5uZXJIVE1MID0gcm93LmNlbGxzW2NvbHRpcF0uaW5uZXJIVE1MO1xuICAgICAgICAgICAgZS5jdXJyZW50VGFyZ2V0LmFwcGVuZCh0aXApO1xuICAgICAgICAgIH0pO1xuICAgICAgICAgIHJvdy5jZWxsc1tjb2wuY2VsbEluZGV4XS5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW91dCcsIChlKSA9PiB7XG4gICAgICAgICAgICBjb25zdCB0aXAgPSBlLmN1cnJlbnRUYXJnZXQucXVlcnlTZWxlY3Rvcih0YWJsZXNlbGVjdG9ycy50aXBvdmVyKTtcbiAgICAgICAgICAgIGlmICh0aXApIHRpcC5yZW1vdmUoKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICBtYWtlRXhwYW5kYWJsZShjb250YWluZXIpIHtcbiAgICBpZiAoY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJ3RhYmxlJykub2Zmc2V0SGVpZ2h0IDwgY29udGFpbmVyLm9mZnNldEhlaWdodCkgcmV0dXJuO1xuICAgIGNvbnN0IGJ0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIGJ0bi5jbGFzc0xpc3QuYWRkKHRhYmxlY3NzLmJ1dHRvbmV4cGFuZCk7XG4gICAgYnRuLmNsYXNzTGlzdC5hZGQodGFibGVjc3MuYm9yZGVydCk7XG4gICAgYnRuLnRpdGxlID0gdGhpcy5wYXJhbXMuZXhwYW5kO1xuICAgIGJ0bi5pbm5lckhUTUwgPSBgPHNwYW4gY2xhc3M9XCJzbWFsbC1jYXBzIGJsb2NrIG14LWF1dG8gcC0wXCI+JHt0aGlzLnBhcmFtcy5leHBhbmR9PC9zcGFuPjxpIGNsYXNzPVwiY2xlYXItYm90aCBwLTAgbXgtYXV0byBpY29uIGljb24tY2hldnJvbi1kb3duIGhvdmVyOmZpbGwtc2Vjb25kYmx1ZS01MDBcIj48L2k+PHNwYW4gY2xhc3M9XCJzbWFsbC1jYXBzIGJsb2NrIG14LWF1dG8gcC0wIGhpZGRlblwiPiR7XG4gICAgICAgICAgICAgICAgICB0aGlzLnBhcmFtcy5zaHJpbmt9PC9zcGFuPmA7XG4gICAgY29udGFpbmVyLnBhcmVudEVsZW1lbnQuaW5zZXJ0QmVmb3JlKGJ0biwgY29udGFpbmVyLm5leHRFbGVtZW50U2libGluZyk7XG4gICAgY29udGFpbmVyLmNsYXNzTGlzdC5hZGQodGFibGVjc3Mub3ZlcmZsb3d5aGlkZGVuKTtcbiAgICBjb250YWluZXIuY2xhc3NMaXN0LnJlbW92ZSh0YWJsZWNzcy5tYXh0YWJzdGF0aCk7XG4gICAgY29udGFpbmVyLnBhcmVudEVsZW1lbnQuc3R5bGUuaGVpZ2h0ID0gJ2F1dG8nO1xuICAgIGNvbnN0IGggPSBwYXJzZUludCh0aGlzLndyYXBwZXIucXVlcnlTZWxlY3RvcigndGJvZHkgdHInKS5vZmZzZXRIZWlnaHQpICogKCh0aGlzLnBhcmFtcy5tYXhyb3dzKSA/IHRoaXMucGFyYW1zLm1heHJvd3MgOiAyMCk7XG4gICAgY29udGFpbmVyLmNsYXNzTGlzdC5hZGQoJ21heC1oLVsnICsgaCArICdweF0nKTtcbiAgICBjb250YWluZXIuc3R5bGUuaGVpZ2h0ID0gaCArICdweCc7XG4gICAgYnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtcbiAgICAgIGNvbnN0IGlzaGlkZGVuID0gY29udGFpbmVyLmNsYXNzTGlzdC5jb250YWlucyh0YWJsZWNzcy5vdmVyZmxvd3loaWRkZW4pO1xuICAgICAgY29uc3QgbWFrZV9leHBhbmQgPSBkZWJvdW5jZSgoKSA9PiB7XG4gICAgICAgIGJ0bi5jbGFzc0xpc3QudG9nZ2xlKHRhYmxlY3NzLmJvcmRlcnQpO1xuICAgICAgICBidG4uY2xhc3NMaXN0LnRvZ2dsZSh0YWJsZWNzcy5ib3JkZXJiKTtcbiAgICAgICAgY29uc3QgaWNvID0gYnRuLnF1ZXJ5U2VsZWN0b3IoJ2knKTtcbiAgICAgICAgaWNvLmNsYXNzTGlzdC50b2dnbGUodGFibGVjc3MuaWNvY2hldnJvbmRvd24pO1xuICAgICAgICBpY28uY2xhc3NMaXN0LnRvZ2dsZSh0YWJsZWNzcy5pY29uY2hldnJvbnVwKTtcbiAgICAgICAgY29udGFpbmVyLmNsYXNzTGlzdC50b2dnbGUodGFibGVjc3Mub3ZlcmZsb3d5aGlkZGVuKTtcbiAgICAgICAgY29udGFpbmVyLmNsYXNzTGlzdC50b2dnbGUoJ21heC1oLVsnICsgaCArICdweF0nKTtcbiAgICAgICAgYnRuLnF1ZXJ5U2VsZWN0b3JBbGwoJ3NwYW4nKS5mb3JFYWNoKHNwYW4gPT4ge1xuICAgICAgICAgIHNwYW4uY2xhc3NMaXN0LnRvZ2dsZSh0YWJsZWNzcy5oaWRkZW4pO1xuICAgICAgICB9KTtcbiAgICAgICAgaWYgKGlzaGlkZGVuKSBjb250YWluZXIuc3R5bGUuaGVpZ2h0ID0gaCArICdweCc7XG4gICAgICAgIGVsc2UgY29udGFpbmVyLnN0eWxlLmhlaWdodCA9ICdhdXRvJztcbiAgICAgIH0sIDEwMCk7XG4gICAgICBtYWtlX2V4cGFuZCgpO1xuICAgIH0pO1xuICB9XG4gIG1ha2VFeHBvcnRhYmxlKGNvbnRhaW5lcikge1xuICAgIGNvbnN0IGJ0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIGJ0bi5jbGFzc0xpc3QuYWRkKHRhYmxlc2VsZWN0b3JzLmV4cG9ydC5zbGljZSgxKSk7XG4gICAgYnRuLmNsYXNzTGlzdC5hZGQoJ2lzLXBpY2snKTtcbiAgICBidG4uaW5uZXJIVE1MID0gYDxpIGNsYXNzPVwiaWNvbiBpY29uLWFycm93LWRvd24tb24tc3F1YXJlXCI+PC9pPjxzcGFuPiR7KCh0aGlzLnBhcmFtcy5leHBvcnRsYWJlbCkgPyB0aGlzLnBhcmFtcy5leHBvcnRsYWJlbCA6ICdleHBvcnQgc3RhdGlzdGljcyAnKX08L3NwYW4+YDtcbiAgICB0aGlzLndyYXBwZXIucHJlcGVuZChidG4pO1xuICAgIGNvbnN0IGNvbHVtbnMgPSB0aGlzLmdyaWQuY29sdW1ucztcbiAgICBsZXQgZXhjbHVkZV9jb2x1bW5zID0gW107XG4gICAgdGhpcy5ncmlkLmNvbHVtbnMuZm9yRWFjaCgoY29sdW1uLCBpbmRleCkgPT4ge1xuICAgICAgaWYgKGNvbHVtbi5uYW1lID09PSAnc2VsZWN0JykgZXhjbHVkZV9jb2x1bW5zLnB1c2goY29sdW1uLmluZGV4KTtcbiAgICB9KTtcbiAgICBidG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBhc3luYyAoZSkgPT4ge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgaWYgKCF0aGlzLnBsdWdpbnMuZXhwb3J0Q1NWKSB7XG4gICAgICAgIGNvbnN0IHtcbiAgICAgICAgICBleHBvcnRDU1YgLy8gb3IgZXhwb3J0SlNPTiwgZXhwb3J0U1FMXG4gICAgICAgIH0gPSBhd2FpdFxuICAgICAgICBpbXBvcnQoXCIuLi9tb2R1bGVzL2V4cG9ydC1jc3YuanNcIik7XG5cbiAgICAgICAgdGhpcy5wbHVnaW5zLmV4cG9ydENTViA9IGV4cG9ydENTVjtcbiAgICAgIH1cbiAgICAgIGxldCBzdHIgPSB0aGlzLnBsdWdpbnMuZXhwb3J0Q1NWKHRoaXMsIHtcbiAgICAgICAgZG93bmxvYWQ6IGZhbHNlLFxuICAgICAgICBsaW5lZGVsaW1pdGVyOiBcIlxcblwiLFxuICAgICAgICBjb2x1bW5kZWxpbWl0ZXI6IFwiXFx0XCIsXG4gICAgICAgIHNraXBjb2x1bW5zOiBleGNsdWRlX2NvbHVtbnNcbiAgICAgIH0pO1xuICAgICAgc3RyID0gZW5jb2RlVVJJKGBkYXRhOnRleHQvdHN2O2NoYXJzZXQ9dXRmLTgsJHtzdHJ9YCk7XG5cbiAgICAgIGRvd25sb2FkX3VybChzdHIsICgoY29udGFpbmVyLmlkKSA/IGNvbnRhaW5lci5pZCA6ICdzdGF0c19wcm9qJykgKyAnLnRzdicpO1xuXG4gICAgfSk7XG4gIH1cbiAgaW5pdFRpcHMoKSB7XG4gICAgLy8gc2hvdyBiaWcgY2VsbCBjb250ZW50XG4gICAgbGV0IGN1cnJlbnQgPSBudWxsO1xuICAgIHRoaXMuZG9tLnF1ZXJ5U2VsZWN0b3JBbGwodGFibGVzZWxlY3RvcnMudGlwKS5mb3JFYWNoKHRpcCA9PiB7XG4gICAgICB0aXAuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4ge1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGUuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCk7XG4gICAgICAgIGNvbnN0IHBhcmVudCA9IGUudGFyZ2V0LnBhcmVudEVsZW1lbnQ7XG4gICAgICAgIGlmIChjdXJyZW50ICE9PSBudWxsKSBjdXJyZW50LmNsYXNzTGlzdC5yZW1vdmUodGFibGVjc3Muc2hvd2Z1bGwpO1xuICAgICAgICBpZiAoY3VycmVudCAhPT0gcGFyZW50KSB7XG4gICAgICAgICAgcGFyZW50LmNsYXNzTGlzdC5hZGQodGFibGVjc3Muc2hvd2Z1bGwpO1xuICAgICAgICAgIGN1cnJlbnQgPSBwYXJlbnQ7XG4gICAgICAgIH0gZWxzZSBjdXJyZW50ID0gbnVsbDtcblxuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cbiAgdG9nZ2xlQWRkT25zKGxpc3QgPSBudWxsLCBvbiA9IGZhbHNlKSB7XG4gICAgbGlzdCA9IChsaXN0KSA/IGxpc3QgOiBbdGFibGVzZWxlY3RvcnMuc2VhcmNoICsgJyBpbnB1dCcsIHRhYmxlc2VsZWN0b3JzLmV4cG9ydF07XG4gICAgY29uc3QgYWRkb25zID0gW107XG4gICAgbGV0IGFkZG9uO1xuICAgIGxpc3QuZm9yRWFjaChhZGRvbiA9PiB7XG4gICAgICBhZGRvbiA9IHRoaXMud3JhcHBlci5xdWVyeVNlbGVjdG9yKGFkZG9uKTtcbiAgICAgIGlmIChhZGRvbikge1xuICAgICAgICBpZiAob24pIGFkZG9uLmNsYXNzTGlzdC5yZW1vdmUoY3NzLmhpZGUpO1xuICAgICAgICBlbHNlIGFkZG9uLmNsYXNzTGlzdC5hZGQoY3NzLmhpZGUpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbn0iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/modules/table-component.js\n")},"./src/modules/text-highlight.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   TextHighlight: () => (/* binding */ TextHighlight)\n/* harmony export */ });\nfunction textHighlight() {\n  const highlight = (CSS.highlights) ? new Highlight() : null;\n\n  function applyTo(item, start, end) {\n    if (highlight) {\n      const textnode = item.textNode;\n      const range = new Range();\n      range.setStart(textnode, start);\n      range.setEnd(textnode, end);\n      highlight.add(range);\n    }\n  }\n  return {\n    applyTo\n  }\n}\nconst TextHighlight = textHighlight();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvbW9kdWxlcy90ZXh0LWhpZ2hsaWdodC5qcyIsIm1hcHBpbmdzIjoiOzs7O0FBQUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vc3JjL21vZHVsZXMvdGV4dC1oaWdobGlnaHQuanM/OGZhOCJdLCJzb3VyY2VzQ29udGVudCI6WyJmdW5jdGlvbiB0ZXh0SGlnaGxpZ2h0KCkge1xuICBjb25zdCBoaWdobGlnaHQgPSAoQ1NTLmhpZ2hsaWdodHMpID8gbmV3IEhpZ2hsaWdodCgpIDogbnVsbDtcblxuICBmdW5jdGlvbiBhcHBseVRvKGl0ZW0sIHN0YXJ0LCBlbmQpIHtcbiAgICBpZiAoaGlnaGxpZ2h0KSB7XG4gICAgICBjb25zdCB0ZXh0bm9kZSA9IGl0ZW0udGV4dE5vZGU7XG4gICAgICBjb25zdCByYW5nZSA9IG5ldyBSYW5nZSgpO1xuICAgICAgcmFuZ2Uuc2V0U3RhcnQodGV4dG5vZGUsIHN0YXJ0KTtcbiAgICAgIHJhbmdlLnNldEVuZCh0ZXh0bm9kZSwgZW5kKTtcbiAgICAgIGhpZ2hsaWdodC5hZGQocmFuZ2UpO1xuICAgIH1cbiAgfVxuICByZXR1cm4ge1xuICAgIGFwcGx5VG9cbiAgfVxufVxuY29uc3QgVGV4dEhpZ2hsaWdodCA9IHRleHRIaWdobGlnaHQoKTtcbmV4cG9ydCB7XG4gIFRleHRIaWdobGlnaHRcbn07Il0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/modules/text-highlight.js\n")},"?4f7e":()=>{}}]);