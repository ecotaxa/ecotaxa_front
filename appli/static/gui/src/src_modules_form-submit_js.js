/*! For license information please see src_modules_form-submit_js.js.LICENSE.txt */
"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["src_modules_form-submit_js"],{"./src/modules/form-submit.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   FormSubmit: () => (/* binding */ FormSubmit)\n/* harmony export */ });\n/* harmony import */ var dompurify__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! dompurify */ \"./node_modules/dompurify/dist/purify.js\");\n/* harmony import */ var dompurify__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(dompurify__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _modules_utils_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../modules/utils.js */ \"./src/modules/utils.js\");\n\n\nconst formcss = {\n  invalid: 'input-invalid',\n  inputvalidate: 'input-valid',\n}\nconst domselectors = {\n  captcha: '.js-captcha'\n}\n;\n\nclass FormSubmit {\n  handlers = [];\n  form = null;\n  listener = null;\n  constructor(form, options = {}) {\n    if (!form.formsubmit) {\n      if (!form) return;\n      this.form = form instanceof HTMLElement ? form : document.querySelector(form);\n      const defaultOptions = {\n        fetch: null,\n      };\n      options = Object.assign(options, this.form.dataset);\n      this.options = Object.assign(defaultOptions, options);\n      if (!this.form) return;\n      this.validateFields(true);\n      this.init();\n      form.formsubmit = this;\n    }\n    return form.formsubmit;\n  }\n  init() {\n    // init the form ( options like beforeunload etc...)\n\n    this.form.addEventListener('submit', async (e) => {\n      e.preventDefault();\n      const res = await this.submitForm();\n      return res;\n    });\n    this.specialFields();\n  }\n  specialFields() {\n    // check if there is a password confirm input\n    // add show text for password fields\n\n    this.form.querySelectorAll('input[data-match]').forEach(input => {\n      //\n      const match = input.dataset.match;\n      if (!match) return;\n      const target = document.getElementById(match);\n      if (!target) return;\n      const invalid = (input.dataset.matchinvalid) ? input.dataset.matchinvalid : \"no match\";\n      const check_match = (item, itemtarget) => {\n        const label = (input.previousElementSibling && input.previousElementSibling.tagName.toLowerCase() == 'label') ? input.previousElementSibling : null;\n        const labeltarget = (target.previousElementSibling && target.previousElementSibling.tagName.toLowerCase() == 'label') ? target.previousElementSibling : null;\n        const {\n          patternMismatch = false\n        } = item.validity;\n        const customvalidity = (patternMismatch) ?\n          this.get_message(item, 'invalid') : '';\n        if (item.checkValidity() === true) {\n          item.dataset.invalid = '';\n          item.setCustomValidity(\"\");\n          if (item == input && label !== null) label.classList.remove(formcss.invalid);\n          else if (labeltarget !== null) labeltarget.classList.remove(formcss.invalid);\n          item.classList.remove(formcss.inputvalidate);\n          if (item.value !== itemtarget.value) {\n            input.setCustomValidity(invalid);\n            if (label) {\n              label.dataset.invalid = (label.dataset.invalid) ? label.dataset.invalid : invalid;\n              label.classList.add(formcss.invalid);\n            }\n            input.classList.add(formcss.inputvalidate);\n          } else {\n            input.setCustomValidity(\"\");\n            if (label) label.classList.remove(formcss.invalid);\n            input.classList.remove(formcss.inputvalidate);\n          }\n        } else {\n          item.setCustomValidity(customvalidity);\n          item.dataset.invalid = customvalidity;\n          if (label) label.classList.add(formcss.invalid);\n          item.classList.add(formcss.inputvalidate);\n        }\n        item.focus();\n      };\n      [input, target].forEach(item => {\n        item.addEventListener('keyup', (e) => {\n          const itemtarget = (item === input) ? target : input;\n          check_match(item, itemtarget);\n        });\n      });\n\n    });\n  }\n  get_message(field, type = 'invalid') {\n    if (field.checkValidity() == false) {\n      const {\n        valueMissing = true\n      } = field.validity;\n      if (valueMissing) return (field.dataset.required) ? field.dataset.required : ((this.form.dataset.required) ? this.form.dataset.required : 'required');\n      else return (field.dataset[type]) ? field.dataset[type] : 'input invalid';\n    } else return '';\n  }\n\n  validateField(field, init = false) {\n\n\n\n    if (['textarea', 'input'].indexOf(field.tagName.toLowerCase()) >= 0) {\n\n    }\n\n    if (['select', 'input[type=\"checkbox\"]'].indexOf(field.tagName.toLowerCase()) >= 0) {\n      field.querySelectorAll('option:checked').forEach(option => {\n        option.value = (0,_modules_utils_js__WEBPACK_IMPORTED_MODULE_1__.decode_HTMLEntities)(dompurify__WEBPACK_IMPORTED_MODULE_0___default().sanitize(option.value));\n      });\n\n    } else field.value = (0,_modules_utils_js__WEBPACK_IMPORTED_MODULE_1__.decode_HTMLEntities)(dompurify__WEBPACK_IMPORTED_MODULE_0___default().sanitize(field.value));\n\n    const rep = field.checkValidity();\n\n    /*  if (field.classList.contains('select-one')) {\n\n    }*/\n    const label = field.closest('.form-box') ? field.closest('.form-box').querySelector('label') : null;\n\n    if (rep && label) {\n      label.classList.remove(formcss.invalid);\n    } else if (!rep) {\n      if (label) {\n        label.dataset.invalid = this.get_message(field);\n        label.classList.add(formcss.invalid);\n        window.scrollTo({\n          top: parseInt(label.offsetTop),\n          left: parseInt(label.offsetLeft),\n          behavior: 'smooth'\n        });\n      }\n    }\n    return rep;\n  }\n\n  validateFields(init = false) {\n    //todo: complete validation foreach field type\n    let resp = true;\n    // .required input for tom-select component\n\n    [...this.form.elements].forEach(field => {\n      if (field.name) {\n\n        if (init === true) {\n\n          if (!field.dataset.listen) {\n            if (field.hasAttribute('required') && field.required) {\n              const label = field.closest('.form-box') ? field.closest('.form-box').querySelector('label') : field.parentElement.querySelector('label');\n              if (label) label.classList.add('required');\n            }\n\n            ['change', 'blur'].forEach(evt => {\n              field.addEventListener(evt, (e) => {\n                this.validateField(e.currentTarget, init);\n              });\n            });\n            field.dataset.listen = true;\n          }\n        } else resp = (resp && this.validateField(field, init));\n      }\n    });\n    return resp;\n  }\n\n  addHandler(handler) {\n    this.handlers.push(handler);\n  }\n  fieldEnable(enable = true) {\n    this.form.querySelectorAll('input[data-sub=\"enable\"]').forEach(input => {\n      if (enable === true) {\n        input.removeAttribute(\"disabled\");\n      } else input.disabled = true;\n    });\n  }\n\n  async submitHandler() {\n    if (!this.validateFields()) return false;\n\n    if (this.handlers.length === 0) return true;\n    let resp = true;\n    // series\n    /*  for (const handler of this.handlers) {\n          const rep = await handler()\n          resp = (resp && rep)\n      }*/\n    // concurrent\n    await Promise.all(this.handlers.map(async handler => {\n      const rep = await handler();\n      resp = (resp && rep);\n    }));\n    if (resp === true) this.handlers = [];\n    return resp;\n  }\n  // no redirection when using data-fetch\n  formFetch(format = null) {\n    const formdata = new FormData(this.form);\n    formdata[\"fetch\"] = true;\n    fetch(this.form.action, (0,_modules_utils_js__WEBPACK_IMPORTED_MODULE_1__.fetchSettings)({\n        method: 'POST',\n        body: formdata,\n      }))\n      .then(response => {\n        switch (format) {\n          case \"text\":\n          case \"html\":\n            return response.text();\n            break;\n          default:\n            return response.json();\n        }\n      })\n      .then(response => {\n        this.displayResponse(response);\n      })\n      .catch(err => {\n        this.displayResponse(err, true)\n      }).finally(response => {\n        this.form.disabled = true;\n      });\n    return false;\n  }\n\n  async submitForm() {\n    this.fieldEnable();\n\n    if (this.validateFields(false)) {\n      const isbot = (this.form.querySelector(domselectors.captcha)) ? (this.form.dataset.isbot ? (this.form.dataset.isbot === true) : true) : false;\n      if (isbot === true) return false;\n      const yessubmit = await this.submitHandler();\n      if (yessubmit) {\n        if (this.options.fetch) this.formFetch(this.options.fetch);\n        else this.form.submit();\n        this.form.disabled = true;\n        return true;\n      } else return false;\n    } else return false;\n  }\n\n  displayResponse(response, error = false) {\n    const el = document.createElement('div');\n    el.insertAdjacentHTML('afterbegin', response);\n    if (error !== false) el.classList.add('is-error');\n    this.form.parentElement.insertBefore(el, this.form);\n    this.form.remove();\n  }\n}//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvbW9kdWxlcy9mb3JtLXN1Ym1pdC5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQWtDO0FBQ0E7QUFDbEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUc2Qjs7QUFFdEI7QUFDUDtBQUNBO0FBQ0E7QUFDQSxnQ0FBZ0M7QUFDaEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVCxPQUFPOztBQUVQLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQSxNQUFNO0FBQ047O0FBRUE7Ozs7QUFJQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0EsdUJBQXVCLHNFQUFtQixDQUFDLHlEQUFrQjtBQUM3RCxPQUFPOztBQUVQLE1BQU0sbUJBQW1CLHNFQUFtQixDQUFDLHlEQUFrQjs7QUFFL0Q7O0FBRUE7O0FBRUEsS0FBSztBQUNMOztBQUVBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLGVBQWU7QUFDZixhQUFhO0FBQ2I7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBLEtBQUs7QUFDTDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSLEtBQUs7QUFDTDs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRCQUE0QixnRUFBYTtBQUN6QztBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQSxPQUFPO0FBQ1A7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUixNQUFNO0FBQ047O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL3NyYy9tb2R1bGVzL2Zvcm0tc3VibWl0LmpzP2M2YjciXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHZhbGlkYXRvciBmcm9tICd2YWxpZGF0b3InO1xuaW1wb3J0IERPTVB1cmlmeSBmcm9tICdkb21wdXJpZnknO1xuY29uc3QgZm9ybWNzcyA9IHtcbiAgaW52YWxpZDogJ2lucHV0LWludmFsaWQnLFxuICBpbnB1dHZhbGlkYXRlOiAnaW5wdXQtdmFsaWQnLFxufVxuY29uc3QgZG9tc2VsZWN0b3JzID0ge1xuICBjYXB0Y2hhOiAnLmpzLWNhcHRjaGEnXG59XG5pbXBvcnQge1xuICBmZXRjaFNldHRpbmdzLFxuICBkZWNvZGVfSFRNTEVudGl0aWVzXG59IGZyb20gJy4uL21vZHVsZXMvdXRpbHMuanMnO1xuXG5leHBvcnQgY2xhc3MgRm9ybVN1Ym1pdCB7XG4gIGhhbmRsZXJzID0gW107XG4gIGZvcm0gPSBudWxsO1xuICBsaXN0ZW5lciA9IG51bGw7XG4gIGNvbnN0cnVjdG9yKGZvcm0sIG9wdGlvbnMgPSB7fSkge1xuICAgIGlmICghZm9ybS5mb3Jtc3VibWl0KSB7XG4gICAgICBpZiAoIWZvcm0pIHJldHVybjtcbiAgICAgIHRoaXMuZm9ybSA9IGZvcm0gaW5zdGFuY2VvZiBIVE1MRWxlbWVudCA/IGZvcm0gOiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGZvcm0pO1xuICAgICAgY29uc3QgZGVmYXVsdE9wdGlvbnMgPSB7XG4gICAgICAgIGZldGNoOiBudWxsLFxuICAgICAgfTtcbiAgICAgIG9wdGlvbnMgPSBPYmplY3QuYXNzaWduKG9wdGlvbnMsIHRoaXMuZm9ybS5kYXRhc2V0KTtcbiAgICAgIHRoaXMub3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oZGVmYXVsdE9wdGlvbnMsIG9wdGlvbnMpO1xuICAgICAgaWYgKCF0aGlzLmZvcm0pIHJldHVybjtcbiAgICAgIHRoaXMudmFsaWRhdGVGaWVsZHModHJ1ZSk7XG4gICAgICB0aGlzLmluaXQoKTtcbiAgICAgIGZvcm0uZm9ybXN1Ym1pdCA9IHRoaXM7XG4gICAgfVxuICAgIHJldHVybiBmb3JtLmZvcm1zdWJtaXQ7XG4gIH1cbiAgaW5pdCgpIHtcbiAgICAvLyBpbml0IHRoZSBmb3JtICggb3B0aW9ucyBsaWtlIGJlZm9yZXVubG9hZCBldGMuLi4pXG5cbiAgICB0aGlzLmZvcm0uYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgYXN5bmMgKGUpID0+IHtcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IHRoaXMuc3VibWl0Rm9ybSgpO1xuICAgICAgcmV0dXJuIHJlcztcbiAgICB9KTtcbiAgICB0aGlzLnNwZWNpYWxGaWVsZHMoKTtcbiAgfVxuICBzcGVjaWFsRmllbGRzKCkge1xuICAgIC8vIGNoZWNrIGlmIHRoZXJlIGlzIGEgcGFzc3dvcmQgY29uZmlybSBpbnB1dFxuICAgIC8vIGFkZCBzaG93IHRleHQgZm9yIHBhc3N3b3JkIGZpZWxkc1xuXG4gICAgdGhpcy5mb3JtLnF1ZXJ5U2VsZWN0b3JBbGwoJ2lucHV0W2RhdGEtbWF0Y2hdJykuZm9yRWFjaChpbnB1dCA9PiB7XG4gICAgICAvL1xuICAgICAgY29uc3QgbWF0Y2ggPSBpbnB1dC5kYXRhc2V0Lm1hdGNoO1xuICAgICAgaWYgKCFtYXRjaCkgcmV0dXJuO1xuICAgICAgY29uc3QgdGFyZ2V0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQobWF0Y2gpO1xuICAgICAgaWYgKCF0YXJnZXQpIHJldHVybjtcbiAgICAgIGNvbnN0IGludmFsaWQgPSAoaW5wdXQuZGF0YXNldC5tYXRjaGludmFsaWQpID8gaW5wdXQuZGF0YXNldC5tYXRjaGludmFsaWQgOiBcIm5vIG1hdGNoXCI7XG4gICAgICBjb25zdCBjaGVja19tYXRjaCA9IChpdGVtLCBpdGVtdGFyZ2V0KSA9PiB7XG4gICAgICAgIGNvbnN0IGxhYmVsID0gKGlucHV0LnByZXZpb3VzRWxlbWVudFNpYmxpbmcgJiYgaW5wdXQucHJldmlvdXNFbGVtZW50U2libGluZy50YWdOYW1lLnRvTG93ZXJDYXNlKCkgPT0gJ2xhYmVsJykgPyBpbnB1dC5wcmV2aW91c0VsZW1lbnRTaWJsaW5nIDogbnVsbDtcbiAgICAgICAgY29uc3QgbGFiZWx0YXJnZXQgPSAodGFyZ2V0LnByZXZpb3VzRWxlbWVudFNpYmxpbmcgJiYgdGFyZ2V0LnByZXZpb3VzRWxlbWVudFNpYmxpbmcudGFnTmFtZS50b0xvd2VyQ2FzZSgpID09ICdsYWJlbCcpID8gdGFyZ2V0LnByZXZpb3VzRWxlbWVudFNpYmxpbmcgOiBudWxsO1xuICAgICAgICBjb25zdCB7XG4gICAgICAgICAgcGF0dGVybk1pc21hdGNoID0gZmFsc2VcbiAgICAgICAgfSA9IGl0ZW0udmFsaWRpdHk7XG4gICAgICAgIGNvbnN0IGN1c3RvbXZhbGlkaXR5ID0gKHBhdHRlcm5NaXNtYXRjaCkgP1xuICAgICAgICAgIHRoaXMuZ2V0X21lc3NhZ2UoaXRlbSwgJ2ludmFsaWQnKSA6ICcnO1xuICAgICAgICBpZiAoaXRlbS5jaGVja1ZhbGlkaXR5KCkgPT09IHRydWUpIHtcbiAgICAgICAgICBpdGVtLmRhdGFzZXQuaW52YWxpZCA9ICcnO1xuICAgICAgICAgIGl0ZW0uc2V0Q3VzdG9tVmFsaWRpdHkoXCJcIik7XG4gICAgICAgICAgaWYgKGl0ZW0gPT0gaW5wdXQgJiYgbGFiZWwgIT09IG51bGwpIGxhYmVsLmNsYXNzTGlzdC5yZW1vdmUoZm9ybWNzcy5pbnZhbGlkKTtcbiAgICAgICAgICBlbHNlIGlmIChsYWJlbHRhcmdldCAhPT0gbnVsbCkgbGFiZWx0YXJnZXQuY2xhc3NMaXN0LnJlbW92ZShmb3JtY3NzLmludmFsaWQpO1xuICAgICAgICAgIGl0ZW0uY2xhc3NMaXN0LnJlbW92ZShmb3JtY3NzLmlucHV0dmFsaWRhdGUpO1xuICAgICAgICAgIGlmIChpdGVtLnZhbHVlICE9PSBpdGVtdGFyZ2V0LnZhbHVlKSB7XG4gICAgICAgICAgICBpbnB1dC5zZXRDdXN0b21WYWxpZGl0eShpbnZhbGlkKTtcbiAgICAgICAgICAgIGlmIChsYWJlbCkge1xuICAgICAgICAgICAgICBsYWJlbC5kYXRhc2V0LmludmFsaWQgPSAobGFiZWwuZGF0YXNldC5pbnZhbGlkKSA/IGxhYmVsLmRhdGFzZXQuaW52YWxpZCA6IGludmFsaWQ7XG4gICAgICAgICAgICAgIGxhYmVsLmNsYXNzTGlzdC5hZGQoZm9ybWNzcy5pbnZhbGlkKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlucHV0LmNsYXNzTGlzdC5hZGQoZm9ybWNzcy5pbnB1dHZhbGlkYXRlKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaW5wdXQuc2V0Q3VzdG9tVmFsaWRpdHkoXCJcIik7XG4gICAgICAgICAgICBpZiAobGFiZWwpIGxhYmVsLmNsYXNzTGlzdC5yZW1vdmUoZm9ybWNzcy5pbnZhbGlkKTtcbiAgICAgICAgICAgIGlucHV0LmNsYXNzTGlzdC5yZW1vdmUoZm9ybWNzcy5pbnB1dHZhbGlkYXRlKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaXRlbS5zZXRDdXN0b21WYWxpZGl0eShjdXN0b212YWxpZGl0eSk7XG4gICAgICAgICAgaXRlbS5kYXRhc2V0LmludmFsaWQgPSBjdXN0b212YWxpZGl0eTtcbiAgICAgICAgICBpZiAobGFiZWwpIGxhYmVsLmNsYXNzTGlzdC5hZGQoZm9ybWNzcy5pbnZhbGlkKTtcbiAgICAgICAgICBpdGVtLmNsYXNzTGlzdC5hZGQoZm9ybWNzcy5pbnB1dHZhbGlkYXRlKTtcbiAgICAgICAgfVxuICAgICAgICBpdGVtLmZvY3VzKCk7XG4gICAgICB9O1xuICAgICAgW2lucHV0LCB0YXJnZXRdLmZvckVhY2goaXRlbSA9PiB7XG4gICAgICAgIGl0ZW0uYWRkRXZlbnRMaXN0ZW5lcigna2V5dXAnLCAoZSkgPT4ge1xuICAgICAgICAgIGNvbnN0IGl0ZW10YXJnZXQgPSAoaXRlbSA9PT0gaW5wdXQpID8gdGFyZ2V0IDogaW5wdXQ7XG4gICAgICAgICAgY2hlY2tfbWF0Y2goaXRlbSwgaXRlbXRhcmdldCk7XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG5cbiAgICB9KTtcbiAgfVxuICBnZXRfbWVzc2FnZShmaWVsZCwgdHlwZSA9ICdpbnZhbGlkJykge1xuICAgIGlmIChmaWVsZC5jaGVja1ZhbGlkaXR5KCkgPT0gZmFsc2UpIHtcbiAgICAgIGNvbnN0IHtcbiAgICAgICAgdmFsdWVNaXNzaW5nID0gdHJ1ZVxuICAgICAgfSA9IGZpZWxkLnZhbGlkaXR5O1xuICAgICAgaWYgKHZhbHVlTWlzc2luZykgcmV0dXJuIChmaWVsZC5kYXRhc2V0LnJlcXVpcmVkKSA/IGZpZWxkLmRhdGFzZXQucmVxdWlyZWQgOiAoKHRoaXMuZm9ybS5kYXRhc2V0LnJlcXVpcmVkKSA/IHRoaXMuZm9ybS5kYXRhc2V0LnJlcXVpcmVkIDogJ3JlcXVpcmVkJyk7XG4gICAgICBlbHNlIHJldHVybiAoZmllbGQuZGF0YXNldFt0eXBlXSkgPyBmaWVsZC5kYXRhc2V0W3R5cGVdIDogJ2lucHV0IGludmFsaWQnO1xuICAgIH0gZWxzZSByZXR1cm4gJyc7XG4gIH1cblxuICB2YWxpZGF0ZUZpZWxkKGZpZWxkLCBpbml0ID0gZmFsc2UpIHtcblxuXG5cbiAgICBpZiAoWyd0ZXh0YXJlYScsICdpbnB1dCddLmluZGV4T2YoZmllbGQudGFnTmFtZS50b0xvd2VyQ2FzZSgpKSA+PSAwKSB7XG5cbiAgICB9XG5cbiAgICBpZiAoWydzZWxlY3QnLCAnaW5wdXRbdHlwZT1cImNoZWNrYm94XCJdJ10uaW5kZXhPZihmaWVsZC50YWdOYW1lLnRvTG93ZXJDYXNlKCkpID49IDApIHtcbiAgICAgIGZpZWxkLnF1ZXJ5U2VsZWN0b3JBbGwoJ29wdGlvbjpjaGVja2VkJykuZm9yRWFjaChvcHRpb24gPT4ge1xuICAgICAgICBvcHRpb24udmFsdWUgPSBkZWNvZGVfSFRNTEVudGl0aWVzKERPTVB1cmlmeS5zYW5pdGl6ZShvcHRpb24udmFsdWUpKTtcbiAgICAgIH0pO1xuXG4gICAgfSBlbHNlIGZpZWxkLnZhbHVlID0gZGVjb2RlX0hUTUxFbnRpdGllcyhET01QdXJpZnkuc2FuaXRpemUoZmllbGQudmFsdWUpKTtcblxuICAgIGNvbnN0IHJlcCA9IGZpZWxkLmNoZWNrVmFsaWRpdHkoKTtcblxuICAgIC8qICBpZiAoZmllbGQuY2xhc3NMaXN0LmNvbnRhaW5zKCdzZWxlY3Qtb25lJykpIHtcblxuICAgIH0qL1xuICAgIGNvbnN0IGxhYmVsID0gZmllbGQuY2xvc2VzdCgnLmZvcm0tYm94JykgPyBmaWVsZC5jbG9zZXN0KCcuZm9ybS1ib3gnKS5xdWVyeVNlbGVjdG9yKCdsYWJlbCcpIDogbnVsbDtcblxuICAgIGlmIChyZXAgJiYgbGFiZWwpIHtcbiAgICAgIGxhYmVsLmNsYXNzTGlzdC5yZW1vdmUoZm9ybWNzcy5pbnZhbGlkKTtcbiAgICB9IGVsc2UgaWYgKCFyZXApIHtcbiAgICAgIGlmIChsYWJlbCkge1xuICAgICAgICBsYWJlbC5kYXRhc2V0LmludmFsaWQgPSB0aGlzLmdldF9tZXNzYWdlKGZpZWxkKTtcbiAgICAgICAgbGFiZWwuY2xhc3NMaXN0LmFkZChmb3JtY3NzLmludmFsaWQpO1xuICAgICAgICB3aW5kb3cuc2Nyb2xsVG8oe1xuICAgICAgICAgIHRvcDogcGFyc2VJbnQobGFiZWwub2Zmc2V0VG9wKSxcbiAgICAgICAgICBsZWZ0OiBwYXJzZUludChsYWJlbC5vZmZzZXRMZWZ0KSxcbiAgICAgICAgICBiZWhhdmlvcjogJ3Ntb290aCdcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiByZXA7XG4gIH1cblxuICB2YWxpZGF0ZUZpZWxkcyhpbml0ID0gZmFsc2UpIHtcbiAgICAvL3RvZG86IGNvbXBsZXRlIHZhbGlkYXRpb24gZm9yZWFjaCBmaWVsZCB0eXBlXG4gICAgbGV0IHJlc3AgPSB0cnVlO1xuICAgIC8vIC5yZXF1aXJlZCBpbnB1dCBmb3IgdG9tLXNlbGVjdCBjb21wb25lbnRcblxuICAgIFsuLi50aGlzLmZvcm0uZWxlbWVudHNdLmZvckVhY2goZmllbGQgPT4ge1xuICAgICAgaWYgKGZpZWxkLm5hbWUpIHtcblxuICAgICAgICBpZiAoaW5pdCA9PT0gdHJ1ZSkge1xuXG4gICAgICAgICAgaWYgKCFmaWVsZC5kYXRhc2V0Lmxpc3Rlbikge1xuICAgICAgICAgICAgaWYgKGZpZWxkLmhhc0F0dHJpYnV0ZSgncmVxdWlyZWQnKSAmJiBmaWVsZC5yZXF1aXJlZCkge1xuICAgICAgICAgICAgICBjb25zdCBsYWJlbCA9IGZpZWxkLmNsb3Nlc3QoJy5mb3JtLWJveCcpID8gZmllbGQuY2xvc2VzdCgnLmZvcm0tYm94JykucXVlcnlTZWxlY3RvcignbGFiZWwnKSA6IGZpZWxkLnBhcmVudEVsZW1lbnQucXVlcnlTZWxlY3RvcignbGFiZWwnKTtcbiAgICAgICAgICAgICAgaWYgKGxhYmVsKSBsYWJlbC5jbGFzc0xpc3QuYWRkKCdyZXF1aXJlZCcpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBbJ2NoYW5nZScsICdibHVyJ10uZm9yRWFjaChldnQgPT4ge1xuICAgICAgICAgICAgICBmaWVsZC5hZGRFdmVudExpc3RlbmVyKGV2dCwgKGUpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLnZhbGlkYXRlRmllbGQoZS5jdXJyZW50VGFyZ2V0LCBpbml0KTtcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGZpZWxkLmRhdGFzZXQubGlzdGVuID0gdHJ1ZTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSByZXNwID0gKHJlc3AgJiYgdGhpcy52YWxpZGF0ZUZpZWxkKGZpZWxkLCBpbml0KSk7XG4gICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuIHJlc3A7XG4gIH1cblxuICBhZGRIYW5kbGVyKGhhbmRsZXIpIHtcbiAgICB0aGlzLmhhbmRsZXJzLnB1c2goaGFuZGxlcik7XG4gIH1cbiAgZmllbGRFbmFibGUoZW5hYmxlID0gdHJ1ZSkge1xuICAgIHRoaXMuZm9ybS5xdWVyeVNlbGVjdG9yQWxsKCdpbnB1dFtkYXRhLXN1Yj1cImVuYWJsZVwiXScpLmZvckVhY2goaW5wdXQgPT4ge1xuICAgICAgaWYgKGVuYWJsZSA9PT0gdHJ1ZSkge1xuICAgICAgICBpbnB1dC5yZW1vdmVBdHRyaWJ1dGUoXCJkaXNhYmxlZFwiKTtcbiAgICAgIH0gZWxzZSBpbnB1dC5kaXNhYmxlZCA9IHRydWU7XG4gICAgfSk7XG4gIH1cblxuICBhc3luYyBzdWJtaXRIYW5kbGVyKCkge1xuICAgIGlmICghdGhpcy52YWxpZGF0ZUZpZWxkcygpKSByZXR1cm4gZmFsc2U7XG5cbiAgICBpZiAodGhpcy5oYW5kbGVycy5sZW5ndGggPT09IDApIHJldHVybiB0cnVlO1xuICAgIGxldCByZXNwID0gdHJ1ZTtcbiAgICAvLyBzZXJpZXNcbiAgICAvKiAgZm9yIChjb25zdCBoYW5kbGVyIG9mIHRoaXMuaGFuZGxlcnMpIHtcbiAgICAgICAgICBjb25zdCByZXAgPSBhd2FpdCBoYW5kbGVyKClcbiAgICAgICAgICByZXNwID0gKHJlc3AgJiYgcmVwKVxuICAgICAgfSovXG4gICAgLy8gY29uY3VycmVudFxuICAgIGF3YWl0IFByb21pc2UuYWxsKHRoaXMuaGFuZGxlcnMubWFwKGFzeW5jIGhhbmRsZXIgPT4ge1xuICAgICAgY29uc3QgcmVwID0gYXdhaXQgaGFuZGxlcigpO1xuICAgICAgcmVzcCA9IChyZXNwICYmIHJlcCk7XG4gICAgfSkpO1xuICAgIGlmIChyZXNwID09PSB0cnVlKSB0aGlzLmhhbmRsZXJzID0gW107XG4gICAgcmV0dXJuIHJlc3A7XG4gIH1cbiAgLy8gbm8gcmVkaXJlY3Rpb24gd2hlbiB1c2luZyBkYXRhLWZldGNoXG4gIGZvcm1GZXRjaChmb3JtYXQgPSBudWxsKSB7XG4gICAgY29uc3QgZm9ybWRhdGEgPSBuZXcgRm9ybURhdGEodGhpcy5mb3JtKTtcbiAgICBmb3JtZGF0YVtcImZldGNoXCJdID0gdHJ1ZTtcbiAgICBmZXRjaCh0aGlzLmZvcm0uYWN0aW9uLCBmZXRjaFNldHRpbmdzKHtcbiAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgIGJvZHk6IGZvcm1kYXRhLFxuICAgICAgfSkpXG4gICAgICAudGhlbihyZXNwb25zZSA9PiB7XG4gICAgICAgIHN3aXRjaCAoZm9ybWF0KSB7XG4gICAgICAgICAgY2FzZSBcInRleHRcIjpcbiAgICAgICAgICBjYXNlIFwiaHRtbFwiOlxuICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlLnRleHQoKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UuanNvbigpO1xuICAgICAgICB9XG4gICAgICB9KVxuICAgICAgLnRoZW4ocmVzcG9uc2UgPT4ge1xuICAgICAgICB0aGlzLmRpc3BsYXlSZXNwb25zZShyZXNwb25zZSk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKGVyciA9PiB7XG4gICAgICAgIHRoaXMuZGlzcGxheVJlc3BvbnNlKGVyciwgdHJ1ZSlcbiAgICAgIH0pLmZpbmFsbHkocmVzcG9uc2UgPT4ge1xuICAgICAgICB0aGlzLmZvcm0uZGlzYWJsZWQgPSB0cnVlO1xuICAgICAgfSk7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgYXN5bmMgc3VibWl0Rm9ybSgpIHtcbiAgICB0aGlzLmZpZWxkRW5hYmxlKCk7XG5cbiAgICBpZiAodGhpcy52YWxpZGF0ZUZpZWxkcyhmYWxzZSkpIHtcbiAgICAgIGNvbnN0IGlzYm90ID0gKHRoaXMuZm9ybS5xdWVyeVNlbGVjdG9yKGRvbXNlbGVjdG9ycy5jYXB0Y2hhKSkgPyAodGhpcy5mb3JtLmRhdGFzZXQuaXNib3QgPyAodGhpcy5mb3JtLmRhdGFzZXQuaXNib3QgPT09IHRydWUpIDogdHJ1ZSkgOiBmYWxzZTtcbiAgICAgIGlmIChpc2JvdCA9PT0gdHJ1ZSkgcmV0dXJuIGZhbHNlO1xuICAgICAgY29uc3QgeWVzc3VibWl0ID0gYXdhaXQgdGhpcy5zdWJtaXRIYW5kbGVyKCk7XG4gICAgICBpZiAoeWVzc3VibWl0KSB7XG4gICAgICAgIGlmICh0aGlzLm9wdGlvbnMuZmV0Y2gpIHRoaXMuZm9ybUZldGNoKHRoaXMub3B0aW9ucy5mZXRjaCk7XG4gICAgICAgIGVsc2UgdGhpcy5mb3JtLnN1Ym1pdCgpO1xuICAgICAgICB0aGlzLmZvcm0uZGlzYWJsZWQgPSB0cnVlO1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH0gZWxzZSByZXR1cm4gZmFsc2U7XG4gICAgfSBlbHNlIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIGRpc3BsYXlSZXNwb25zZShyZXNwb25zZSwgZXJyb3IgPSBmYWxzZSkge1xuICAgIGNvbnN0IGVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgZWwuaW5zZXJ0QWRqYWNlbnRIVE1MKCdhZnRlcmJlZ2luJywgcmVzcG9uc2UpO1xuICAgIGlmIChlcnJvciAhPT0gZmFsc2UpIGVsLmNsYXNzTGlzdC5hZGQoJ2lzLWVycm9yJyk7XG4gICAgdGhpcy5mb3JtLnBhcmVudEVsZW1lbnQuaW5zZXJ0QmVmb3JlKGVsLCB0aGlzLmZvcm0pO1xuICAgIHRoaXMuZm9ybS5yZW1vdmUoKTtcbiAgfVxufSJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/modules/form-submit.js\n")}}]);