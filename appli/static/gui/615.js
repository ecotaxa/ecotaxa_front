"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[615],{615:(t,e,i)=>{i.r(e),i.d(e,{FormSubmit:()=>d});var a=i(7856),s=i.n(a);let l=null;const r="invalid",n="input-validate";class d{handlers=[];form=null;listener=null;constructor(t,e={}){if(!l){if(!t)return;const i={};this.options=Object.assign(i,e),this.form=t instanceof HTMLElement?t:document.querySelector(t),this.validateFields(!0),this.init(),l=this}return l}init(){this.form.addEventListener("submit",(async t=>{console.log("----------------formsubmit",t);const e=await this.submitForm();return e||t.preventDefault(),e})),this.form.querySelectorAll("input[data-match]").forEach((t=>{const e=t.dataset.match;if(!e)return;const i=document.getElementById(e);if(!i)return;const a=t.dataset.matchinvalid?t.dataset.matchinvalid:"no match",s=t.closest("label");[t,i].forEach((e=>{e.addEventListener("keyup",(l=>{((e,i)=>{e.value!==i.value?(e.setCustomValidity(a),i.setCustomValidity(a),t!=e&&(s&&s.classList.add(r),t.classList.add(n))):(e.setCustomValidity(""),i.setCustomValidity(""),e.dataset.invalid="",i.dataset.invalid="",t!=e&&(s&&s.classList.remove(r),t.classList.remove(n))),e.reportValidity(),i.reportValidity(),e.focus()})(e,e===t?i:t)}))}))}))}validateField(t){t.value=s().sanitize(t.value);const e=t.checkValidity(),i=t.closest(".form-box")?t.closest(".form-box").querySelector("label"):null;return e&&i?i.classList.remove(r):e||i&&(i.dataset.invalid=(t=>{let e="invalid";return t.required&&(e=t.dataset.required?t.dataset.required:this.form.dataset.required?this.form.dataset.required:"invalid"),"invalid"===e&&(e=t.dataset.invalid?t.dataset.invalid:this.form.dataset.invalid?this.form.dataset.invalid:"invalid input"),e})(t),i.classList.add(r)),t.classList.contains("tomselected")&&t.nextElementSibling?t.nextElementSibling.classList.add(n):t.classList.add(n),e}validateFields(t=!1){let e=!0;return this.form.querySelectorAll("input,textarea, select").forEach((i=>{if(!0===t)i.dataset.listen||(["change","blur"].forEach((t=>{i.addEventListener(t,(t=>{this.validateField(t.currentTarget)}))})),i.dataset.listen=!0);else{const t=this.validateField(i);e=e&&t}})),e}addHandler(t){this.handlers.push(t)}fieldEnable(){this.form.querySelectorAll('input[data-sub="enable"]').forEach((t=>{t.removeAttribute("disabled")}))}async submitHandler(){if(!this.validateFields())return!1;if(0===this.handlers.length)return!0;let t=!0;return await Promise.all(this.handlers.map((async e=>{const i=await e();t=t&&i}))),!0===t&&(this.handlers=[]),console.log("resp",t),t}async submitForm(){return!!this.validateFields(!1)&&(!!await this.submitHandler()&&(this.fieldEnable(),void this.form.submit()))}}}}]);