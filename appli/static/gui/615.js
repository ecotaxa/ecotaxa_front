"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[615],{615:(e,t,i)=>{i.d(t,{FormSubmit:()=>d});var s=i(7856),a=i.n(s);let l=null;const r="invalid",n="input-validate";class d{handlers=[];form=null;listener=null;constructor(e,t={}){if(!l){if(!e)return;const i={};if(this.options=Object.assign(i,t),this.form=e instanceof HTMLElement?e:document.querySelector(e),!this.form)return;this.validateFields(!0),this.init(),l=this}return l}init(){this.form.addEventListener("submit",(async e=>{await this.submitForm(),e.preventDefault()})),this.specialFields()}specialFields(){this.form.querySelectorAll("input[data-match]").forEach((e=>{const t=e.dataset.match;if(!t)return;const i=document.getElementById(t);if(!i)return;const s=e.dataset.matchinvalid?e.dataset.matchinvalid:"no match",a=e.closest("label");[e,i].forEach((t=>{t.addEventListener("keyup",(l=>{((t,i)=>{t.value!==i.value?(t.setCustomValidity(s),i.setCustomValidity(s),e!=t&&(a&&a.classList.add(r),e.classList.add(n))):(t.setCustomValidity(""),i.setCustomValidity(""),t.dataset.invalid="",i.dataset.invalid="",e!=t&&(a&&a.classList.remove(r),e.classList.remove(n))),t.reportValidity(),i.reportValidity(),t.focus()})(t,t===e?i:e)}))}))}))}validateField(e){["textarea","input"].indexOf(e.tagName.toLowerCase())>=0&&(e.value=a().sanitize(e.value));const t=e.checkValidity();e.classList.contains("select-one")&&console.log("select rep",t);const i=e.closest(".form-box")?e.closest(".form-box").querySelector("label"):null;return t&&i?i.classList.remove(r):t||i&&(i.dataset.invalid=((e,t)=>{let i="invalid";return e.required&&(i=e.dataset.required?e.dataset.required:this.form.dataset.required?this.form.dataset.required:"invalid"),"invalid"===i&&(i=e.dataset.invalid?e.dataset.invalid:this.form.dataset.invalid?this.form.dataset.invalid:"invalid input"),i})(e),i.classList.add(r),window.scrollTo({top:parseInt(i.offsetTop),left:parseInt(i.offsetLeft),behavior:"smooth"})),t}validateFields(e=!1){let t=!0;return this.form.querySelectorAll("input,textarea, select").forEach((i=>{if(!0===e){if(!i.dataset.listen){if(i.hasAttribute("required")&&i.required){const e=i.closest(".form-box")?i.closest(".form-box").querySelector("label"):i.parentElement.querySelector("label");e&&e.classList.add("required")}if(i.classList.contains("tomselected")){if(i.removeAttribute("required"),console.log("nextel",i.nextElementSibling),null===(i=i.nextElementSibling?i.nextElementSibling.querySelector("input"):null))return!1;i.setAttribute("required",!0)}["change","blur"].forEach((e=>{i.addEventListener(e,(e=>{this.validateField(e.currentTarget)}))})),i.dataset.listen=!0}}else t=t&&this.validateField(i)})),t}addHandler(e){this.handlers.push(e)}fieldEnable(){this.form.querySelectorAll('input[data-sub="enable"]').forEach((e=>{e.removeAttribute("disabled")}))}async submitHandler(){if(!this.validateFields())return!1;if(0===this.handlers.length)return!0;let e=!0;return await Promise.all(this.handlers.map((async t=>{const i=await t();e=e&&i}))),!0===e&&(this.handlers=[]),console.log("resp",e),e}async submitForm(){return!!this.validateFields(!1)&&(!!await this.submitHandler()&&(this.fieldEnable(),void this.form.submit()))}}}}]);