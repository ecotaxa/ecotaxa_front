/*! For license information please see 89.5be5beb0874173281b20.js.LICENSE.txt */
(self.webpackChunk=self.webpackChunk||[]).push([[89],{9780:(t,e,s)=>{"use strict";s.d(e,{TableComponent:()=>u});var i=s(2838),a=s.n(i),n=s(4982),l=s.n(n),r=s(4860),d=s(7114);let o=[];const c={collectionlist:"/gui/collectionlist/",prjlist:"/gui/prjlist/",prjsamplestats:"/gui/prjsamplestats",userslist:"/gui/admin/userslist/",prjpredict:"/gui/prjsforprediction/"},h={showfull:"showfull",tipinline:"tip-inline",searchresults:"search-results",selectaction:"selectaction",absinput:"absinput",disabled:"table-disabled",ascending:"table-ascending",descending:"table-descending",tipover:"tipover absolute z-10 text-stone-50 rounded bg-stone-600 px-2 py-0.5 -mt-5 ml-12 ",hide:"hide",nowrap:"truncate"},p={table:".table-table",wrapper:".table-wrapper",top:".table-top",input:".table-input",search:".table-search",export:".button-export",filters:".table-filters",sorter:".table-sorter",details:'details[data-what="about"]',tip:"."+d.AH.component.table.tip,tipover:".tipover",wait:"wait-please",sorton:".sorton"};Object.freeze(h),Object.freeze(p);const m={};class u{instanceid=null;grid={columns:[],active:[],hidden:[],data:[]};domdef={columns:[],data:[]};wrapper=null;dom=null;params=null;_events={};eventnames={init:"table.init",update:"table.update",refresh:"table.refresh",resize:"table.resize",search:"table.search",searchend:"table.searchend",sorting:"table.sorting",sorted:"table.sorted",load:"table.loaded",dismiss:"table.dismiss"};labels={placeholder:"Search...",perPage:"{select} entries per page",noRows:"No entries found",info:"Showing {start} to {end} of {rows} entries",noResults:"No result match your search query"};cellidname="id";searching=!1;sorting=!1;initialized=!1;plugins={};constructor(t,e={}){if(t&&(t=t instanceof HTMLElement?t:document.querySelector(t)))return this.instanceid=t.dataset.instanceid?t.dataset.instanceid:document.querySelectorAll("table").length,o[this.instanceid]&&l()(t.dataset,o[this.instanceid].params)?this.refresh():this.init(t),o[this.instanceid]}init(t){(0,r.UO)(this),this.params=t.dataset;let e=t.querySelector("table");e||(e=document.createElement("table"),t.appendChild(e)),e.id="table-"+t.id,e.classList.add(p.table.substr(1)),this.dom=e;let s={nodename:"DIV",attributes:{class:p.top.substr(1)}};this.params.searchable&&(s.childnodes=[{nodename:"DIV",attributes:{class:p.search.substr(1)},html:`<input type="search" name="table-search" placeholder="${this.labels.placeholder}" class="${p.input.substr(1)}  ${d.AH.input} ${d.AH.hide}">`}]);let i=this.objToElement({nodename:"DIV",attributes:{class:p.wrapper.substr(1)},childnodes:[s]});t.appendChild(i),i.appendChild(e),this.wrapper=i,this.labels=this.params.labels?this.params.labels:this.labels,this.cellidname=this.params.hasOwnProperty("cellid")?this.params.cellid:this.cellidname,this.params.from=this.params.from?a().sanitize(this.params.from):null;const n=this.params.from&&Object.keys(c).indexOf(this.params.from)>=0?c[this.params.from]:null;n?this.params.defer?this.deferLoad(t,n):this.fetchData(t,n):this.tableActivate(t),this.dt=Date.now()}waitActivate(t){let e=t.querySelector("#"+p.wait);e||(e=document.createElement("div"),e.id=p.wait,t.append(e)),this.waitdiv=e}waitDesactivate(t=null,e="info"){this.waitdiv&&(t?this.waitdiv.innerHTML=`<div class="alert is-${e}">${t}</div>`:this.waitdiv.classList.add(d.AH.hide))}deferLoad(t,e){const s=t.querySelector(this.params.defer);s&&s.addEventListener("click",(i=>{this.fetchData(t,e),s.remove()}))}fetchData(t,e,s=0){this.waitActivate(t);const i=this.params.pagesize?this.params.pagesize:0;let n=e;this.params.fromid&&(n+="/"+this.params.fromid);let l=this.params.import?{typeimport:a().sanitize(this.params.import),window_start:s,window_size:i,gz:!0}:i?{window_start:s,window_size:i,listall:!!this.params.listall&&this.params.listall}:this.params.listall?{listall:!!this.params.listall&&this.params.listall}:{};const o=new URLSearchParams(window.location.search),c=this.cellidname+"s";if(c.length)for(const t of o.entries())c.indexOf(t[0])>=0&&(l[t[0]]=t[1]);Object.keys(l).length&&(n+="?"+new URLSearchParams(l)),this.dt=Date.now(),fetch(n,(0,r.Uc)()).then((t=>t.ok?t.json():Promise.reject(t))).then((async n=>{this.waitdiv&&(this.waitdiv.innerHTML=this.waitdiv.dataset.loaded?a().sanitize(this.waitdiv.dataset.loaded):d.lr.dataloaded),0===s?(console.log("seconds to fetch",(Date.now()-this.dt)/1e3),this.dt=Date.now(),await this.tableActivate(t,n)):n.length?this.domInsertRows(n):i=0,i>0&&this.fetchData(t,e,s+i)})).catch((t=>{this.waitDesactivate(t.status+" "+t.statusText,"error")}))}async dataToTable(t){if(t.data&&t.columns){let e;await this.convertColumns(t);let s=this.dom.tHead;s?s.querySelector("tr")?(e=s.querySelector("tr"),e.innerHTML=""):e=document.createElement("tr"):(s=document.createElement("thead"),e=document.createElement("tr"),this.dom.appendChild(s));let i=this.dom.tBodies.length?this.dom.tBodies[0]:null;i||(i=document.createElement("tbody"),this.dom.appendChild(i));const n=!t.hasOwnProperty("data")||t.hasOwnProperty("type")&&"json"===t.type;this.grid.columns.forEach(((t,s)=>{if(t.hidden)this.grid.hidden.push(s);else{const i=document.createElement("th");i.innerHTML=a().sanitize(t.label),t.sort&&(i.dataset.sort=t.sort),t.format&&(i.dataset.type=t.type),t.name&&(i.dataset.name=t.name),this.params.import&&["selectcells","what","autocomplete","parts","value"].forEach((e=>{t.hasOwnProperty(e)&&(i.dataset[e]=t[e])})),i.dataset.sortable=!!t.sortable,e.appendChild(i),this.grid.active.push(s)}})),s.appendChild(e);this.params.lastused&&this.params.lastused.length;n?(this.grid.data=[],t.data.forEach(((e,s)=>{const i=[];let a=0;Object.entries(t.columns).forEach((([t,s],n)=>{s.hasOwnProperty("emptydata")||(e.hasOwnProperty(t)?i[a]=e[t]:s.field&&e.hasOwnProperty(s.field)?i[a]=e[s.field]:i[a]=null,a++)})),this.grid.data.push(i)}))):this.grid.data=t.data;const l=this.dom.tFoot;if(0===this.grid.active.length)return i.innerHTML=`<tr><td>${this.labels.noRows}</td</tr>`,void(l&&l.remove());if(l&&l.querySelector("tr")){const t=l.querySelector("tr").childNodes;this.grid.hidden.forEach((e=>{t[e].remove()}))}this.renderTbody(i)}}tableToData(){if(!this.dom.querySelector("thead"))return;this.params.lastused&&this.params.lastused.length;this.dom.classList.add(h.hide);const t=this.dom.querySelectorAll("thead tr th").length?this.dom.querySelectorAll("thead tr th"):this.dom.querySelectorAll("thead tr td"),e=this.dom.querySelectorAll("tbody tr");function s(t){return t.childNodes.length?s(t.childNodes[0]):t.innerText}t.forEach(((t,e)=>{const i=Object.assign({},t.dataset);i.mask&&t.classList.add("hidden"),i.hidden&&(0,r.FB)(i.hidden)&&(i.hidden=!0,t.remove()),i.label=s(t),i.type&&(i.format=i.type,delete i.type),i.index=e,i.hidden?this.grid.hidden.push(e):this.grid.active.push(e),this.grid.columns.push(i)}));const i=this.getCellId(this.cellidname);e.forEach(((t,e)=>{i<0?t.dataset[this.cellidname]=e:e===i&&(t.dataset[this.cellidname]=this.getCellData(e,this.cellidname,i));const s=[];t.querySelectorAll("th,td").forEach(((t,e)=>{this.grid.columns[e].hasOwnProperty("mask")&&t.classList.add("hidden"),this.grid.hidden.indexOf(e)>=0&&t.remove(),s.push(t.innerText)})),this.grid.data.push(s)})),this.dom.querySelectorAll("tfoot tr th").forEach(((t,e)=>{this.grid.columns[e].hasOwnProperty("mask")&&t.classList.add("hidden"),this.grid.hidden.indexOf(e)>=0&&t.remove()})),this.dom.classList.remove(h.hide)}renderTbody(t){const e=this.grid.data.length;for(let s=0;s<e;s++){const e=this.createTableRow(this.grid.data[s],s);t.append(e)}}async tableActivate(t,e=null){this.on(this.eventnames.init,(()=>{this.dom.classList.remove(h.hide),this.waitDesactivate(),this.afterLoad&&this.afterLoad(),t.dataset.table=this.params.table=!0})),this.on(this.eventnames.load,(()=>{this.initSearch(),this.initSort(),this.initPlugins(t),console.log("plugin loaded",(Date.now()-this.dt)/1e3)})),this.on(this.eventnames.dismiss,(t=>{this.destroy()})),e?e=await this.dataToTable(e):await this.tableToData(),this.grid.data.length&&this.emit(this.eventnames.load),setTimeout((()=>{this.emit(this.eventnames.init),this.initialized=!0}),10),o[this.instanceid]=this}tableAppendRows(t){console.log("rows")}destroy(){this.dataImport&&(this.dataImport=null),this.dom=null,delete o[this.instanceid]}refresh(t){this.dataImport&&this.dataImport.selectors&&this.dataImport.selectors.forEach((t=>{this.disabled&&(this.disabled=!1)}))}labelFormatter(t){let e="";return["number","progress","decimal"].find((e=>e===t.format))&&(e=d.AH.right),t.subfield?`${t.label} <span class="sublabel">${t.sublabel}</span>`:t.label?`<span class="${e}">${t.label}</span>`:""}getCellId(t,e=null){let s=this.grid.columns.filter((e=>e.name===t));return s.length?s[0].index:-1}getCellData(t,e,s=null){return(s=null===s?this.getCellId(e):s)<0?null:this.grid.data.length&&this.grid.data[t]?this.grid.data[t][s]:null}rowAttributes(t,e){const s=this.getCellData(e,this.cellidname);return t.dataset[this.cellidname]=s,this.setRowAttributes&&(t=this.setRowAttributes(this,t,s)),t}createTableRow(t,e,s=!1){const i=document.createElement("tr");let a;return this.grid.columns.forEach((n=>{if(n.hasOwnProperty("hidden")&&!0===n.hidden)return;const l=t[n.index];n.hasOwnProperty("render")?(a=n.render(l,e,n.index),a.nodename=s?"TH":"TD",a=this.objToElement(a)):(a=s?document.createElement("th"):document.createElement("td"),a.appendChild(document.createTextNode(l))),i.appendChild(a)})),this.rowAttributes(i,e)}objToElement(t){if("#text"===t.nodename)return document.createTextNode(t.data);const e=document.createElement(t.nodename);if(t.hasOwnProperty("html")?e.innerHTML=t.html:e.textContent=t.data,t.hasOwnProperty("attributes"))for(const s in t.attributes)e.setAttribute(s,t.attributes[s]);return t.hasOwnProperty("childnodes")&&t.childnodes.forEach((t=>{e.appendChild(this.objToElement(t))})),e}setTextNode(t){return{nodename:"#text",data:t}}async getFormatters(){let t={controls:(t,e,s,i={})=>{const a=this.grid.columns[s],n=this.getCellData(e,a.field),l=a.actions?a.actions:null;if(!l)return"";let r=[];return Object.entries(l).forEach((([t,e])=>{r.push({nodename:"A",attributes:{class:`btn is-${t} `,href:`${e.link}${n}`},childnodes:[this.setTextNode(e.label)]})})),i.hasOwnProperty("attributes")||(i.attributes={}),i.attributes.class=d.AH.component.table.controls,i.childnodes=r,i},select:(t,e,s,i={})=>{const a=this.grid.columns[s];return t=isNaN(t)?this.getCellData(e,a.field):t,i.childnodes=[{nodename:"INPUT",attributes:{type:"radio",name:`${this.instanceid}select`,value:String(t)}}],i},selectmultiple:(t,e,s,i={})=>{const a=this.grid.columns[s];return t=isNaN(t)&&a.hasOwnProperty("field")?this.getCellData(e,a.field):t,i.childnodes=[{nodename:"INPUT",attributes:{type:"checkbox",name:`${this.instanceid}select[]`,value:String(t)}}],i},decimal:(t,e,s,i={})=>(isNaN(t)&&(t=0),(t=parseFloat(t).toFixed(2))-parseInt(t)==0&&(t=parseInt(t)),i.hasOwnProperty("attributes")||(i.attributes={}),i.attributes.class=d.AH.number,i.childnodes=[this.setTextNode(t)],i),number:(t,e,s,i={})=>(isNaN(t)&&(t=0),i.hasOwnProperty("attributes")||(i.attributes={}),i.attributes.class=d.AH.number,i.childnodes=[this.setTextNode(t)],i),check:(t,e,s,i={})=>{switch(isNaN(t)&&(t=""),t){case!0:case"Y":case 1:t="";break;default:t="no-"}const a={nodename:"I",attributes:{class:`icon-sm  icon-${t}check `},childnodes:[]},n=this.grid.columns[s],l=this.getCellData(e,this.cellidname);return n.hasOwnProperty("toggle")?i.childnodes=[{nodename:"A",attributes:{"data-request":"toggle","data-action":`${n.toggle.link}/${l}`,href:"javascript:void()"},childnodes:[a]}]:i.childnodes=[a],i},text:(t,e,s,i={})=>(null===t?i.childnodes=[]:(t=t.replaceAll("\r\n",", "),i.childnodes=""!==t?[{nodename:"DIV",attributes:{class:d.AH.component.table.tip},childnodes:[this.setTextNode(t)]}]:[]),i),default:(t,e,s,i={})=>(i.childnodes=null===t||""===t?[]:[this.setTextNode(t)],i)},e=null;switch(this.params.from){case"collectionlist":e=await s.e(243).then(s.bind(s,243)),this.cellidname=d.Jn.id;break;case"prjlist":e=await s.e(942).then(s.bind(s,8942)),this.cellidname=d.Jn.projid;break;case"prjsamplestats":e=await s.e(853).then(s.bind(s,8853)),this.cellidname=d.Jn.sampleid;break;case"prjpredict":e=await s.e(702).then(s.bind(s,9702)),this.cellidname=d.Jn.projid}return e?{...t,...e.default(this)}:t}async convertColumns(t){const e=t.columns?t.columns:this.params.columns?JSON.parse(this.params.columns):null;if(!e)return;const s=await this.getFormatters(),i=[];Object.entries(t.columns).forEach((([t,e])=>{e.hasOwnProperty("emptydata")||i.push(t)}));const a=(t,e,a)=>{if(!e)return{index:a,name:t,hidden:!0};let n={index:a,name:t,label:this.labelFormatter(e),sortable:!0};n.index=e.hasOwnProperty("emptydata")?i.indexOf(e.emptydata):i.indexOf(t),e.notsortable?n.sortable=!1:e.sortable&&(n.sort=n.sortable),n.searchable=!n.notsearchable,e.hidden&&(n.hidden=(0,r.FB)(e.hidden)),["number","decimal"].find((t=>t===e.format))&&(n.type="number");if("select"===t){(e.select&&"controls"==e.select?"controls":e.selectcells?"imports":e.select)&&(n={...e,...n},n.sortable=n.searchable=!1)}if(!e.hasOwnProperty("hidden")){const t=e.select&&e.select==d.Jn.controls?d.Jn.controls:e.selectcells?d.Jn.imports:e.select,i=e.format?e.format:e.subfield?e.subfield:t||"default";s&&s[i]&&(n.render=s[i])}return n};this.grid.columns=Object.entries(e).map((([t,e],s)=>a(t,e,s)))}initEvents(){this.on(this.eventnames.update,(()=>{this.dom.classList.contains(h.hide)&&this.dom.classList.remove(h.hide)}))}initPlugins(t){if(this.grid.data.length&&(this.params.import&&this.initImport&&this.initImport(this),this.params.expand&&this.makeExpandable(t),this.params.export&&this.makeExportable(t),this.params.details||this.dom.querySelector(p.details)?this.initDetails():this.initEvents(),this.params.onselect&&this.initSelect(t),this.dom.querySelector(p.tip)&&this.initTips(),this.dom.querySelectorAll("thead [data-altsort]").length&&this.initAlternateSort(this.dom.querySelectorAll("thead [data-altsort]")),this.params.filters)){const t=this.wrapper.querySelector(p.top);if(t&&t.children.length){const e=document.querySelector(p.filters);e&&t.prepend(e)}}}initSort(){const t=this.dom.querySelectorAll("thead th");let e=0;this.grid.columns.forEach(((s,i)=>{if(!s.hasOwnProperty("hidden")){if(s.sortable){const i=t[e],a=document.createElement("a");a.classList.add(p.sorter.substr(1)),a.appendChild(i.childNodes[0]),i.appendChild(a),i.childNodes.forEach((t=>{i.appendChild(t)})),a.addEventListener("click",(t=>{if(t.stopImmediatePropagation(),!0===this.sorting||!0===this.searching)return t.preventDefault(),!1;this.sortColumn(i,s.index)}))}e++}})),this.sorting=!1,this.on(this.eventnames.sorting,((t,e)=>{this.plugins.hasOwnProperty("jsDetail")&&this.plugins.jsDetail.activeDetail(!1),this.dom.querySelectorAll(".table-sorter").forEach(((t,s)=>{t.classList.add(s===e?d.AH.wait:d.AH.disabled)})),this.sorting=!0})),this.on(this.eventnames.sorted,((t,e)=>{this.dom.querySelectorAll(".table-sorter").forEach(((t,s)=>{t.classList.remove(s===e?d.AH.wait:d.AH.disabled)})),this.sorting=!1}))}sortColumn(t,e,s=null){s=null===s?!t.classList.contains(h.ascending)&&(!!t.classList.contains(h.descending)||!t.dataset.sort):s,t.classList.toggle(h.ascending),t.classList.toggle(h.descending),this.emit(this.eventnames.sorting,s,t.cellIndex);let i=this.grid.data.map(((t,s)=>{const i=(0,r.vZ)(t[e])?JSON.stringify(t[e]):Array.isArray(t[e])?t[e][0]:t[e];return{value:"string"==typeof i?i.toLowerCase():null===i?0:i,row:s}}));if(!1===s?(t.classList.remove(h.ascending),t.classList.add(h.descending),t.setAttribute("aria-sort","descending")):(t.classList.remove(h.descending),t.classList.add(h.ascending),t.setAttribute("aria-sort","ascending")),void 0!==this.dom.dataset.lastth&&t.cellIndex!=this.dom.dataset.lastth){const t=this.dom.querySelectorAll("thead th");t[this.dom.dataset.lastth].classList.remove(h.descending),t[this.dom.dataset.lastth].classList.remove(h.ascending),t[this.dom.dataset.lastth].removeAttribute("aria-sort")}this.dom.dataset.lastth=t.cellIndex;const a=new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"});i.sort(((t,e)=>a.compare(s?t.value:e.value,s?e.value:t.value)));const n=this.dom.querySelector("tbody"),l=n.cloneNode(),d=n.querySelectorAll("tr");n.innerHTML="";const o=[];i.forEach(((t,e)=>{l.appendChild(d[t.row]),o.push(this.grid.data[t.row])})),this.grid.data=o,this.dom.replaceChild(l,n),this.emit(this.eventnames.sorted,s,t.cellIndex)}tableSearch(t,e=!1){let s=function(t,e){t=function(t,e){return e?t:t.toLowerCase()}(t,e);let s,i=[];for(;null!==(s=t.match(/"([^"]+)"/));)i.push(s[1]),t=t.substring(0,s.index)+t.substring(s.index+s[0].length);return(t=t.trim()).length&&(i=i.concat(t.split(/\s+/))),i}(t.value),i=this.grid.data,a=[];const n=this.dom.querySelectorAll("tbody tr"),l=this.getCellId(this.cellidname);s.forEach((t=>{a=[],i=i.filter(((s,i)=>{if(s.filter((s=>{switch(typeof s){case"object":s=s||"";try{s=JSON.stringify(s)}catch(t){console.log("search",t),s=""}break;case"array":s=s.join(" ");break;default:s=String(s)}return(e?s.indexOf(t)>-1:s.toLowerCase().indexOf(t))>-1})).length>0)return l<0?a.push(String(i)):a.push(String(s[l])),s}))})),n.forEach(((t,e)=>{const i=null!==t.dataset[this.cellidname]?t.dataset[this.cellidname]:t.cells[l].textContent;s.length>0&&0===a.length||a.indexOf(i)<0?t.hidden=!0:t.hidden=!1}))}initSearch(){if(this.grid.data.length<10)return this.toggleAddOns();this.toggleAddOns([p.search+" input"],!0),this.searching=!1;const t=this.wrapper.querySelector(p.search+" input");if(!t)return;let e="";const s=(0,r.sg)((t=>{e=t.value,this.tableSearch(t)}),500);t.addEventListener("keyup",(t=>{t.preventDefault(),s(t.currentTarget)})),t.addEventListener("click",(t=>{e!==t.currentTarget.value&&s(t.currentTarget)}));let i=!1;this.on(this.eventnames.search,((t,e)=>{this.plugins.hasOwnProperty("jsDetail")&&this.plugins.jsDetail.activeDetail(!1),this.searching=!0})),this.on(this.eventnames.searchend,((t,e)=>{this.searching=!1})),this.on(this.eventnames.update,(()=>{!1===i&&(i=!0,setTimeout((()=>{refresh_details(),delete this.dom.dataset.issearching,i=!1}),300))}))}initSelect(t){const e=this.dom.querySelectorAll('input[name^="'+this.instanceid+'"]');if(0===e.length)return;e[0].name;let s=t.querySelector("."+h.selectaction);if(!s)return;document.body.append(s),s.querySelector("a").addEventListener("click",(t=>{let i=[];e.forEach((t=>{t.checked&&i.push(t.value)})),s.dataset.input?(document.getElementById(s.dataset.input).value=i.join(","),s.dataset.form&&document.getElementById(s.dataset.form).submit()):t.currentTarget.href=this.params.onselect+encodeURI(i.join(","))}));const i=s.querySelector("[data-dismiss]");i&&i.addEventListener("click",(t=>{t.preventDefault(),t.stopImmediatePropagation(),a(null,null)}));const a=(t=null,e=null,a=!1)=>{if(s.dataset.close&&(document.body.append(s),i.classList.remove("hidden"),s.classList.add(h.absinput)),null!==t&&null!==e)s.classList.remove(d.AH.hide),s.style.top=t+"px",s.style.left=e+"px";else if(!0===a)s.classList.add(d.AH.hide),delete s.dataset.close;else{s.dataset.close=!0,i.classList.add("hidden");(this.wrapper.querySelector(p.top)?this.wrapper.querySelector(p.top):this.wrapper).prepend(s),s.classList.remove(h.absinput)}};e.forEach((t=>{t.addEventListener("change",(e=>{t.checked?a(t.offsetTop,t.offsetLeft):0===this.dom.querySelectorAll('input[name^="'+this.instanceid+'"]:checked').length&&a(null,null,!0)}))})),this.dom.querySelectorAll('input[name^="'+this.instanceid+'"]:checked').length>0&&(s.classList.remove(d.AH.hide),a(null,null))}async initDetails(){const t=this.wrapper,e=t.querySelector("#"+h.tipinline)?t.querySelector("#"+h.tipinline):h.tipinline;if(!m.JsDetail){const{JsDetail:t}=await s.e(329).then(s.bind(s,329));m.JsDetail=t}const i=new m.JsDetail(e,t,{waitdiv:this.waitdiv}),a=(t,e=null)=>{i.activeDetail(!1),e&&e()},n=(t,e=null)=>{if(i.activeDetail(!0),i.current&&i.current===t)i.expandDetail(t),e&&e();else{i.current&&i.current.querySelector("summary").click();const s=this.params.detailsurl+t.dataset.id+"?"+new URLSearchParams({partial:!0});i.activeDetail(!0),fetch(s,(0,r.Uc)()).then((t=>t.text())).then((s=>{i.expandDetail(t,s),e&&e()})).catch((t=>{console.log("request",t)}))}};if(!m.JsAccordion){const{JsAccordion:t}=await s.e(148).then(s.bind(s,5148));m.JsAccordion=t}this.plugins.jsDetail=i,(()=>{this.dom.classList.contains(h.hide)&&this.dom.classList.remove(h.hide);const t=this.dom.querySelectorAll(p.details);t&&t.forEach((t=>{t.dataset.id&&(t=new m.JsAccordion(t,n,a,i.detail))}))})()}initAlternateSort(t){let e,s=[];t.forEach((t=>{const e=t.closest("th");Object.entries(t.dataset).forEach((([s,i])=>{e.dataset[s]=i,t.classList.add("inline-block")})),s.push(e)}));const i=t=>{let s;s=parseInt(t.dataset.sortactive)===parseInt(e)?t.classList.contains(h.ascending)?"desc":(t.classList.contains(h.descending),"asc"):t.classList.contains(h.ascending)?"asc":t.classList.contains(h.descending)?"desc":"asc",this.sortColumn(t,e,s)};(t=s).forEach((t=>{const s=t.dataset.altsort?t.dataset.altsort.split(","):null;if(!s)return;const a=t.querySelector(p.sorter);a&&a.classList.add(h.disabled);const n=t.querySelector(p.sorton);t.append(n);const l=t.querySelectorAll('[role="button"]');t.addEventListener("click",(e=>{e.preventDefault(),i(t)}),!1);const r=(t,i)=>{e=0===i?this.grid.columns.findIndex((e=>e.index===t.cellIndex)):this.grid.columns.findIndex((t=>t.name===s[i-1]))};t.dataset.sortactive=t.cellIndex,l.forEach(((e,s)=>{e.addEventListener("click",(e=>{e.preventDefault();const i=e.currentTarget.parentElement.querySelector("."+d.AH.active);i&&i.classList.remove(d.AH.active),e.currentTarget.classList.add(d.AH.active),r(t,s)}))})),t.dataset.tip&&Object.values(this.dom.rows).forEach(((e,i)=>{if(0===i)return;const a=this.grid.columns.findIndex((e=>e.name===s[parseInt(t.dataset.tip)-1]));0!==e.cells.length&&a!==t.cellIndex&&(e.cells[t.cellIndex].addEventListener("mouseenter",(t=>{const s=document.createElement("div");s.setAttribute("class",h.tipover),s.innerHTML=e.cells[a].innerHTML,t.currentTarget.append(s)})),e.cells[t.cellIndex].addEventListener("mouseout",(t=>{const e=t.currentTarget.querySelector(p.tipover);e&&e.remove()})))}))}))}closeShowfull(){const t=document.querySelector("."+d.AH.component.table.tip+"."+h.showfull);t&&t.click()}makeExpandable(t){if(t.querySelector("table").offsetHeight<t.offsetHeight)return;const e=document.createElement("div");e.classList.add("button-expand"),e.classList.add("border-t"),e.title=this.params.expand,e.innerHTML=`<span class="small-caps block mx-auto p-0">${this.params.expand}</span><i class="clear-both p-0 mx-auto icon icon-chevron-down hover:fill-secondblue-500"></i><span class="small-caps block mx-auto p-0 hidden">${this.params.shrink}</span>`,t.parentElement.insertBefore(e,t.nextElementSibling),t.classList.add("overflow-y-hidden"),t.classList.remove("max-tabstat-h"),t.parentElement.style.height="auto";const s=parseInt(this.wrapper.querySelector("tbody tr").offsetHeight)*(this.params.maxrows?this.params.maxrows:20);t.classList.add("max-h-["+s+"px]"),t.style.height=s+"px",e.addEventListener("click",(i=>{this.closeShowfull(),e.classList.toggle("border-t"),e.classList.toggle("border-b");const a=e.querySelector("i");a.classList.toggle("icon-chevron-down"),a.classList.toggle("icon-chevron-up"),t.classList.toggle("overflow-y-hidden"),t.classList.toggle("max-h-["+s+"px]"),e.querySelectorAll("span").forEach((t=>{t.classList.toggle("hidden")})),t.classList.contains("overflow-y-hidden")?t.style.height=s+"px":t.style.height="auto"}))}makeExportable(t){const e=document.createElement("div");e.classList.add(p.export.slice(1)),e.classList.add("is-pick"),e.innerHTML=`<i class="icon icon-arrow-down-on-square"></i><span>${this.params.exportlabel?this.params.exportlabel:"export statistics "}</span>`,this.wrapper.prepend(e);this.grid.columns;let i=[];this.grid.columns.forEach(((t,e)=>{"select"===t.name&&i.push(t.index)})),e.addEventListener("click",(async e=>{if(e.preventDefault(),this.dynamics||(this.dynamics={}),!this.dynamics.exportCSV){const{exportCSV:t}=await s.e(23).then(s.bind(s,5023));this.dynamics.exportCSV=t}let a=this.dynamics.exportCSV(this,{download:!1,linedelimiter:"\n",columndelimiter:"\t",skipcolumns:i});a=encodeURI(`data:text/tsv;charset=utf-8,${a}`),(0,r.pd)(a,(t.id?t.id:"stats_proj")+".tsv")}))}initTips(){let t=null;this.dom.querySelectorAll(p.tip).forEach((e=>{e.addEventListener("mouseenter",(t=>{(e.classList.contains(h.showfull)||e.scrollHeight>e.offsetHeight)&&(e.style.cursor="pointer")})),e.addEventListener("click",(s=>{const i=window.getComputedStyle(e.parentElement),a=window.getComputedStyle(e.parentElement);if(e.classList.contains(h.showfull))e.classList.remove(h.showfull),e.parentElement.style.minHeight="none",e.parentElement.style.height="auto",e.style.maxWidth=e.style.minWidth="none",e.dataset.p&&(e.style.paddingLeft=e.dataset.p.l,e.style.paddingRight=e.dataset.p.r,e.style.paddingTop=e.dataset.p.t,e.style.paddingLeft=e.dataset.p.b),t=null;else if(e.scrollHeight>e.offsetHeight){t&&t.classList.remove(h.showfull);const s=parseInt(e.clientHeight);e.parentElement.style.minHeight=e.parentElement.style.height=(s<parseInt(i.maxHeight)?s:parseInt(i.maxHeight))-2*parseInt(i.padding)+"px",e.dataset.p||(e.dataset.p={l:a.paddingLeft,r:a.paddingRight,t:a.paddingTop,b:a.paddingBottom}),e.style.maxWidth=e.style.minWidth=e.clientWidth+"px",e.classList.add(h.showfull),e.style.top=parseInt(e.offsetTop)-parseInt(i.padding)+"px",t=e}}))}))}toggleAddOns(t=null,e=!1){(t=t||[p.search+" input",p.export]).forEach((t=>{(t=this.wrapper.querySelector(t))&&(e?t.classList.remove(d.AH.hide):t.classList.add(d.AH.hide))}))}}},2634:()=>{}}]);