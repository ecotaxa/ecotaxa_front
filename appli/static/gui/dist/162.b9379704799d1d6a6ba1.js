/*! For license information please see 162.b9379704799d1d6a6ba1.js.LICENSE.txt */
"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[162],{4162:(e,t,s)=>{s.d(t,{JsScanDir:()=>i});var n=s(4860);let r=null;class i{_events={};eventnames={complete:"complete",processed:"file.processed",error:"file.error"};nextaction;constructor(){return r||(this.init(),r=this,r)}init(e){(0,n.UO)(this),this.on(this.eventnames.error,(e=>{console.log("scandir receive error message",e)})),this.on(this.eventnames.processed,(async e=>{console.log("e",e)}))}async processFile(e,t=null){console.log("process scandir",e),t&&await t()}stopOnError(e){console.log("err",e)}fileType(e){const t=new Uint8Array(e);let s=[];for(let e=0;e<4;e++)s.push(t[e].toString(16));return{input:t,mimetype:(e=>{switch(e){case"89504E47":return"image/png";case"47494638":return"image/gif";case"25504446":return"application/pdf";case"FFD8FFDB":case"FFD8FFE0":case"FFD8FFE1":return"image/jpeg";case"504B0304":return"application/zip";case"EFBBBF22":return"text/tsv";default:return console.log("unknownsign",e),"unknown"}})(e=s.join("").toUpperCase())}}async readDirectory(e,t){const s=this;let n=!1,r=[];const i=onerror||(e=>{console.log("on_error",e),n||(n=!0)}),a=e.createReader(),o=async function(e){if(e.length&&!n)r=[...r,...e],await a.readEntries(o,i);else if(n)console.log("treat error readdir");else{const e=async function(){if(t&&0===r.length)t();else{const t=r.shift();t.isDirectory?await s.readDirectory(t,e):await s.processFile(t,e)}};await e()}};await a.readEntries(o,i)}async processEntries(e,t,s){const n=this,r=async()=>{if(e.length){const s=await e.shift(),i=`${t}/${s.name}`,a=s.kind?s.kind:s instanceof File?"file":"directory";if("file"===a)s.webkitRelativePath||Object.defineProperty(s,"webkitRelativePath",{configurable:!0,enumerable:!0,get:()=>i}),s instanceof File?s.file=async e=>{await e(s,i)}:s.file=async e=>{s.getFile().then((async t=>{await e(t,i)}))},await n.processFile(s,r);else if("directory"===a){const e=await Array.fromAsync(s.values());await n.processEntries(e,i,r)}}else s&&s()};await r()}}}}]);