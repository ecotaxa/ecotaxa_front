/*! For license information please see 523.a2457acdc08289c0bf08.js.LICENSE.txt */
"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[523],{5523:(e,t,i)=>{i.d(t,{ImportList:()=>n});var r=i(7114),s=i(4860);function n(e,t=null){const i=[],n=[],l=e.getCellId(e.cellidname),a=["instrument","access"],o=[];function c(){if(!e.dataImport)return;const t=e.dataImport;if(t.targetimport){let e=null;"select"===t.targetimport.tagName.toLowerCase()?(e=[...t.targetimport.options].filter((e=>e.selected)),e=e.map((e=>parseInt(e.value)))):e=t.targetimport.value,t.selectors.forEach((t=>{e.indexOf(parseInt(t.value))>=0&&t.click()}))}}function d(t,r){if(o.length!==a.length)return;let s=e.grid.data;i.push(t[l]),s=s.filter(((e,i)=>{let s=!0;i!==r&&o.forEach((i=>{s=s&&t[i]===e[i]}));const a=String(e[l]);return s&&-1===n.indexOf(a)&&n.push(a),s})),e.displaySelected(o,n,l,!0)}function u(t,r){let s=i.indexOf(t[l]);s>-1&&i.splice(s,1),s=n.indexOf(String(t[l])),s>-1&&n.splice(s,1),0===i.length?e.displaySelected([],[],l,!0):e.displaySelected(o,n,l,!0)}if(a.forEach((t=>{const i=e.getCellId(t);i>-1&&o.push(i)})),e.toggle=function(e,t,i,s=!1){s?t?e.classList.add(r.AH.hide):e.classList.remove(r.AH.hide):e.hidden=t},!t)return{filterByRecord:d,resetFilter:u,initList:c};t.filterByRecord=d,t.resetFilter=u,t.compileProjectRecords=async function(t=0){const i=e.dataImport.importzone.tomselect,r=i?i.items:Array.from(e.dataImport.importzone.selectedOptions).map((e=>e.value));if(0===r.length)return null;const n="/gui/collection/aggregated?"+new URLSearchParams({project_ids:r.join(","),simulate:"y"}),l=await fetch(n,(0,s.Uc)({method:"GET"}));let a=await l.json();a.excluded,delete a.excluded;const o=new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"}),c="creator";if(0===t&&Object.keys(a).indexOf(c+"_users")>=0){const e=a[c+"_users"].map((e=>({key:e.id,value:e.name,text:e.name+" "+e.email})));a[c+"_persons"]=e,delete a[c+"_users"],a[c+"_persons"].sort(((e,t)=>o.compare(e.value,t.value)))}return a},t.initList=c}}}]);