/*! For license information please see 265.3065804750510106e806.js.LICENSE.txt */
"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[265],{501(t,e,s){s.d(e,{w:()=>r});s(9418);var n=s(7114),i=s(4860);function r(){const t=(0,i.UP)(),e=(0,i.xJ)("div",{id:t,text:"",class:n.AH.tooltip},document.body);return{applyTo:function(t,s,i=null){t.addEventListener("mouseenter",()=>{(null===i||i())&&(!function(t,e,s={placement:"bottom-start",offset:{x:2,y:2}}){const n=t.getBoundingClientRect(),i=s.placement.split("-");let r=parseInt(n.top);switch(i[0]){case"bottom":r+=parseInt(n.height);break;case"center":r+=Math.round(parseInt(n.height)/2)}let a=parseInt(n.left);switch(i[1]){case"center":a+=Math.round(parseInt(n.width)/2);break;case"end":a+=parseInt(n.width)}Object.assign(e.style,{left:`${a}px`,top:`${r}px`})}(t,e,{placement:"top-center"}),setTimeout(function(){e.classList.remove(n.AH.hide),e.textContent=s},100))}),t.addEventListener("mouseout",()=>{(null===i||i())&&setTimeout(function(){e.classList.add(n.AH.hide),e.textContent=""},600)})}}}},1265(t,e,s){s.a(t,async(t,n)=>{try{s.d(e,{JsImport:()=>d});s(9418);var i=s(8949),r=s(4860),a=s(7114),o=s(2438),l=s(3438),c=t([i,o,l]);function d(t,e={}){let n=null;if(!(t=t instanceof HTMLElement?t:document.querySelector(t)))return;e={selectors:{typeimport:"typeimport",inputname:"file_to_load",showfiles:".showfiles",importzoneid:"import-list",sourcezone:"dirlist"},url:{import:"gui/import",dirlist:"gui/files"},browse:["directory","file"],textimport:"to import",...e};let c={};c.dirlist=t.dataset.dirlist?t.dataset.dirlist:e.url.dirlist,c.import=t.dataset.import?t.dataset.import:e.url.import,e.selectors.importzoneid=t.dataset.importzoneid?t.dataset.importzoneid:e.selectors.importzoneid,e.browse=t.dataset.browse?t.dataset.browse.split(","):e.browse,e.textimport=t.dataset.textimport?t.dataset.textimport:e.textimport;t.querySelector('[type="submit"]');let d,h="select",p=document.getElementById(e.selectors.inputname);async function u(r=!1){const a=document.getElementById(e.selectors.sourcezone);if(a){if(!d){const{JsMyFiles:r}=await s.e(7).then(s.bind(s,8388));d=new r(a,{import:c.toimport,url:c.dirlist,browse:e.browse,upload:{label:a.dataset.uploadlabel?a.dataset.uploadlabel:"upload",callback:()=>{g(!1)}}}),d.eventnames.clearother="clearother",o.j.on(d.eventnames.clearother,t=>{m()},d.uuid),o.j.on(h,t=>{d.detachDropzone()},d.uuid),f(d.jsDirList,d.uuid);const p=function(){m(),g(!1)};d.jsDirList.detachcallback=p,t.querySelectorAll("[data-import]").forEach(async t=>{t.dataset.request=t.dataset.import,await i.p.makeRequest(t),t.addEventListener("click",t=>{g(null!==n)});const e=t.previousElementSibling||t.nextElementSibling;if(e&&e.dataset.summary&&e.addEventListener("click",t=>{g(!1)}),t.jstree){t.jstree.entrycontrols.options.controls={},t.jstree.setDetachcallback(p);const e=t.dataset.exclude?t.dataset.exclude.split(","):[];f(t.jstree,t.jstree.uuid,[l.gt.branch,l.gt.node],e)}});const u=t.querySelector(".js-accordion")?t.querySelector(".js-accordion"):t.querySelector(".js-tabs");if(u&&u.dataset.detail){u.querySelectorAll(u.dataset.detail).forEach(t=>{t.emitevent=()=>{m()}})}}!0===r&&(()=>{let t=undefined.split("-");t=t.map(t=>new Set([...filter_files[t]?filter_files[t]:[]])),d.container.querySelectorAll("[data-ftype]").forEach(e=>{t.has(e.dataset.ftype)?e.classList.remove("disabled"):e.classList.add("disabled")})})()}}function m(){null!==n&&(n.setSelected(!1),n.active=!0,n.emitEvent(),n=null)}function f(t,s,i=null,a=[]){t.entrycontrols.removeControls();const c={import:{action:"import",class:["control-select"],exclude:a,typentries:i||[l.gt.branch],text:e.toselect?e.toselect:"select to import",callback:function(s){n&&(delete n.label.dataset.selected,n.setSelected(!1));const i=t.getActiventry();if(n===i)return void(n=null);i.options.css.selected,i.setSelected(!0),i.label.dataset.selected=e.textimport,t.entrycontrols.showControls(!1),n=i}}};c.import.action=function(e){t.activentry&&t.activentry.setSelected(!1),function(t){p.value=t.getCurrentPath().join(r.hx),g()}(e),o.j.emit(h,{value:!1},s)},t.entrycontrols.options.controls={...c,...t.entrycontrols.options.controls},t.entrycontrols.createControls(),t.entrycontrols.activateControls()}function g(e=!0){const s=t.querySelector('[type="submit"]');e?(s.classList.remove("hide"),s.disabled=!1):s.disabled=!0}!function(){if(!p){const s=t.dataset.importzone?t.dataset.importzone:e.selectors.importzone;let n=document.getElementById(s);null===n&&(n=(0,r.xJ)("div",{id:s},t)),p=(0,r.xJ)("input",{type:"hidden",id:e.selectors.inputname,name:e.selectors.inputname,class:"form-input",required:!0},n);const i=(0,r.xJ)("div",{class:"response-summary"},n);(0,r.xJ)("div",{id:"total-objects",class:a.AH.info,data:{text:"Total objects"}},i),(0,r.xJ)("div",{id:"total-tsv",class:a.AH.info,data:{text:"Total TSV"}},i)}}(),t.querySelectorAll('input[name="'+e.selectors.typeimport+'"]').forEach(t=>{t.addEventListener("change",e=>{e.currentTarget.checked&&(t=e.currentTarget.value,u(!0))})}),t.formsubmit.addHandler("submit",async()=>""!==p.value||(alert("nothing to upload"),!1)),u()}[i,o,l]=c.then?(await c)():c,a.AH.displayimport="displayimport",n()}catch(h){n(h)}})},3438(t,e,s){s.a(t,async(t,n)=>{try{s.d(e,{HK:()=>u,Pc:()=>p,gt:()=>h,v3:()=>m});var i=s(4860),r=s(7114),a=s(7104),o=s(2438),l=s(501),c=t([a,o]);[a,o]=c.then?(await c)():c;const d=(0,l.w)(),h=Object.freeze({node:"N",branch:"B",root:"R",discard:"D",discarded:"X"}),p={selector:"[data-name]",tags:{tag:"ul",subtag:"li",label:"span"},selectors:{entries:".entries"},draggables:[],prefix:"entry",css:{on:"on",entryN:"entryN",entryB:"entryB",entryR:"entryR",entryD:"entryD",editable:"editable",dragging:"dragging",dragover:"dragover",dragitem:"dragitem",selected:"selected"},event:{name:"eventEntry"}};class u{eventnames={attach:"attach",control:"control"};name;type;label;entries=[];event={listener:window,name:p.event.name,init:{bubbles:!1,cancelable:!0}};constructor(t,e={}){return this.name=t.name,this.type=t.type,this.id=t.id,this.parent=t.parent,this.options={...p,...e},this.uuid=(0,i.UP)(),this.eventnames={...this.eventnames,...this.options.eventnames},this.label=e.label?e.label:null,this.event={name:p.event.name,listener:e.listener?e.listener:this.uuid},this.init(t),this}init(t){const e={name:this.name,type:this.type};null!==this.label&&(e.label=this.label);const s=(0,i.xJ)(this.options.tags.subtag,{draggable:this.isDraggable(),dataset:e}),n=`${this.options.prefix}${this.type}`;[h.branch,h.root,h.discard].indexOf(this.type)>=0&&(this.icon=(0,i.xJ)("span",{class:"ico-"+n},s)),this.label=(0,i.xJ)(this.options.tags.label,{class:n,text:t.label?t.label:t.name},s),this.container=s,this.loaded=this.container.dataset.loaded=!1,this.initEvents()}initEvents(){this.addListeners()}getParent(){return this.parent}getLabelElement(){return this.label}getParentElement(){return this.container.parentElement.closest(this.options.selector)}getEntries(){return this.entries}getEntriesElement(t=!1){let e=this.container.querySelector(this.options.selectors.entries);return t&&null===e?(0,i.xJ)(this.options.tags.tag,{class:this.options.selectors.entries.substr(1)},this.container):e}appendEntry(t){if(t.parent&&t.parent.entries){const e=t.parent.entries.indexOf(t);delete t.parent.entries[e]}t.parent=this,this.entries.push(t);return this.getEntriesElement(!0).append(t.container),t}newEntry(t){return new u(t,this.options)}setAttributes(t){return t}extraStyles(t){}setDiscard(){}createEntry(t){this.options.css.icons=[],t=this.setAttributes(t),this.extraStyles(t);const e=this.newEntry(t,this.options);return this.appendEntry(e),e.addListeners(),e.setDiscard(),e}findEntry(t){const e=this.getEntries();for(const s of e)if(s.name===t)return s;return null}createListEntries(t){this.getEntriesElement(!0);t.forEach(t=>{t.forEach(t=>{this.createEntry(t)})})}removeEntries(){this.entries=[];const t=this.getEntriesElement();t&&t.remove()}isActive(){return this.active}toggleActive(){this.setOn(!this.active)}toggleOpen(){this.setOpen(!this.open)}setSelected(t=!0){const e=this.options.css.selected;!0===t?this.container.classList.add(e):this.container.classList.remove(e),this.setOn(t)}setOn(t=!0){this.active=t}setOpen(t=!0){const e=()=>{this.open=t,!0===t?this.container.classList.add(this.options.css.on):this.container.classList.remove(this.options.css.on)};!this.loaded&&t?this.list().then(()=>{e()}):e()}setOff(){this.setSelected(!1)}getListeners(){let t=[];let e;return e=this.type===h.node?t=>{t.stopImmediatePropagation(),this.toggleActive(),this.emitEvent()}:t=>{t.stopImmediatePropagation(),this.branchListener(()=>{this.emitEvent(this.eventnames.attach)})},t.unshift({name:"click",target:"label",func:e}),[h.root,h.branch,h.discard].indexOf(this.type)>=0&&(e=t=>{t.stopImmediatePropagation(),this.toggleOpen()},t.unshift({name:"click",target:"icon",func:e}),d.applyTo(this.icon,"click to display children of this entry")),d.applyTo(this.label,"click to activate tools on this entry",()=>!0!==this.active),t}isBranch(t=!0){const e=[h.branch];return t&&e.indexOf(h.root)<0&&e.push(h.root),e.indexOf(this.type)>=0}isDiscarded(){return[h.discarded].indexOf(this.type)>=0}emitEvent(t=null,e=null){const s={entry:this};t&&(s.action=t),e?s.event=e:e=this.eventnames.control,o.j.emit(this.event.name,s,this.event.listener)}moveHandlers(){return[{name:"dragstart",func:t=>{this.handleDragStart(t)}},{name:"dragend",func:t=>{this.handleDragEnd(t)}}]}dropHandlers(){return[{name:"dragover",func:t=>{this.handleDragOver(t)}},{name:"drop",func:t=>{this.handleDrop(t)}}]}branchListener(t=null){this.toggleActive(),this.isActive()&&this.branchActivate(t).then(()=>{this.emitEvent()})}addListeners(){const t=this.getListeners();for(const e of t){("label"===e.target?this.getLabelElement():"icon"==e.target?this.icon:this.container).addEventListener(e.name,e.func)}}removeListeners(t){for(const e in t){("label"===e.target?this.getLabelElement():this.container).removeEventListener(e.label,e.func)}}destroy(){this.container.remove()}handleDragStart(t){t.stopImmediatePropagation(),this.container.classList.add(this.options.css.dragging),t.dataTransfer.effectAllowed="move",this.emitEvent("dragstart",t)}handleDragOver(t){t.stopPropagation(),t.preventDefault(),this.emitEvent("dragover",t)}handleDragEnd(t){t.stopPropagation(),t.preventDefault(),this.container.classList.remove(this.options.css.dragging),this.emitEvent("dragend",t)}resetDragOver(){document.querySelectorAll("."+this.options.css.dragover).forEach(t=>{t.classList.remove(this.options.css.dragover)})}handleDrop(t){t.stopImmediatePropagation(),this.emitEvent("drop",t)}setWait(){this.loaded=this.container.dataset.loaded=!1,this.container.classList.add(r.AH.wait)}setLoaded(){this.container.classList.remove(r.AH.wait),this.loaded=this.container.dataset.loaded=!0}findEntry(t,e){const s=this.getEntries();for(const n of s)if(n.name===t&&n.type===e)return n;return null}async branchActivate(t=null){t&&t(this)}getCurrentPath(){const t=(e,s=[])=>e.name&&(s.push(e.name),null!==(e=e.getParent()))?t(e,s):s;let e=t(this);return e.length>1&&(e=e.reverse()),e}async jsonEntries(t){return await t.json()}isDraggable(){return this.options.draggables&&this.options.draggables.indexOf(this.type)>=0}async list(){if(this.type===h.node)return;const t=this.getUrl?this.getUrl():null;if(null===t)return;this.options.tags.tag,this.options.tags.subtag;this.setWait(),this.removeEntries();const e={headers:new Headers({"content-type":"application/json"})},s=await fetch(t,(0,i.Uc)(e));if(s.ok){const t=await this.jsonEntries(s);if(t.length){let e=[],s=[];for(;t.length>0;){const n=t.shift();!1===n.children?e.push(n):s.push(n)}e.sort((t,e)=>t.name<e.name),s.sort((t,e)=>t.name<e.name),this.createListEntries([s,e])}this.setLoaded()}else a.y.addMessage({parent:this.container,type:"error",content:s.error+" "+s.text})}moveTo(t){const e=t.getCurrentPath(),s=t.type===h.discard?h.discarded:t.type;e.pop(),e.forEach((e,n)=>{let i=t.findEntry(e,s);null===i&&(i=t.createEntry({type:s,name:e})),t=i}),null===t.findEntry(this.name,this.type)&&(this.from=this.parent,t.appendEntry(this))}unMove(){this.from&&(this.moveTo(this.from),this.from=null)}}function m(t=document,e={}){let s,n=null;function a(t,e=null,r=null){const a=(0,i.xJ)("span",t.class?{class:t.class}:{}),o=s.children.length;if(null===e||o<e+1?s.append(a):0===e||0===o?s.prepend(a):s.inserBefore(crtl,s.children[e]),t.typentries&&(a.dataset.typentries=t.typentries),t.icon){(0,i.xJ)("i",{class:["icon",t.icon]},a);d.applyTo(a,t.text)}else a.textContent=t.text;const l=t.trigger?t.trigger:"click";a.addEventListener(l,e=>{if(null===n)return;const s={callback:()=>{console.log("done",t.action)}};"function"==typeof t.action?t.action(n):n[t.action]||null===r?n[t.action]&&n[t.action](s):r(n),t.callback&&t.callback(e)}),t.ctrl=a}function o(){s=(0,i.xJ)("div",{class:[e.css.entrycontrols,r.AH.hide]}),Object.values(e.controls).filter(t=>t.icon||t.text).forEach(t=>{a(t)})}function l(){null!==n&&(n.container.classList.remove(e.selectors.hascontrols.substr(1)),s.classList.add(r.AH.hide),s.disabled=!0,t.append(s),n=null)}function c(t,e=!1){const s=t.ctrl;if(t.exclude&&null!==n&&t.exclude.indexOf(n.name)>=0)return void s.classList.add(r.AH.hide);const i=s.dataset.typentries?s.dataset.typentries.split(","):[],a=e?h.discarded:n?n.container.dataset.type:null;i.indexOf(a)>=0?s.classList.remove(r.AH.hide):s.classList.add(r.AH.hide)}function p(){if(null===n)return;const t=n.isDiscarded();Object.values(e.controls).filter(t=>t.icon||t.text).forEach(e=>{c(e,t)})}return e=Object.assign({selectors:{typentries:"[data-typentries]",hascontrols:".has-controls"},controls:{list:{action:"list",typentries:["B","T"]}},css:{entrycontrols:"entrycontrols",entries:".entries"}},e),o(),{options:e,addControl:a,attachControls:function(t){l(),n=t,n.container.prepend(s),n.container.classList.add(e.selectors.hascontrols.substr(1)),p(),s.classList.remove(r.AH.hide),delete s.disabled},detachControls:l,showControls:function(t=!0){!0===t?s.classList.remove(r.AH.hide):s.classList.add(r.AH.hide),s.disabled=!t},activateControls:p,activateControl:c,createControls:o,removeControls:function(){Object.values(e.controls).filter(t=>t.icon||t.text).forEach(t=>{!function(t){t.ctrl.remove()}(t)})}}}n()}catch(f){n(f)}})}}]);