/*! For license information please see 690.d8bab18113eaab177a3b.js.LICENSE.txt */
"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[690],{8690:(e,t,n)=>{n.d(t,{jobMonitor:()=>i});var s=n(4860),a=n(7114);function i(e,t={}){t={url:"/gui/job/status/",...t};const n=e.dataset.id,i={E:"Error",F:"Done",R:"Running",A:"Question",P:"Waiting"};if(!n)return;const r=e.dataset.populate?JSON.parse(e.dataset.populate):{};if(e.dataset.state&&["E","F","A"].indexOf(e.dataset.state)>=0)return;const o=document.getElementById("divstate");let c=document.getElementById("responsediv");null===c&&(c=document.createElement("div"),c.id="responsediv",e.prepend(c));let l=!1,d="is-pending";function u(e,t){if(Object.keys(r).indexOf(t)<0)return;const n=document.getElementById(r[t]);if(n)switch(t){case"state":n.innerText=i[e.state];break;case"errors":const r=n.querySelector('[data-action="toggle"]');if(r){if(0===e.errors.length)return void r.classList.add(a.AH.hide);r.classList.remove(a.AH.hide),r.click()}!function(e,t){if(e&&0!==e.length&&e.length&&"E"!=t&&"F"!==t){const t=c.querySelector(".alert");null===t?c.insertAdjacentHTML("beforeend",`<div class="alert danger inverse" data-dismissible="true">${e.join("<br>")}</div> `):t.insertAdjacentHTML("beforeend",e.join("<br>"))}}(e.errors,e.state);const o=(0,s.xJ)("ul",{},(0,s.xJ)("div",{class:n.dataset.target?n.dataset.target.replace(".",""):"collapseerrors"},n));e.errors.forEach((e=>{(0,s.xJ)("li",{text:e},o)}));break;default:n.innerText=e[t]?e[t]:""}}function f(e){!function(e){const t=document.getElementById("spinner-icon");if(null!==t)switch(e){case"R":case"P":t&&t.classList.remove(a.AH.hide),null===t.querySelector("svg")&&t.insertAdjacentHTML("afterbegin",(0,s.QW)("text-stone-700"));break;default:t.remove()}}(e.state),function(e,t=0,n=""){t||(t=0);const s=document.getElementById("progressbar");if(c.textContent=n,o&&(o.textContent=n),null!==s){s.firstChild.textContent=t+"%";const n=s.querySelector(".percent");if(n){switch(n.classList.remove(d),d="is-running",e){case"E":d="is-error";break;case"F":d="is-done";break;case"A":d="is-warning"}n.classList.contains(d)||n.classList.add(d),n.style.width=t+"%"}}}(e.state,e.progress_pct,e.progress_msg),Object.keys(r).forEach((t=>{u(e,t)}))}let g=[];!function e(){fetch(t.url+n,s.Uc).then((e=>e.json())).then((t=>{if(t){switch(t.state&&f(t),t.state){case"A":l=!0,c.innerHTML="Question waiting for an answer "+function(e,t,n="secondary"){return`<a href="${e}" class="button  is-${n}">${t}</a>`}(window.location.origin+"/Job/Question/"+t.id,"Go","warning"),populate("questiondata");break;case"F":l=!0,t.finalaction&&g.push(t.finalaction);break;case"E":l=!0}(t.state&&"E"===t.state||"F"===t.state||"Prediction"===t.type)&&(c&&(c.insertAdjacentHTML("afterbegin",g.join("")),c.classList.remove(a.AH.hide)),l=!0)}else l=!0;!1===l&&setTimeout(e,1e3)})).catch((e=>{console.log("err",e)}))}()}}}]);