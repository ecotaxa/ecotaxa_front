/*! For license information please see 555.98e036fd137f10db7238.js.LICENSE.txt */
"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[555],{8555:(e,t,s)=>{s.a(e,(async(e,a)=>{try{s.d(t,{FormSubmit:()=>d});var i=s(9418),o=s(7114),n=s(4860),l=s(7104),r=e([l]);l=(r.then?(await r)():r)[0],o.Do.captcha=".js-captcha",o.Do.formbox=".form-box",o.Do.messagepos=".messagepos",o.AH.invalid="invalid",o.AH.inputvalid="valid",o.AH.required="required",o.AH.tshidden="ts-hidden-accessible";class d{handlers={validate:[],submit:[]};form=null;listener=null;constructor(e,t={}){if(e){if(!e.formsubmit){this.form=e instanceof HTMLElement?e:document.querySelector(e);const s={fetch:null};if(t=Object.assign(t,this.form.dataset),this.options=Object.assign(s,t),!this.form)return;this.tabs=this.form.querySelectorAll(o.Do.component.tabs.tab),this.validateFields(!0),this.init(),e.formsubmit=this}return e.formsubmit}}init(){this.form.addEventListener("keydown",(e=>{"Enter"===e.key&&e.target instanceof HTMLInputElement&&e.preventDefault()})),window.addEventListener("pageshow",(e=>{(event.persisted||void 0!==window.performance&&2===window.performance.navigation.type)&&this.enableForm()})),this.form.addEventListener("validate",(e=>{this.validateFields()})),this.form.addEventListener("submit",(async e=>{e.preventDefault();return await this.submitForm()})),this.hotModifs(),this.specialFields()}hotModifs(){this.form.querySelectorAll("[data-hotmodif]").forEach((e=>{const t="input"==e.tagName.toLowerCase()&&"text"===e.type?"keydown":"change",s=e.dataset.modifmessage?e.dataset.modifmessage:this.options.modifmessage;let a=e.closest(o.Do.formbox);a=a||e.closest(o.Do.messagepos),e.addEventListener(t,(()=>{l.y.addMessage({type:l.y.alertconfig.types.warning,parent:a,content:s,duration:4e3})}))}))}specialFields(){this.form.querySelectorAll("input[data-match]").forEach((e=>{const t=e.dataset.match;if(!t)return;const s=document.getElementById(t);if(!s)return;const a=e.dataset.matchinvalid?e.dataset.matchinvalid:"no match",i=(t,s)=>{const i=t.closest(o.Do.component.form.formbox).querySelector('label[for="'+t.id+'"]'),n=s.closest(o.Do.component.form.formbox).querySelector('label[for="'+s.id+'"]'),{patternMismatch:l=!1}=t.validity,r=l?this.getMessage(t,"invalid"):"";!0===t.checkValidity()?(t.setCustomValidity(""),t==e&&null!==i?i.classList.remove(o.AH.invalid):null!==n&&n.classList.remove(o.AH.invalid),t.classList.remove(o.AH.invalid),t.value!==s.value?(s.setCustomValidity(a),n&&(n.dataset.invalid=a,n.classList.add(o.AH.invalid)),s.classList.add(o.AH.invalid)):(s.setCustomValidity(""),n&&n.classList.remove(o.AH.invalid),s.classList.remove(o.AH.invalid))):(t.setCustomValidity(r),i.dataset.invalid=r,i&&i.classList.add(o.AH.invalid),t.classList.add(o.AH.invalid)),t.focus()};[e,s].forEach((t=>{t.addEventListener("keyup",(a=>{i(t===e?e:s,t===e?s:e)}))}))}))}getMessage(e,t="invalid"){const{valueMissing:s=!0}=e.validity;return s?"* "+(e.dataset.required?e.dataset.required:this.form.dataset.required?this.form.dataset.required:e.validationMessage?e.validationMessage:"required"):e.dataset[t]?e.dataset[t]:e.validationMessage?e.validationMessage:"input invalid"}setLabelState(e,t){const s=this.getFieldLabel(e);if(null!=s)if(!0===t)s.classList.remove(o.AH.invalid);else{s.dataset.invalid=this.getMessage(e),s.classList.add(o.AH.invalid);const t=s.getBoundingClientRect(),a=t.left,i=t.top;window.scrollTo({top:i,left:a,behavior:"smooth"})}}validateField(e,t=!1){["select"].indexOf(e.tagName.toLowerCase())>=0?e.querySelectorAll("option:checked").forEach((e=>{e.value=(0,n.c6)(i.A.sanitize(e.value))})):e.value=(0,n.c6)(i.A.sanitize(e.value));let s=e.checkValidity();if(e.tomselect&&e.classList.add(o.AH.tshidden),s&&void 0!==e.dataset.unique)s=this.validateFieldUnique(e);else if("checkbox"==e.type&&(s=!0,e.required)){(e.name?e.closest("div").querySelectorAll(e.name):[e]).forEach((t=>{s=s||e.checkValidity(t)}))}const a=document.createEvent("Event");return a.initEvent(s?"valid":"invalid",!0,!0),e.dispatchEvent(a),s}getFieldLabel(e){let t=e.closest('[for="'+e.name+'"]')?e.closest('[for="'+e.name+'"]'):e.closest('[data-for="'+e.name+'"]')?e.closest('[data-for="'+e.name+'"]'):null;return null===t&&(t=e.closest(o.Do.component.form.formbox)?e.closest(o.Do.component.form.formbox).querySelector(".label")?e.closest(o.Do.component.form.formbox).querySelector(".label"):e.closest(o.Do.component.form.formbox).querySelector("label"):null),null===t&&(t=e.parentElement&&e.parentElement.dataset.elem&&e.closest("fieldset")?e.closest("fieldset").querySelector("."+e.parentElement.dataset.elem):null),t}validateFieldUnique(e){const t=this.getFieldLabel(e);if(String(e.dataset.unique).toLowerCase()===String(e.value).toLowerCase()){t&&(t.dataset.confirm=l.y.i18nmessages.noduplicate,t.classList.add(l.y.alertconfig.css.confirm));const s=function(){e.dataset.unique=!1,t&&(t.classList.remove(l.y.alertconfig.css.confirm),delete t.dataset.confirm)};return l.y.addConfirm((t?t.textContent+" : ":"")+l.y.i18nmessages.noduplicate,{callback_cancel:s,buttons:{ok:{text:l.y.i18nmessages.modify},cancel:{text:l.y.i18nmessages.saveanyway}}})}return t.dataset.confirm&&(t.classList.remove(l.y.alertconfig.css.confirm),delete t.dataset.confirm),!0}async validateFields(e=!1){let t=!0,s=!0;return[...this.form.elements].forEach((a=>{if(!0===e){if(!a.dataset.listen&&!a.disabled){if(a.required){const e=this.getFieldLabel(a);e&&e.classList.add(o.AH.required)}a.addEventListener("change",(e=>{this.validateField(e.target)})),a.dataset.listen=!0,a.addEventListener("invalid",(e=>{this.setLabelState(a,!1)})),a.addEventListener("valid",(e=>{this.setLabelState(a,!0)}))}}else!a.disabled&&!a.readonly&&!a.dataset.readonly&&a.name&&a.type&&["submit","hidden"].indexOf(a.type)<0&&(["radio","checkbox"].indexOf(a.type)<0||a.required)&&(s=this.validateField(a,!1),t=t&&s)})),!1===e&&(this.tabs.forEach((e=>{e.querySelector(":invalid")||e.querySelector(o.Do.component.alert.danger)?e.classList.add(o.AH.error):e.classList.remove(o.AH.error)})),s=await this.execHandler("validate")),s&&t}addHandler(e,t){this.handlers[e].push(t)}fieldEnable(e=!0){this.form.querySelectorAll('input[data-sub="enable"]').forEach((t=>{t.disabled=!0!==e}))}async execHandler(e){if(0===this.handlers.length||0===this.handlers[e].length)return!0;let t=!0;return await Promise.all(this.handlers[e].map((async e=>{const s=await e();t=t&&s}))),t}async formFetch(e=null){const t=new FormData(this.form);t.fetch=!0;let s=await fetch(this.form.action,(0,n.Uc)({method:"POST",body:t})).catch((e=>{this.displayResponse(e,!0),this.enableForm()})).finally((e=>{this.disableForm()}));if(s.redirected)return window.location=s.url,null;switch(e){case"text":case"html":return s=await s.text(),this.displayResponse(s,!1);default:return s=await s.json(),s}}async submitForm(){this.fieldEnable();if(await this.validateFields(!1)){if(!0===(!!this.form.querySelector(o.Do.captcha)&&(!this.form.dataset.isbot||!0===this.form.dataset.isbot)))return!1;if(await this.execHandler("submit"))return this.options.fetch?await this.formFetch(this.options.fetch):(this.form.submit(),this.disableForm(),!0)}return l.y.addAlert({type:l.y.alertconfig.types.error,parent:this.form,content:"Form not submitted, please check required fields and warning messages",dismissible:!0}),this.enableForm(),!1}enableForm(){this.form.disabled=!1;const e=this.form.querySelector('[type="submit"] svg');e&&e.remove()}disableForm(){this.form.disabled=!0;const e=this.form.querySelector('[type="submit"]');e&&e.insertAdjacentHTML("afterbegin",(0,n.QW)("text-stone-50 ml-1 mr-2 align-text-bottom inline-block"))}displayResponse(e,t=!1){const s=document.createElement("div");s.id="response_"+this.form.id,s.insertAdjacentHTML("afterbegin",e),!1!==t&&s.classList.add("is-error"),this.form.parentElement.insertBefore(s,this.form),this.form.parentElement.insertBefore(s,this.form),this.form.remove()}}a()}catch(e){a(e)}}))}}]);