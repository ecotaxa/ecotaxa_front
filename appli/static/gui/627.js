(self.webpackChunk=self.webpackChunk||[]).push([[627,52],{3583:()=>{},2627:(e,t,n)=>{"use strict";n.r(t),n.d(t,{JsTomSelect:()=>y});var s=n(7856),l=n.n(s),i=n(6031),o=n.n(i),a=n(3379),r=n.n(a),c=n(7795),d=n.n(c),u=n(569),p=n.n(u),m=n(3565),h=n.n(m),g=n(9216),f=n.n(g),v=n(4589),b=n.n(v),x=n(3583),I=n.n(x),w={};w.styleTagTransform=b(),w.setAttributes=h(),w.insert=p().bind(null,"head"),w.domAPI=d(),w.insertStyleElement=f(),r()(I(),w),I()&&I().locals&&I().locals;var S=n(9162),q=n(2817);let F={};class y{applyTo(e,t=null){const n=e.getAttribute("id"),s=e.hasAttribute("multiple"),i=e.dataset.type;let a={url:"",settings:{}},r=t=>{t.addEventListener("click",(t=>{const n=t.currentTarget.closest(q.EY.component.tomselect.item).dataset.value;n&&(t.stopImmediatePropagation(),e.tomselect.removeItem(n))}))};switch(i){case q.Cq.project:a.url="/gui/prjlist/",a.settings={valueField:"id",searchField:"text",labelField:"text",openOnFocus:!1,maxItems:1,allowEmptyOption:!1,onItemAdd:function(t){if(t!=e.dataset.value){let e=window.location.href.split("/");e.pop(),e=e.join("/")+"/"+t,window.open(e,"_blank").focus()}this.removeItem(t)}};break;case q.Cq.user:a.url="/api/users/search?by_name=",a.settings={valueField:"id",searchField:"name",labelField:"name",onInitialize:function(){e.tomselect.items.forEach((e=>{F[e]=!0}))},onItemAdd:function(t){if(F[t]){if(!this.revertSettings||this.revertSettings.tabIndex<0||!e.querySelectorAll("option"))return;const n=e.querySelectorAll("option")[this.revertSettings.tabIndex].value;this.removeOption(t),this.addItem(n),F[t]=!1}else F[t]=!0},onItemRemove:function(t){if(F[t]&&delete F[t],!this.revertSettings||this.revertSettings.tabIndex<0)return;const n=e.querySelectorAll("option")[this.revertSettings.tabIndex].value;void 0!==F[n]&&delete F[n]}};break;case q.Cq.instr:a.url="/search/instruments",a.settings={valueField:"id",labelField:"text",searchField:"id",maxItems:1,preload:!0};break;case q.Cq.taxo:o().define("no_close",(()=>{this.close=()=>{}})),a.url="/search/taxo",a.settings={valueField:"id",labelField:"text",searchField:"text",onInitialize:()=>{const e=document.getElementById(n).nextElementSibling;e.classList.contains("ts-wrapper")&&e.querySelectorAll(q.EY.component.tomselect.tsdelet).forEach((e=>{r(e)}))}}}const c={create:!1,maxOptions:null,preload:!1,hideSelected:!0,duplicates:!1,allowEmptyOption:!0,closeAfterSelect:!0,placeholder:e.placeholder?e.placeholder:e.dataset.placeholder?e.dataset.placeholder:"",onDropdownClose:function(){},shouldLoad:function(e){return e.length>2},load:function(e,t){if(e=l().sanitize(e),this.loading>10)return void t();let n="";switch(i){case q.Cq.user:n=a.url+encodeURIComponent("%"+e+"%");break;case q.Cq.instr:case q.Cq.taxo:n=a.url,e&&(n+="?q="+encodeURIComponent(e));break;case q.Cq.project:n=a.url,e&&(n+="?filt_title="+encodeURIComponent(e))}null!==n&&fetch(n,(0,S.fetchSettings)()).then((e=>e.json())).then((e=>(i===q.Cq.project&&e.data&&e.data.length&&(e=e.data.map((e=>({id:e[1],text:e[3][0]})))),i===q.Cq.instr&&e.length&&(e=e.reduce(((e,t,n)=>{let s={id:t=l().sanitize(t),text:t};return e.push(s),e}),[])),e.length&&"object"==typeof e&&(e=Object.entries(e)),t(e)))).catch((e=>{console.log("tomselect-err",e)}))},render:{option:function(e,t){if(null==e)return"";const n=e.optgroup?`data-optgroup=${e.optgroup}`:"";return`<div class="py-2 flex  ${s?"inline-flex":""} " ${n} data-value="${e[a.settings.valueField]}">${t(e[this.settings.labelField])}</div>`},item:function(e,t){if(null==e)return"";const n=e.optgroup?`item-${e.optgroup}`:"",i=s?`<i class="${q.EY.component.tomselect.tsdelet.substr(1)}"></i>`:"";return l().sanitize('<div class="'+(s?"flex inline-flex ":"")+` ${n}" data-value="${e[this.settings.valueField]}">${t(e[this.settings.labelField])} ${i}</div>`)},no_results:function(t,n){return l().sanitize('<div class="no-results">'+(e.dataset.noresults?e.dataset.noresults:"No result found for ")+n(t.input)+"</div>")}}};if(a.settings=Object.assign(c,a.settings),null!==n){const t=new(o())("#"+n,a.settings);switch(t.wrapper.classList.remove(q.EY.component.tomselect.ident),t.wrapper.classList.remove("js"),t.wrapper.setAttribute("data-component","tom-select"),i){case"taxo":t.on("item_add",((e,t)=>{null!==t&&t.classList.add("new"),null!==(t=t.querySelector(".ts-delet"))&&r(t)}));break;case"user":e.dataset.priv&&t.on("item_add",(function(e,t){null!==(t=t.querySelector(q.EY.component.tomselect.tsdelet))&&r(t)}))}return t}console.log("noid")}}}}]);