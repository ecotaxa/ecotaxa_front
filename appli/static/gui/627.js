(self.webpackChunk=self.webpackChunk||[]).push([[627,200],{3583:()=>{},2627:(e,t,s)=>{"use strict";s.d(t,{JsTomSelect:()=>q});var n=s(7856),l=s.n(n),i=s(6031),o=s.n(i),a=s(3379),r=s.n(a),c=s(7795),d=s.n(c),u=s(569),p=s.n(u),m=s(3565),h=s.n(m),g=s(9216),v=s.n(g),f=s(4589),b=s.n(f),x=s(3583),I=s.n(x),w={};w.styleTagTransform=b(),w.setAttributes=h(),w.insert=p().bind(null,"head"),w.domAPI=d(),w.insertStyleElement=v(),r()(I(),w),I()&&I().locals&&I().locals;var F=s(9162),C=s(2817);let S={};class q{applyTo(e,t={},s=null){const n=e.getAttribute("id"),i=e.hasAttribute("multiple"),a=e.dataset.type;let r={url:"",settings:t},c=t=>{t.addEventListener("click",(t=>{const s=t.currentTarget.closest(C.EY.component.tomselect.item).dataset.value;s&&(t.stopImmediatePropagation(),e.tomselect.removeItem(s))}))};switch(a){case C.Cq.project:r.url="/gui/prjlist/",r.settings={...r.settings,valueField:"id",searchField:"text",labelField:"text",openOnFocus:!1,maxItems:1,allowEmptyOption:!1,onItemAdd:function(t){if(t!=e.dataset.value){let e=window.location.href.split("/");e.pop(),e=e.join("/")+"/"+t,window.open(e,"_blank").focus()}this.removeItem(t)}};break;case C.Cq.user:r.url="/api/users/search?by_name=",r.settings={...r.settings,valueField:"id",searchField:"name",labelField:"name",onInitialize:function(){e.tomselect.items.forEach((e=>{S[e]=!0}))},onItemAdd:function(t){if(""!==t)if(S[t]){if(S[t]=!1,i||!this.revertSettings||this.revertSettings.tabIndex<0||!e.options.length)return;const s=e.options[this.revertSettings.tabIndex].value;this.removeOption(t),this.addItem(s)}else S[t]=!0},onItemRemove:function(t){if(S[t]&&delete S[t],i||!this.revertSettings||""===this.revertSettings.innerHTML&&0===this.revertSettings.tabIndex||this.revertSettings.tabIndex<0)return;const s=e.options[this.revertSettings.tabIndex].value;void 0!==S[s]&&delete S[s]}};break;case C.Cq.instr:r.url="/search/instruments",r.settings={valueField:"id",labelField:"text",searchField:"id",maxItems:1,preload:!0};break;case C.Cq.taxo:o().define("no_close",(()=>{this.close=()=>{}})),r.url="/search/taxo",r.settings={valueField:"id",labelField:"text",searchField:"text",onInitialize:()=>{const e=document.getElementById(n).nextElementSibling;e.classList.contains("ts-wrapper")&&e.querySelectorAll(C.EY.component.tomselect.tsdelet).forEach((e=>{c(e)}))}}}const d={create:!1,maxOptions:null,preload:!1,hideSelected:!0,duplicates:!1,allowEmptyOption:!0,closeAfterSelect:!0,placeholder:e.placeholder?e.placeholder:e.dataset.placeholder?e.dataset.placeholder:"",onDropdownClose:function(){},shouldLoad:function(e){return e.length>2},load:function(e,t){if(e=l().sanitize(e),this.loading>10)return void t();let s="";switch(a){case C.Cq.user:s=r.url+encodeURIComponent("%"+e+"%");break;case C.Cq.instr:case C.Cq.taxo:s=r.url,e&&(s+="?q="+encodeURIComponent(e));break;case C.Cq.project:s=r.url,e&&(s+="?filt_title="+encodeURIComponent(e))}null!==s&&fetch(s,(0,F.wv)()).then((e=>e.json())).then((e=>(a===C.Cq.project&&e.data&&e.data.length&&(e=e.data.map((e=>({id:e[1],text:e[3][0]})))),a===C.Cq.instr&&e.length&&(e=e.reduce(((e,t,s)=>{let n={id:t=l().sanitize(t),text:t};return e.push(n),e}),[])),e.length&&"object"==typeof e&&(e=Object.entries(e)),t(e)))).catch((e=>{console.log("tomselect-err",e)}))},render:{option:function(e,t){if(null==e)return"";const s=e.hasOwnProperty("optgroup")?`data-optgroup=${e.optgroup}`:"";return`<div class="py-2 flex  ${i?"inline-flex":""} " ${s} data-value="${e[r.settings.valueField]}">${t(e[this.settings.labelField])}</div>`},item:function(e,t){if(null==e)return"";const s=e.optgroup?`item-${e.optgroup}`:"",n=S[e[this.settings.valueField]]?"data-inlist":"",o=i?`<i class="${C.EY.component.tomselect.tsdelet.substr(1)}"></i>`:"";return l().sanitize(`<div class="${i?"flex inline-flex ":""} ${s}"  data-value="${e[this.settings.valueField]}"  ${n}>${t(e[this.settings.labelField])} ${o}</div>`)},no_results:function(t,s){return l().sanitize('<div class="no-results">'+(e.dataset.noresults?e.dataset.noresults:"No result found for ")+s(t.input)+"</div>")}}};if(r.settings=Object.assign(d,r.settings),null!==n){const t=new(o())("#"+n,r.settings);switch(t.wrapper.classList.remove(C.EY.component.tomselect.ident),t.wrapper.classList.remove("js"),t.wrapper.setAttribute("data-component","tom-select"),a){case"taxo":t.on("item_add",((e,t)=>{null!==t&&t.classList.add("new"),null!==(t=t.querySelector(".ts-delet"))&&c(t)}));break;case"user":e.dataset.priv&&t.on("item_add",(function(e,t){null!==(t=t.querySelector(C.EY.component.tomselect.tsdelet))&&c(t)}))}return t}console.log("noid")}}}}]);