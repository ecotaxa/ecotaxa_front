/*! For license information please see src_modules_js-export-csv_js.js.LICENSE.txt */
"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["src_modules_js-export-csv_js"],{"./src/modules/js-export-csv.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   exportCSV: () => (/* binding */ exportCSV)\n/* harmony export */ });\n/* harmony import */ var _modules_utils_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../modules/utils.js */ "./src/modules/utils.js");\n\n\n/**\n * Export table to CSV\n * @param {TableComponent) TableComponent instance.\n\n * @return {Array}\n */\n\nconst exportCSV = function(state, options = {}, hidden = true) {\n\n  if (!state.grid.columns.length || (hidden === true && !state.grid.data.length)) return false;\n  const defaults = {\n    download: true,\n    skipcolumns: [],\n    linedelimiter: "\\n",\n    columndelimiter: ","\n  }\n  options = { ...defaults,\n    ...options\n  };\n\n  function text_convert(text) {\n    if (text === null || text === undefined) return null;\n    text = text.trim();\n    text = text.replace(/\\s{2,}/g, " ");\n    text = text.replace(/\\n/g, "  ");\n    text = text.replace(/"/g, "\\"\\"");\n    //have to manually encode "#" as encodeURI leaves it as is.\n    text = text.replace(/#/g, "%23");\n    if (text.includes(",")) text = `"${text}"`;\n    return text;\n  }\n\n  function make_line(row) {\n    row = row.join(options.columndelimiter);\n    return row.trim();\n  }\n  let rows = [],\n    row = [];\n  const columns = [];\n  const theads = state.dom.querySelectorAll(\'thead th\');\n  console.log(theads)\n  state.grid.columns.forEach(column => {\n    if ((hidden === true || !column.hasOwnProperty(\'hidden\')) && (options.skipcolumns.length === 0 || options.skipcolumns.indexOf(column.index) < 0)) {\n      const obj = {\n        name: (column.name) ? column.name : ((column.label) ? column.label : String(column.index)),\n        hidden: (column.hasOwnProperty(\'hidden\')) ? true : false,\n        index: column.index\n      };\n      //headings\n      if ((hidden === true || !column.hidden) && (options.skipcolumns.length === 0 || options.skipcolumns.indexOf(column.index) < 0)) {\n        let label = theads[column.index].dataset.name ? theads[column.index].dataset.name : theads[column.index].contentText;\n        if (!label) label = \'C\' + column.index;\n        row.push(text_convert(label));\n        columns.push(obj);\n      }\n    }\n  });\n  rows.push(make_line(row));\n  const trs = state.dom.querySelectorAll(\'tbody tr\');\n\n  for (let i = 0; i < trs.length; i++) {\n    row = [];\n\n    const tds = trs[i].querySelectorAll(\'th,td\');\n    state.grid.columns.forEach((column) => {\n      const index = column.index;\n      if ((hidden === true || !column.hidden) && (options.skipcolumns.length === 0 || options.skipcolumns.indexOf(index) < 0)) {\n        const value = (column.hidden) ? state.grid.data[i][index] : (tds[index]) ? tds[index].innerText : \'None\';\n        row.push(text_convert(value));\n\n      }\n    });\n\n    rows.push(make_line(row));\n  }\n\n  const str = rows.join(options.linedelimiter);\n  // Download\n  if (options.download) {\n    // Create a link to trigger the download\n    link = document.createElement("a")\n    link.href = encodeURI(`data:text/csv;charset=utf-8,${str}`)\n    link.download = `${options.filename || "datatable_export"}.csv`\n    // Append the link\n    document.body.appendChild(link);\n    // Trigger the download\n    link.click();\n    // Remove the link\n    document.body.removeChild(link);\n  }\n  return str;\n}//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvbW9kdWxlcy9qcy1leHBvcnQtY3N2LmpzIiwibWFwcGluZ3MiOiI7Ozs7O0FBRTRCOztBQUU1QjtBQUNBO0FBQ0EsV0FBVzs7QUFFWCxZQUFZO0FBQ1o7O0FBRU8sOENBQThDOztBQUVyRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWM7QUFDZDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLDRCQUE0QixHQUFHO0FBQy9CO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUNBQXVDLEtBQUs7QUFDNUM7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTs7QUFFQSxrQkFBa0IsZ0JBQWdCO0FBQ2xDOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEtBQUs7O0FBRUw7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUNBQXlDLGdCQUFnQixJQUFJO0FBQzdELHVCQUF1Qix1Q0FBdUM7QUFDOUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vc3JjL21vZHVsZXMvanMtZXhwb3J0LWNzdi5qcz81MTIwIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XG4gIGlzX29iamVjdFxufSBmcm9tIFwiLi4vbW9kdWxlcy91dGlscy5qc1wiXG5cbi8qKlxuICogRXhwb3J0IHRhYmxlIHRvIENTVlxuICogQHBhcmFtIHtUYWJsZUNvbXBvbmVudCkgVGFibGVDb21wb25lbnQgaW5zdGFuY2UuXG5cbiAqIEByZXR1cm4ge0FycmF5fVxuICovXG5cbmV4cG9ydCBjb25zdCBleHBvcnRDU1YgPSBmdW5jdGlvbihzdGF0ZSwgb3B0aW9ucyA9IHt9LCBoaWRkZW4gPSB0cnVlKSB7XG5cbiAgaWYgKCFzdGF0ZS5ncmlkLmNvbHVtbnMubGVuZ3RoIHx8IChoaWRkZW4gPT09IHRydWUgJiYgIXN0YXRlLmdyaWQuZGF0YS5sZW5ndGgpKSByZXR1cm4gZmFsc2U7XG4gIGNvbnN0IGRlZmF1bHRzID0ge1xuICAgIGRvd25sb2FkOiB0cnVlLFxuICAgIHNraXBjb2x1bW5zOiBbXSxcbiAgICBsaW5lZGVsaW1pdGVyOiBcIlxcblwiLFxuICAgIGNvbHVtbmRlbGltaXRlcjogXCIsXCJcbiAgfVxuICBvcHRpb25zID0geyAuLi5kZWZhdWx0cyxcbiAgICAuLi5vcHRpb25zXG4gIH07XG5cbiAgZnVuY3Rpb24gdGV4dF9jb252ZXJ0KHRleHQpIHtcbiAgICBpZiAodGV4dCA9PT0gbnVsbCB8fCB0ZXh0ID09PSB1bmRlZmluZWQpIHJldHVybiBudWxsO1xuICAgIHRleHQgPSB0ZXh0LnRyaW0oKTtcbiAgICB0ZXh0ID0gdGV4dC5yZXBsYWNlKC9cXHN7Mix9L2csIFwiIFwiKTtcbiAgICB0ZXh0ID0gdGV4dC5yZXBsYWNlKC9cXG4vZywgXCIgIFwiKTtcbiAgICB0ZXh0ID0gdGV4dC5yZXBsYWNlKC9cIi9nLCBcIlxcXCJcXFwiXCIpO1xuICAgIC8vaGF2ZSB0byBtYW51YWxseSBlbmNvZGUgXCIjXCIgYXMgZW5jb2RlVVJJIGxlYXZlcyBpdCBhcyBpcy5cbiAgICB0ZXh0ID0gdGV4dC5yZXBsYWNlKC8jL2csIFwiJTIzXCIpO1xuICAgIGlmICh0ZXh0LmluY2x1ZGVzKFwiLFwiKSkgdGV4dCA9IGBcIiR7dGV4dH1cImA7XG4gICAgcmV0dXJuIHRleHQ7XG4gIH1cblxuICBmdW5jdGlvbiBtYWtlX2xpbmUocm93KSB7XG4gICAgcm93ID0gcm93LmpvaW4ob3B0aW9ucy5jb2x1bW5kZWxpbWl0ZXIpO1xuICAgIHJldHVybiByb3cudHJpbSgpO1xuICB9XG4gIGxldCByb3dzID0gW10sXG4gICAgcm93ID0gW107XG4gIGNvbnN0IGNvbHVtbnMgPSBbXTtcbiAgY29uc3QgdGhlYWRzID0gc3RhdGUuZG9tLnF1ZXJ5U2VsZWN0b3JBbGwoJ3RoZWFkIHRoJyk7XG4gIGNvbnNvbGUubG9nKHRoZWFkcylcbiAgc3RhdGUuZ3JpZC5jb2x1bW5zLmZvckVhY2goY29sdW1uID0+IHtcbiAgICBpZiAoKGhpZGRlbiA9PT0gdHJ1ZSB8fCAhY29sdW1uLmhhc093blByb3BlcnR5KCdoaWRkZW4nKSkgJiYgKG9wdGlvbnMuc2tpcGNvbHVtbnMubGVuZ3RoID09PSAwIHx8IG9wdGlvbnMuc2tpcGNvbHVtbnMuaW5kZXhPZihjb2x1bW4uaW5kZXgpIDwgMCkpIHtcbiAgICAgIGNvbnN0IG9iaiA9IHtcbiAgICAgICAgbmFtZTogKGNvbHVtbi5uYW1lKSA/IGNvbHVtbi5uYW1lIDogKChjb2x1bW4ubGFiZWwpID8gY29sdW1uLmxhYmVsIDogU3RyaW5nKGNvbHVtbi5pbmRleCkpLFxuICAgICAgICBoaWRkZW46IChjb2x1bW4uaGFzT3duUHJvcGVydHkoJ2hpZGRlbicpKSA/IHRydWUgOiBmYWxzZSxcbiAgICAgICAgaW5kZXg6IGNvbHVtbi5pbmRleFxuICAgICAgfTtcbiAgICAgIC8vaGVhZGluZ3NcbiAgICAgIGlmICgoaGlkZGVuID09PSB0cnVlIHx8ICFjb2x1bW4uaGlkZGVuKSAmJiAob3B0aW9ucy5za2lwY29sdW1ucy5sZW5ndGggPT09IDAgfHwgb3B0aW9ucy5za2lwY29sdW1ucy5pbmRleE9mKGNvbHVtbi5pbmRleCkgPCAwKSkge1xuICAgICAgICBsZXQgbGFiZWwgPSB0aGVhZHNbY29sdW1uLmluZGV4XS5kYXRhc2V0Lm5hbWUgPyB0aGVhZHNbY29sdW1uLmluZGV4XS5kYXRhc2V0Lm5hbWUgOiB0aGVhZHNbY29sdW1uLmluZGV4XS5jb250ZW50VGV4dDtcbiAgICAgICAgaWYgKCFsYWJlbCkgbGFiZWwgPSAnQycgKyBjb2x1bW4uaW5kZXg7XG4gICAgICAgIHJvdy5wdXNoKHRleHRfY29udmVydChsYWJlbCkpO1xuICAgICAgICBjb2x1bW5zLnB1c2gob2JqKTtcbiAgICAgIH1cbiAgICB9XG4gIH0pO1xuICByb3dzLnB1c2gobWFrZV9saW5lKHJvdykpO1xuICBjb25zdCB0cnMgPSBzdGF0ZS5kb20ucXVlcnlTZWxlY3RvckFsbCgndGJvZHkgdHInKTtcblxuICBmb3IgKGxldCBpID0gMDsgaSA8IHRycy5sZW5ndGg7IGkrKykge1xuICAgIHJvdyA9IFtdO1xuXG4gICAgY29uc3QgdGRzID0gdHJzW2ldLnF1ZXJ5U2VsZWN0b3JBbGwoJ3RoLHRkJyk7XG4gICAgc3RhdGUuZ3JpZC5jb2x1bW5zLmZvckVhY2goKGNvbHVtbikgPT4ge1xuICAgICAgY29uc3QgaW5kZXggPSBjb2x1bW4uaW5kZXg7XG4gICAgICBpZiAoKGhpZGRlbiA9PT0gdHJ1ZSB8fCAhY29sdW1uLmhpZGRlbikgJiYgKG9wdGlvbnMuc2tpcGNvbHVtbnMubGVuZ3RoID09PSAwIHx8IG9wdGlvbnMuc2tpcGNvbHVtbnMuaW5kZXhPZihpbmRleCkgPCAwKSkge1xuICAgICAgICBjb25zdCB2YWx1ZSA9IChjb2x1bW4uaGlkZGVuKSA/IHN0YXRlLmdyaWQuZGF0YVtpXVtpbmRleF0gOiAodGRzW2luZGV4XSkgPyB0ZHNbaW5kZXhdLmlubmVyVGV4dCA6ICdOb25lJztcbiAgICAgICAgcm93LnB1c2godGV4dF9jb252ZXJ0KHZhbHVlKSk7XG5cbiAgICAgIH1cbiAgICB9KTtcblxuICAgIHJvd3MucHVzaChtYWtlX2xpbmUocm93KSk7XG4gIH1cblxuICBjb25zdCBzdHIgPSByb3dzLmpvaW4ob3B0aW9ucy5saW5lZGVsaW1pdGVyKTtcbiAgLy8gRG93bmxvYWRcbiAgaWYgKG9wdGlvbnMuZG93bmxvYWQpIHtcbiAgICAvLyBDcmVhdGUgYSBsaW5rIHRvIHRyaWdnZXIgdGhlIGRvd25sb2FkXG4gICAgbGluayA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJhXCIpXG4gICAgbGluay5ocmVmID0gZW5jb2RlVVJJKGBkYXRhOnRleHQvY3N2O2NoYXJzZXQ9dXRmLTgsJHtzdHJ9YClcbiAgICBsaW5rLmRvd25sb2FkID0gYCR7b3B0aW9ucy5maWxlbmFtZSB8fCBcImRhdGF0YWJsZV9leHBvcnRcIn0uY3N2YFxuICAgIC8vIEFwcGVuZCB0aGUgbGlua1xuICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQobGluayk7XG4gICAgLy8gVHJpZ2dlciB0aGUgZG93bmxvYWRcbiAgICBsaW5rLmNsaWNrKCk7XG4gICAgLy8gUmVtb3ZlIHRoZSBsaW5rXG4gICAgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChsaW5rKTtcbiAgfVxuICByZXR1cm4gc3RyO1xufSJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/modules/js-export-csv.js\n')}}]);