/*! For license information please see src_modules_js-export-csv_js.js.LICENSE.txt */
"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["src_modules_js-export-csv_js"],{"./src/modules/js-export-csv.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   exportCSV: () => (/* binding */ exportCSV)\n/* harmony export */ });\n/* harmony import */ var _modules_utils_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../modules/utils.js */ "./src/modules/utils.js");\n\n\n/**\n * Export table to CSV\n * @param {TableComponent) TableComponent instance.\n\n * @return {Array}\n */\n\nconst exportCSV = function(state, options = {}, hidden = true) {\n\n  if (!state.grid.columns.length || (hidden === true && !state.grid.data.length)) return false;\n  const defaults = {\n    download: true,\n    skipcolumns: [],\n    linedelimiter: "\\n",\n    columndelimiter: ","\n  }\n  options = { ...defaults,\n    ...options\n  };\n\n  function text_convert(text) {\n    if (text === null || text === undefined) return null;\n    text = text.trim();\n    text = text.replace(/\\s{2,}/g, " ");\n    text = text.replace(/\\n/g, "  ");\n    text = text.replace(/"/g, "\\"\\"");\n    //have to manually encode "#" as encodeURI leaves it as is.\n    text = text.replace(/#/g, "%23");\n    if (text.includes(",")) text = `"${text}"`;\n    return text;\n  }\n\n  function make_line(row) {\n    row = row.join(options.columndelimiter);\n    return row.trim();\n  }\n  let rows = [],\n    row = [];\n  const columns = [];\n  const theads = state.dom.querySelectorAll(\'thead th\');\n  state.grid.columns.forEach(column => {\n    if ((hidden === true || !column.hasOwnProperty(\'hidden\')) && (options.skipcolumns.length === 0 || options.skipcolumns.indexOf(column.index) < 0)) {\n      const obj = {\n        name: (column.name) ? column.name : ((column.label) ? column.label : String(column.index)),\n        hidden: (column.hasOwnProperty(\'hidden\')) ? true : false,\n        index: column.index\n      };\n      //headings\n      if ((hidden === true || !column.hidden) && (options.skipcolumns.length === 0 || options.skipcolumns.indexOf(column.index) < 0)) {\n        let label = theads[column.index].dataset.name ? theads[column.index].dataset.name : theads[column.index].contentText;\n        if (!label) label = \'C\' + column.index;\n        row.push(text_convert(label));\n        columns.push(obj);\n      }\n    }\n  });\n  rows.push(make_line(row));\n  const trs = state.dom.querySelectorAll(\'tbody tr\');\n\n  for (let i = 0; i < trs.length; i++) {\n    row = [];\n\n    const tds = trs[i].querySelectorAll(\'th,td\');\n    state.grid.columns.forEach((column) => {\n      const index = column.index;\n      if ((hidden === true || !column.hidden) && (options.skipcolumns.length === 0 || options.skipcolumns.indexOf(index) < 0)) {\n        const value = (column.hidden) ? state.grid.data[i][index] : (tds[index]) ? tds[index].innerText : \'None\';\n        row.push(text_convert(value));\n\n      }\n    });\n\n    rows.push(make_line(row));\n  }\n\n  const str = rows.join(options.linedelimiter);\n  // Download\n  if (options.download) {\n    // Create a link to trigger the download\n    link = document.createElement("a")\n    link.href = encodeURI(`data:text/csv;charset=utf-8,${str}`)\n    link.download = `${options.filename || "datatable_export"}.csv`\n    // Append the link\n    document.body.appendChild(link);\n    // Trigger the download\n    link.click();\n    // Remove the link\n    document.body.removeChild(link);\n  }\n  return str;\n}//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvbW9kdWxlcy9qcy1leHBvcnQtY3N2LmpzIiwibWFwcGluZ3MiOiI7Ozs7O0FBRTRCOztBQUU1QjtBQUNBO0FBQ0EsV0FBVzs7QUFFWCxZQUFZO0FBQ1o7O0FBRU8sOENBQThDOztBQUVyRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWM7QUFDZDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLDRCQUE0QixHQUFHO0FBQy9CO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUNBQXVDLEtBQUs7QUFDNUM7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7O0FBRUEsa0JBQWtCLGdCQUFnQjtBQUNsQzs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxLQUFLOztBQUVMO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlDQUF5QyxnQkFBZ0IsSUFBSTtBQUM3RCx1QkFBdUIsdUNBQXVDO0FBQzlEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL3NyYy9tb2R1bGVzL2pzLWV4cG9ydC1jc3YuanM/NTEyMCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xuICBpc19vYmplY3Rcbn0gZnJvbSBcIi4uL21vZHVsZXMvdXRpbHMuanNcIlxuXG4vKipcbiAqIEV4cG9ydCB0YWJsZSB0byBDU1ZcbiAqIEBwYXJhbSB7VGFibGVDb21wb25lbnQpIFRhYmxlQ29tcG9uZW50IGluc3RhbmNlLlxuXG4gKiBAcmV0dXJuIHtBcnJheX1cbiAqL1xuXG5leHBvcnQgY29uc3QgZXhwb3J0Q1NWID0gZnVuY3Rpb24oc3RhdGUsIG9wdGlvbnMgPSB7fSwgaGlkZGVuID0gdHJ1ZSkge1xuXG4gIGlmICghc3RhdGUuZ3JpZC5jb2x1bW5zLmxlbmd0aCB8fCAoaGlkZGVuID09PSB0cnVlICYmICFzdGF0ZS5ncmlkLmRhdGEubGVuZ3RoKSkgcmV0dXJuIGZhbHNlO1xuICBjb25zdCBkZWZhdWx0cyA9IHtcbiAgICBkb3dubG9hZDogdHJ1ZSxcbiAgICBza2lwY29sdW1uczogW10sXG4gICAgbGluZWRlbGltaXRlcjogXCJcXG5cIixcbiAgICBjb2x1bW5kZWxpbWl0ZXI6IFwiLFwiXG4gIH1cbiAgb3B0aW9ucyA9IHsgLi4uZGVmYXVsdHMsXG4gICAgLi4ub3B0aW9uc1xuICB9O1xuXG4gIGZ1bmN0aW9uIHRleHRfY29udmVydCh0ZXh0KSB7XG4gICAgaWYgKHRleHQgPT09IG51bGwgfHwgdGV4dCA9PT0gdW5kZWZpbmVkKSByZXR1cm4gbnVsbDtcbiAgICB0ZXh0ID0gdGV4dC50cmltKCk7XG4gICAgdGV4dCA9IHRleHQucmVwbGFjZSgvXFxzezIsfS9nLCBcIiBcIik7XG4gICAgdGV4dCA9IHRleHQucmVwbGFjZSgvXFxuL2csIFwiICBcIik7XG4gICAgdGV4dCA9IHRleHQucmVwbGFjZSgvXCIvZywgXCJcXFwiXFxcIlwiKTtcbiAgICAvL2hhdmUgdG8gbWFudWFsbHkgZW5jb2RlIFwiI1wiIGFzIGVuY29kZVVSSSBsZWF2ZXMgaXQgYXMgaXMuXG4gICAgdGV4dCA9IHRleHQucmVwbGFjZSgvIy9nLCBcIiUyM1wiKTtcbiAgICBpZiAodGV4dC5pbmNsdWRlcyhcIixcIikpIHRleHQgPSBgXCIke3RleHR9XCJgO1xuICAgIHJldHVybiB0ZXh0O1xuICB9XG5cbiAgZnVuY3Rpb24gbWFrZV9saW5lKHJvdykge1xuICAgIHJvdyA9IHJvdy5qb2luKG9wdGlvbnMuY29sdW1uZGVsaW1pdGVyKTtcbiAgICByZXR1cm4gcm93LnRyaW0oKTtcbiAgfVxuICBsZXQgcm93cyA9IFtdLFxuICAgIHJvdyA9IFtdO1xuICBjb25zdCBjb2x1bW5zID0gW107XG4gIGNvbnN0IHRoZWFkcyA9IHN0YXRlLmRvbS5xdWVyeVNlbGVjdG9yQWxsKCd0aGVhZCB0aCcpO1xuICBzdGF0ZS5ncmlkLmNvbHVtbnMuZm9yRWFjaChjb2x1bW4gPT4ge1xuICAgIGlmICgoaGlkZGVuID09PSB0cnVlIHx8ICFjb2x1bW4uaGFzT3duUHJvcGVydHkoJ2hpZGRlbicpKSAmJiAob3B0aW9ucy5za2lwY29sdW1ucy5sZW5ndGggPT09IDAgfHwgb3B0aW9ucy5za2lwY29sdW1ucy5pbmRleE9mKGNvbHVtbi5pbmRleCkgPCAwKSkge1xuICAgICAgY29uc3Qgb2JqID0ge1xuICAgICAgICBuYW1lOiAoY29sdW1uLm5hbWUpID8gY29sdW1uLm5hbWUgOiAoKGNvbHVtbi5sYWJlbCkgPyBjb2x1bW4ubGFiZWwgOiBTdHJpbmcoY29sdW1uLmluZGV4KSksXG4gICAgICAgIGhpZGRlbjogKGNvbHVtbi5oYXNPd25Qcm9wZXJ0eSgnaGlkZGVuJykpID8gdHJ1ZSA6IGZhbHNlLFxuICAgICAgICBpbmRleDogY29sdW1uLmluZGV4XG4gICAgICB9O1xuICAgICAgLy9oZWFkaW5nc1xuICAgICAgaWYgKChoaWRkZW4gPT09IHRydWUgfHwgIWNvbHVtbi5oaWRkZW4pICYmIChvcHRpb25zLnNraXBjb2x1bW5zLmxlbmd0aCA9PT0gMCB8fCBvcHRpb25zLnNraXBjb2x1bW5zLmluZGV4T2YoY29sdW1uLmluZGV4KSA8IDApKSB7XG4gICAgICAgIGxldCBsYWJlbCA9IHRoZWFkc1tjb2x1bW4uaW5kZXhdLmRhdGFzZXQubmFtZSA/IHRoZWFkc1tjb2x1bW4uaW5kZXhdLmRhdGFzZXQubmFtZSA6IHRoZWFkc1tjb2x1bW4uaW5kZXhdLmNvbnRlbnRUZXh0O1xuICAgICAgICBpZiAoIWxhYmVsKSBsYWJlbCA9ICdDJyArIGNvbHVtbi5pbmRleDtcbiAgICAgICAgcm93LnB1c2godGV4dF9jb252ZXJ0KGxhYmVsKSk7XG4gICAgICAgIGNvbHVtbnMucHVzaChvYmopO1xuICAgICAgfVxuICAgIH1cbiAgfSk7XG4gIHJvd3MucHVzaChtYWtlX2xpbmUocm93KSk7XG4gIGNvbnN0IHRycyA9IHN0YXRlLmRvbS5xdWVyeVNlbGVjdG9yQWxsKCd0Ym9keSB0cicpO1xuXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgdHJzLmxlbmd0aDsgaSsrKSB7XG4gICAgcm93ID0gW107XG5cbiAgICBjb25zdCB0ZHMgPSB0cnNbaV0ucXVlcnlTZWxlY3RvckFsbCgndGgsdGQnKTtcbiAgICBzdGF0ZS5ncmlkLmNvbHVtbnMuZm9yRWFjaCgoY29sdW1uKSA9PiB7XG4gICAgICBjb25zdCBpbmRleCA9IGNvbHVtbi5pbmRleDtcbiAgICAgIGlmICgoaGlkZGVuID09PSB0cnVlIHx8ICFjb2x1bW4uaGlkZGVuKSAmJiAob3B0aW9ucy5za2lwY29sdW1ucy5sZW5ndGggPT09IDAgfHwgb3B0aW9ucy5za2lwY29sdW1ucy5pbmRleE9mKGluZGV4KSA8IDApKSB7XG4gICAgICAgIGNvbnN0IHZhbHVlID0gKGNvbHVtbi5oaWRkZW4pID8gc3RhdGUuZ3JpZC5kYXRhW2ldW2luZGV4XSA6ICh0ZHNbaW5kZXhdKSA/IHRkc1tpbmRleF0uaW5uZXJUZXh0IDogJ05vbmUnO1xuICAgICAgICByb3cucHVzaCh0ZXh0X2NvbnZlcnQodmFsdWUpKTtcblxuICAgICAgfVxuICAgIH0pO1xuXG4gICAgcm93cy5wdXNoKG1ha2VfbGluZShyb3cpKTtcbiAgfVxuXG4gIGNvbnN0IHN0ciA9IHJvd3Muam9pbihvcHRpb25zLmxpbmVkZWxpbWl0ZXIpO1xuICAvLyBEb3dubG9hZFxuICBpZiAob3B0aW9ucy5kb3dubG9hZCkge1xuICAgIC8vIENyZWF0ZSBhIGxpbmsgdG8gdHJpZ2dlciB0aGUgZG93bmxvYWRcbiAgICBsaW5rID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImFcIilcbiAgICBsaW5rLmhyZWYgPSBlbmNvZGVVUkkoYGRhdGE6dGV4dC9jc3Y7Y2hhcnNldD11dGYtOCwke3N0cn1gKVxuICAgIGxpbmsuZG93bmxvYWQgPSBgJHtvcHRpb25zLmZpbGVuYW1lIHx8IFwiZGF0YXRhYmxlX2V4cG9ydFwifS5jc3ZgXG4gICAgLy8gQXBwZW5kIHRoZSBsaW5rXG4gICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChsaW5rKTtcbiAgICAvLyBUcmlnZ2VyIHRoZSBkb3dubG9hZFxuICAgIGxpbmsuY2xpY2soKTtcbiAgICAvLyBSZW1vdmUgdGhlIGxpbmtcbiAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKGxpbmspO1xuICB9XG4gIHJldHVybiBzdHI7XG59Il0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/modules/js-export-csv.js\n')}}]);