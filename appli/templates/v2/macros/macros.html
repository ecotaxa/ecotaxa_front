{% macro nav_header(target_proj,headcenter) -%}
{#write central header - project title or page main action title#}

{% if target_proj or headcenter !='' %}
<h3>
  {{ headcenter }}
  {% if target_proj and target_proj.projid != 0 %}
  [{{ target_proj.projid }}] {{ target_proj.title }}
  {% endif %}
</h3>
{% endif %}
{%- endmacro%}

{% macro modal(id,btn = {'class':'','text':'','data':''},modal_title='',modal_content='',type='modal-popup', position='' ,summary_pos={'float':'','clear':''} ,data='') -%}
<details {{' id=' + type if type=='modal-help' }} class="modal-container  {{ type }} {{ position }}" {{ 'data-form=' + data.form if 'form' in data }} {{ 'data-file=' + data.file if 'file' in data }}>
  {% if type=='modal-popup' %}
  <summary><div class="{{ btn['class'] if btn['class'] else 'button is-action inline-block' }}" data-for="{{ id }}" {{ btn['data'] if btn['data']  }}>
    {#icon#}
    {%if btn and 'icon' in btn%}
    <i class=" icon {{ btn['icon']|safe }}"></i>
    {% endif%}
    {{ btn['text']|safe if btn['text'] else '' }}</div></summary>
  <div class="modal" id="{{ id }}" >
    <div class="modal-body peer-checked" for="{{ id }}">
      <div class="modal-title">
        <h3>{{modal_title}}</h3>
        {% if 'header' in data and  data.header !='' %}
          {% with args = data %}
          {% include data.header %}
          {% endwith%}
      {% endif%}
      </div>
      <div class="modal-content">
        {% if modal_content != '' %}
        {% include modal_content  ignore missing %}
        {% else%}
        {{ _('Please wait ...')}}
        {% endif %}
      </div>
      <div class="modal-footer">{% if 'footer' in data and data.footer !=''%}
      {% include data.footer %}
    {% endif%}</div>
    </div>
  </div>
  {% else %}
  {% if summary_pos is iterable%}
  {% set pos =''%}
  {% for prop,val in summary_pos.items() %}
  {% set pos = pos + prop + '-' + val + ' ' if val!='' %}
  {% endfor %}
  {% endif %}
  <summary class="aside-label" {{ 'data-action=request data-what=help' if type=='modal-help' }}><span class="summary-title">{{ modal_title }}</span></summary>
  <div class="modal" id="{{ id }}">
    <div class="aside-body py-4 px-5 peer-checked">
      {% set modal_content='./v2/help/index.html' if (modal_content == '' and type=='modal-help') else modal_content %}
      {% include modal_content ignore missing %}
    </div>
  </div>
  {% endif %}
  <div class="up" data-action="gotop" data-target="{{ id }}"></div>
</details>
{%- endmacro %}

{% macro inputdict(id,name,value=0, label='', type = '', multiple = False,placeholder='Select', required = False, autocomplete=False,data='') -%}
{% if autocomplete == True %}

<select {{ 'multiple' if multiple }} name="{{ name }}" id="{{ id }}" class="form-select js js-autocomplete" data-placeholder="{{ placeholder }}" data-type="{{ type }}" {{ 'required' if required }}  {{ data|safe if data }}>
  <option value="{{ value }}" {{ 'selected' if value !=0 }} {{ 'disabled hidden' if value == 0  }}>{{ placeholder +'...' if (value == '' or value == 0) else label }}</option>
</select>
{% else %}
<div class="form-box">

  <input type="hidden" name="{{ name }}" id="{{ id }}" data-type="{{ type }}" {{ 'required' if required }} value="{{ value| safe }}"> <input type="text" class="form-input" value="{{ label }}" readonly></div>
{% endif %}
{%- endmacro %}

{% macro form_group_radio(id,name,val,label,value,required=False) -%}
<div class="group-radio"><input type="radio" class="peer" name="{{ name }}" id="{{ id}}" value="{{ val }}" {{'required' if required==True else ''}} {{ 'checked' if val==value }}>
  <label for="{{id}}" class="peer-checked:bg-pchecked-400  peer-checked:text-white  peer-checked:shadow">{{ label | safe }}</label></div>
{%- endmacro %}

{% macro nav_notifications(notifs, url ='#',tag ='span') -%}
{% if notifs is iterable %}
{% for label,notif in notifs.items() %}
<{{tag}} class="notif is-{{ label|lower }}" title="{{label}}"><a href="{{ url + label|lower }}">{{notif|string()}}</a></{{tag}}>
{% endfor %} {% endif %} {%- endmacro %}

{% macro alertbox(type,message,title='', inverse=false, dismissible = false, relid ='',extra=False) -%}
{% include './v2/partials/_alertbox.html' %}
{%- endmacro %}

{% macro topalerts() -%}
{% set messages = get_flashed_messages(true)  %}
{% if messages|length > 0 %}
{% for message in messages %}
  {{ alertbox(type=message[0]|replace("message","info"),dismissible = True, message= message[1] )}}
{% endfor %}
{% endif %}
{%- endmacro %}
